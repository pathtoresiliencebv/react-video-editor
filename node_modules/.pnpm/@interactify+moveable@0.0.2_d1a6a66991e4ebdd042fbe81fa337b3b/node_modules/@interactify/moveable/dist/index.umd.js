(function(at,vt){typeof exports=="object"&&typeof module<"u"?vt(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],vt):(at=typeof globalThis<"u"?globalThis:at||self,vt(at.timeline={},at.React))})(this,function(at,vt){"use strict";var Pf=Object.defineProperty;var _f=(at,vt,Oe)=>vt in at?Pf(at,vt,{enumerable:!0,configurable:!0,writable:!0,value:Oe}):at[vt]=Oe;var H=(at,vt,Oe)=>_f(at,typeof vt!="symbol"?vt+"":vt,Oe);function Oe(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const Os=Oe(vt);function we(t,e){return{events:[],props:[],name:t,...e}}function or(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function ws(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function Is(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function ir(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function Ma(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function Pa(t,e){var n=ir("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function ar(t){return t.replace(/_/g,".")}function Je(t,e){var n=null,r="-1";return or(t,function(s){var o=ir("("+s.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!o||s.brand?!1:(n=s,r=o[3]||"-1",s.versionAlias?r=s.versionAlias:s.versionTest&&(r=Pa(s.versionTest.toLowerCase(),e)||r),r=ar(r),!0)}),{preset:n,version:r}}function Cn(t,e){var n={brand:"",version:"-1"};return or(t,function(r){var s=Bs(e,r);return s?(n.brand=r.id,n.version=r.versionAlias||s.version,n.version!=="-1"):!1}),n}function Bs(t,e){return ws(t,function(n){var r=n.brand;return ir(""+e.test,r.toLowerCase())})}var zs=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],As=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],cr=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Gs=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],ks=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Fs(t){return!!Je(Gs,t).preset}function _a(t){var e=Is(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:Fs(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},s={name:"unknown",version:"-1",majorVersion:-1},o=Je(zs,e),i=o.preset,a=o.version,c=Je(ks,e),l=c.preset,u=c.version,f=Je(As,e);if(r.chromium=!!f.preset,r.chromiumVersion=f.version,!r.chromium){var d=Je(cr,e);r.webkit=!!d.preset,r.webkitVersion=d.version}return l&&(s.name=l.id,s.version=u,s.majorVersion=parseInt(u,10)),i&&(r.name=i.id,r.version=a,r.webview&&s.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:s,isMobile:n,isHints:!1}}function Ta(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,s=n[0],o=(e.platform||navigator.platform).toLowerCase(),i={name:s.brand,version:s.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Cn(Gs,n).brand||Fs(Is())},a={name:"unknown",version:"-1",majorVersion:-1};i.webkit=!i.chromium&&or(cr,function(d){return Bs(n,d)});var c=Cn(As,n);if(i.chromium=!!c.brand,i.chromiumVersion=c.version,!i.chromium){var l=Cn(cr,n);i.webkit=!!l.brand,i.webkitVersion=l.version}var u=ws(ks,function(d){return new RegExp(""+d.test,"g").exec(o)});a.name=u?u.id:"";{var f=Cn(zs,n);i.name=f.brand||i.name,i.version=f.brand&&t?t.uaFullVersion:f.version}return i.webkit&&(a.name=r?"ios":"mac"),a.name==="ios"&&i.webview&&(i.version="-1"),a.version=ar(a.version),i.version=ar(i.version),a.majorVersion=parseInt(a.version,10),i.majorVersion=parseInt(i.version,10),{browser:i,os:a,isMobile:r,isHints:!0}}function Oa(t){return Ma()?Ta():_a(t)}const wa=["n","w","s","e"],Dn=["n","w","s","e","nw","ne","sw","se"];function Ia(t,e){return`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="${32*t}px" height="${32*t}px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(${e}deg);transform-origin: 16px 16px"></path></svg>`}function Ba(t){const e=Ia(1,t),n=Math.round(t/45)*45%180;let r="ns-resize";return n===135?r="nwse-resize":n===45?r="nesw-resize":n===90&&(r="ew-resize"),`cursor:${r};cursor: url('${e}') 16 16, ${r};`}const Ie=Oa(),$s=Ie.browser.webkit,Ls=$s&&(()=>{const t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),Ns=Ie.browser.name,Ws=parseInt(Ie.browser.version,10),za=Ns==="chrome",Aa=Ie.browser.chromium,Ga=parseInt(Ie.browser.chromiumVersion,10)||0,ka=za&&Ws>=109||Aa&&Ga>=109,Fa=Ns==="firefox",$a=parseInt(Ie.browser.webkitVersion,10)>=612||Ws>=15,lr="moveable-",La=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
${Dn.map(t=>{let e="",n="",r="center",s="center";const o="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e=`top: ${o};`,s="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",s="top"),t.indexOf("w")>-1&&(n=`left: ${o};`,r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),`.around-control[data-direction*="${t}"] {
        ${n}${e}
        transform-origin: ${r} ${s};
    }`}).join(`
`)}
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
${[0,15,30,45,60,75,90,105,120,135,150,165].map(t=>`
.direction[data-rotation="${t}"], :global .view-control-rotation${t} {
${Ba(t)}
}
`).join(`
`)}

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

${Ls?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:""}
`,Na=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],ur=1e-4,It=1e-7,bn=1e-9,fr=Math.pow(10,10),Ys=-fr,Wa={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},dr={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},Vs={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Ya=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Va(t,...e){return e.map(n=>n.split(" ").map(r=>r?`${t}${r}`:"").join(" ")).join(" ")}function ja(t,e){return e.replace(/([^}{]*){/gm,(n,r)=>`${r.replace(/\.([^{,\s\d.]+)/g,`.${t}$1`)}{`)}function ge(t,e){return n=>{n&&(t[e]=n)}}function js(t,e,n){return r=>{r&&(t[e][n]=r)}}var Ha="function",Xa="object",qa="string",Ua="number",pr="undefined",Hs=typeof window!==pr,Ka=typeof document!==pr&&document,Za=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Ct=1e-7,yn={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Ja(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var o=arguments[e],i=0,a=o.length;i<a;i++,s++)r[s]=o[i];return r}function Rn(t,e,n,r){return(t*r+e*n)/(n+r)}function gr(t){return typeof t===pr}function qt(t){return t&&typeof t===Xa}function Pt(t){return Array.isArray(t)}function ne(t){return typeof t===qa}function Qe(t){return typeof t===Ua}function hr(t){return typeof t===Ha}function Qa(t,e){var n=t===""||t==" ",r=e===""||e==" ";return r&&n||t===e}function Xs(t,e,n,r,s){var o=vr(t,e,n);return o?n:tc(t,e,n+1,r,s)}function vr(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function tc(t,e,n,r,s){for(var o=function(l){var u=e[l].trim();if(u===t.close&&!vr(t,e,l))return{value:l};var f=l,d=$t(s,function(p){var g=p.open;return g===u});if(d&&(f=Xs(d,e,l,r,s)),f===-1)return i=l,"break";l=f,i=l},i,a=n;a<r;++a){var c=o(a);if(a=i,typeof c=="object")return c.value;if(c==="break")break}return-1}function mr(t,e){var n=ne(e)?{separator:e}:e,r=n.separator,s=r===void 0?",":r,o=n.isSeparateFirst,i=n.isSeparateOnlyOpenClose,a=n.isSeparateOpenClose,c=a===void 0?i:a,l=n.openCloseCharacters,u=l===void 0?Za:l,f=u.map(function(R){var y=R.open,M=R.close;return y===M?y:y+"|"+M}).join("|"),d="(\\s*"+s+"\\s*|"+f+"|\\s+)",p=new RegExp(d,"g"),g=t.split(p).filter(function(R){return R&&R!=="undefined"}),h=g.length,v=[],m=[];function S(){return m.length?(v.push(m.join("")),m=[],!0):!1}for(var x=function(R){var y=g[R].trim(),M=R,P=$t(u,function(T){var w=T.open;return w===y}),_=$t(u,function(T){var w=T.close;return w===y});if(P){if(M=Xs(P,g,R,h,u),M!==-1&&c)return S()&&o||(v.push(g.slice(R,M+1).join("")),R=M,o)?(C=R,"break"):(C=R,"continue")}else if(_&&!vr(_,g,R)){var O=Ja(u);return O.splice(u.indexOf(_),1),{value:mr(t,{separator:s,isSeparateFirst:o,isSeparateOnlyOpenClose:i,isSeparateOpenClose:c,openCloseCharacters:O})}}else if(Qa(y,s)&&!i)return S(),o?(C=R,"break"):(C=R,"continue");M===-1&&(M=h-1),m.push(g.slice(R,M+1).join("")),R=M,C=R},C,E=0;E<h;++E){var D=x(E);if(E=C,typeof D=="object")return D.value;if(D==="break")break}return m.length&&v.push(m.join("")),v}function ie(t){return mr(t,"")}function he(t){return mr(t,",")}function qs(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function tn(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],s=e[3];return{prefix:n,unit:s,value:parseFloat(r)}}function ec(t,e){return t.replace(/([a-z])([A-Z])/g,function(n,r,s){return""+r+e+s.toLowerCase()})}function en(){return Date.now?Date.now():new Date().getTime()}function re(t,e,n){n===void 0&&(n=-1);for(var r=t.length,s=0;s<r;++s)if(e(t[s],s,t))return s;return n}function $t(t,e,n){var r=re(t,e);return r>-1?t[r]:n}var Us=function(){var t=en(),e=Hs&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(n){var r=en(),s=setTimeout(function(){n(r-t)},1e3/60);return s}}(),nc=function(){var t=Hs&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}}();function Be(t){return Object.keys(t)}function ut(t,e){var n=tn(t),r=n.value,s=n.unit;if(qt(e)){var o=e[s];if(o){if(hr(o))return o(r);if(yn[s])return yn[s](r,o)}}else if(s==="%")return r*e/100;return yn[s]?yn[s](r):r}function xr(t,e,n){return Math.max(e,Math.min(t,n))}function Ks(t,e,n,r){return r===void 0&&(r=t[0]/t[1]),[[tt(e[0],Ct),tt(e[0]/r,Ct)],[tt(e[1]*r,Ct),tt(e[1],Ct)]].filter(function(s){return s.every(function(o,i){var a=e[i],c=tt(a,Ct);return n?o<=a||o<=c:o>=a||o>=c})})[0]||t}function Zs(t,e,n,r){if(!r)return t.map(function(p,g){return xr(p,e[g],n[g])});var s=t[0],o=t[1],i=r===!0?s/o:r,a=Ks(t,e,!1,i),c=a[0],l=a[1],u=Ks(t,n,!0,i),f=u[0],d=u[1];return s<c||o<l?(s=c,o=l):(s>f||o>d)&&(s=f,o=d),[s,o]}function rc(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function Sr(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function xt(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=Math.atan2(r,n);return s>=0?s:s+Math.PI*2}function sc(t){return[0,1].map(function(e){return Sr(t.map(function(n){return n[e]}))})}function Js(t){var e=sc(t),n=xt(e,t[0]),r=xt(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function se(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function tt(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function Qs(t,e){return t.forEach(function(n,r){t[r]=tt(t[r],e)}),t}function oc(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}function ic(t){return t.reduce(function(e,n){return e.concat(n)},[])}function to(t,e){t.indexOf(e)===-1&&t.push(e)}function Rt(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function eo(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function no(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function Tt(t,e,n,r){t.addEventListener(e,n,r)}function _t(t,e,n,r){t.removeEventListener(e,n,r)}function Er(t){return(t==null?void 0:t.ownerDocument)||Ka}function Cr(t){return Er(t).documentElement}function ae(t){return Er(t).body}function ce(t){var e;return((e=t==null?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function ro(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function Dr(t){return qt(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function ac(t,e,n,r,s,o){for(var i=0;i<s;++i){var a=n+i*s,c=r+i*s;t[a]+=t[c]*o,e[a]+=e[c]*o}}function cc(t,e,n,r,s){for(var o=0;o<s;++o){var i=n+o*s,a=r+o*s,c=t[i],l=e[i];t[i]=t[a],t[a]=c,e[i]=e[a],e[a]=l}}function lc(t,e,n,r,s){for(var o=0;o<r;++o){var i=n+o*r;t[i]/=s,e[i]/=s}}function so(t,e,n){for(var r=t.slice(),s=0;s<n;++s)r[s*n+e-1]=0,r[(e-1)*n+s]=0;return r[(e-1)*(n+1)]=1,r}function Jt(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=ht(e),s=0;s<e;++s){var o=e*s+s;if(!tt(n[o],Ct)){for(var i=s+1;i<e;++i)if(n[e*s+i]){cc(n,r,s,i,e);break}}if(!tt(n[o],Ct))return[];lc(n,r,s,e,n[o]);for(var i=0;i<e;++i){var a=i,c=i+s*e,l=n[c];!tt(l,Ct)||s===i||ac(n,r,a,s,e,-l)}}return r}function uc(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var s=0;s<e;++s)n[s*e+r]=t[e*r+s];return n}function oo(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],s=0;s<e-1;++s)n[s]=t[e*(e-1)+s]/r;return n[e-1]=0,n}function fc(t,e){for(var n=ht(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function ve(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function Ut(t,e,n){if(e===void 0&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=ht(n),s=Math.min(e,n),o=0;o<s-1;++o){for(var i=0;i<s-1;++i)r[o*n+i]=t[o*e+i];r[(o+1)*n-1]=t[(o+1)*e-1],r[(n-1)*n+o]=t[(e-1)*e+o]}return r[n*n-1]=t[e*e-1],r}function Mn(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=ht(t);return e.forEach(function(s){r=ft(r,s,t)}),r}function ft(t,e,n){n===void 0&&(n=Math.sqrt(t.length));var r=[],s=t.length/n,o=e.length/s;if(s){if(!o)return t}else return e;for(var i=0;i<n;++i)for(var a=0;a<o;++a){r[a*n+i]=0;for(var c=0;c<s;++c)r[a*n+i]+=t[c*n+i]*e[a*s+c]}return r}function ct(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),s=0;s<n;++s)r[s]=r[s]+e[s];return r}function K(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),s=0;s<n;++s)r[s]=r[s]-e[s];return r}function dc(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function io(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Ot(t,e,n){n===void 0&&(n=e.length);var r=ft(t,e,n),s=r[n-1];return r.map(function(o){return o/s})}function pc(t,e){return ft(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function gc(t,e){return ft(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function hc(t,e){return ft(t,rn(e,4))}function Pn(t,e){var n=e[0],r=n===void 0?1:n,s=e[1],o=s===void 0?1:s,i=e[2],a=i===void 0?1:i;return ft(t,[r,0,0,0,0,o,0,0,0,0,a,0,0,0,0,1],4)}function nn(t,e){return Ot(rn(e,3),ve(t,3))}function br(t,e){var n=e[0],r=n===void 0?0:n,s=e[1],o=s===void 0?0:s,i=e[2],a=i===void 0?0:i;return ft(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,o,a,1],4)}function ao(t,e){return ft(t,e,4)}function rn(t,e){var n=Math.cos(t),r=Math.sin(t),s=ht(e);return s[0]=n,s[1]=r,s[e]=-r,s[e+1]=n,s}function ht(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function yr(t,e){for(var n=ht(e),r=Math.min(t.length,e-1),s=0;s<r;++s)n[(e+1)*s]=t[s];return n}function me(t,e){for(var n=ht(e),r=Math.min(t.length,e-1),s=0;s<r;++s)n[e*(e-1)+s]=t[s];return n}function Rr(t,e,n,r,s,o,i,a){var c=t[0],l=t[1],u=e[0],f=e[1],d=n[0],p=n[1],g=r[0],h=r[1],v=s[0],m=s[1],S=o[0],x=o[1],C=i[0],E=i[1],D=a[0],R=a[1],y=[c,0,u,0,d,0,g,0,l,0,f,0,p,0,h,0,1,0,1,0,1,0,1,0,0,c,0,u,0,d,0,g,0,l,0,f,0,p,0,h,0,1,0,1,0,1,0,1,-v*c,-m*c,-S*u,-x*u,-C*d,-E*d,-D*g,-R*g,-v*l,-m*l,-S*f,-x*f,-C*p,-E*p,-D*h,-R*h],M=Jt(y,8);if(!M.length)return[];var P=ft(M,[v,m,S,x,C,E,D,R],8);return P[8]=1,Ut(uc(P),3,4)}var sn=function(){return sn=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},sn.apply(this,arguments)};function vc(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function on(t,e){return e===void 0&&(e=0),ze(Ae(t,e))}function mc(t,e){var n=Ot(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function ze(t){var e=vc();return t.forEach(function(n){var r=n.matrixFunction,s=n.functionValue;r&&(e=r(e,s))}),e}function Ae(t,e){e===void 0&&(e=0);var n=Pt(t)?t:ie(t);return n.map(function(r){var s=qs(r),o=s.prefix,i=s.value,a=null,c=o,l="";if(o==="translate"||o==="translateX"||o==="translate3d"){var u=qt(e)?sn(sn({},e),{"o%":e["%"]}):{"%":e,"o%":e},f=he(i).map(function(T,w){return w===0&&"x%"in u?u["%"]=e["x%"]:w===1&&"y%"in u?u["%"]=e["y%"]:u["%"]=e["o%"],ut(T,u)}),d=f[0],p=f[1],g=p===void 0?0:p,h=f[2],v=h===void 0?0:h;a=br,l=[d,g,v]}else if(o==="translateY"){var m=qt(e)?sn({"%":e["y%"]},e):{"%":e},g=ut(i,m);a=br,l=[0,g,0]}else if(o==="translateZ"){var v=parseFloat(i);a=br,l=[0,0,v]}else if(o==="scale"||o==="scale3d"){var S=he(i).map(function(T){return parseFloat(T)}),x=S[0],C=S[1],E=C===void 0?x:C,D=S[2],R=D===void 0?1:D;a=Pn,l=[x,E,R]}else if(o==="scaleX"){var x=parseFloat(i);a=Pn,l=[x,1,1]}else if(o==="scaleY"){var E=parseFloat(i);a=Pn,l=[1,E,1]}else if(o==="scaleZ"){var R=parseFloat(i);a=Pn,l=[1,1,R]}else if(o==="rotate"||o==="rotateZ"||o==="rotateX"||o==="rotateY"){var y=tn(i),M=y.unit,P=y.value,_=M==="rad"?P:P*Math.PI/180;o==="rotate"||o==="rotateZ"?(c="rotateZ",a=hc):o==="rotateX"?a=pc:o==="rotateY"&&(a=gc),l=_}else if(o==="matrix3d")a=ao,l=he(i).map(function(T){return parseFloat(T)});else if(o==="matrix"){var O=he(i).map(function(T){return parseFloat(T)});a=ao,l=[O[0],O[1],0,0,O[2],O[3],0,0,0,0,1,0,O[4],O[5],0,1]}else c="";return{name:o,functionName:c,value:i,matrixFunction:a,functionValue:l}})}function an(t,e,n,r,s,o="draggable"){var l;const i=((l=e.gestos[o])==null?void 0:l.move(n,t.inputEvent))??{},a=i.originalDatas||i.datas,c=a[o]||(a[o]={});return{...i,isPinch:!!r,parentEvent:!0,datas:c,originalDatas:t.originalDatas}}class Ge{constructor(e="draggable"){H(this,"prevX",0);H(this,"prevY",0);H(this,"startX",0);H(this,"startY",0);H(this,"isDrag",!1);H(this,"isFlag",!1);H(this,"datas",{draggable:{}});this.ableName=e,this.datas={[e]:{}}}dragStart(e,n){this.isDrag=!1,this.isFlag=!1;const r=n.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),{...this.move(e,n.inputEvent),type:"dragstart"}}drag(e,n){return this.move([e[0]-this.prevX,e[1]-this.prevY],n)}move(e,n){let r,s,o=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],s=e[1],this.isFlag=!0;else{const i=this.isDrag;r=this.prevX+e[0],s=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!i&&this.isDrag&&(o=!0)}return this.prevX=r,this.prevY=s,{type:"drag",clientX:r,clientY:s,inputEvent:n,isFirstDrag:o,isDrag:this.isDrag,distX:r-this.startX,distY:s-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}}}function xe(t,e,n,r){const o=t.length===16?4:3,i=De(t,n,r,o);let[[a,c],[l,u],[f,d],[p,g]]=i,[h,v]=mt(t,e,o);const m=Math.min(a,l,f,p),S=Math.min(c,u,d,g),x=Math.max(a,l,f,p),C=Math.max(c,u,d,g);a=a-m||0,l=l-m||0,f=f-m||0,p=p-m||0,c=c-S||0,u=u-S||0,d=d-S||0,g=g-S||0,h=h-m||0,v=v-S||0;const E=t[0],D=t[o+1],R=zt(E*D);return{left:m,top:S,right:x,bottom:C,origin:[h,v],pos1:[a,c],pos2:[l,u],pos3:[f,d],pos4:[p,g],direction:R}}function co(t,e){const{clientX:n,clientY:r,datas:s}=e,{moveableClientRect:o,rootMatrix:i,is3d:a,pos1:c}=t.state,{left:l,top:u}=o,f=a?4:3,[d,p]=K(Ve(i,[n-l,r-u],f),c),[g,h]=Qt({datas:s,distX:d,distY:p});return[g,h]}function Se(t,{datas:e}){const{allMatrix:n,beforeMatrix:r,is3d:s,left:o,top:i,origin:a,offsetMatrix:c,targetMatrix:l,transformOrigin:u}=t.state,f=s?4:3;e.is3d=s,e.matrix=n,e.targetMatrix=l,e.beforeMatrix=r,e.offsetMatrix=c,e.transformOrigin=u,e.inverseMatrix=Jt(n,f),e.inverseBeforeMatrix=Jt(r,f),e.absoluteOrigin=ve(ct([o,i],a),f),e.startDragBeforeDist=Ot(e.inverseBeforeMatrix,e.absoluteOrigin,f),e.startDragDist=Ot(e.inverseMatrix,e.absoluteOrigin,f)}function xc(t){return xe(t.datas.beforeTransform,[50,50],100,100).direction}function _n(t,e,n){const{datas:r,originalDatas:{beforeRenderable:s}}=e,o=r.transformIndex,i=s.nextTransforms,a=i.length,c=s.nextTransformAppendedIndexes;let l=-1;o===-1?(n==="translate"?l=0:n==="rotate"&&(l=re(i,p=>p.match(/scale\(/g))),l===-1&&(l=i.length),r.transformIndex=l):$t(c,p=>p.index===o&&p.functionName===n)?l=o:l=o+c.filter(p=>p.index<o).length;const u=Jl(i,t.state,l),f=u.targetFunction,d=n==="rotate"?"rotateZ":n;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,f.functionName===d?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):a>l&&(r.isAppendTransform=!0,s.nextTransformAppendedIndexes=[...c,{functionName:n,index:l,isAppend:!0}])}function Tn(t,e,n){return`${t.beforeFunctionTexts.join(" ")} ${t.isAppendTransform?n:e} ${t.afterFunctionTexts.join(" ")}`}function Sc({datas:t,distX:e,distY:n}){const[r,s]=uo({datas:t,distX:e,distY:n}),o=lo(t,fc([r,s],4));return Ot(o,ve([0,0,0],4),4)}function lo(t,e,n){const{beforeTransform:r,afterTransform:s,beforeTransform2:o,afterTransform2:i,targetAllTransform:a}=t,c=n?ft(a,e,4):ft(e,a,4),l=ft(Jt(n?o:r,4),c,4);return ft(l,Jt(n?i:s,4),4)}function uo({datas:t,distX:e,distY:n}){const{inverseBeforeMatrix:r,is3d:s,startDragBeforeDist:o,absoluteOrigin:i}=t,a=s?4:3;return K(Ot(r,ct(i,[e,n]),a),o)}function Qt({datas:t,distX:e,distY:n},r){const{inverseBeforeMatrix:s,inverseMatrix:o,is3d:i,startDragBeforeDist:a,startDragDist:c,absoluteOrigin:l}=t,u=i?4:3;return K(Ot(r?s:o,ct(l,[e,n]),u),r?a:c)}function Ec({datas:t,distX:e,distY:n},r){const{beforeMatrix:s,matrix:o,is3d:i,startDragBeforeDist:a,startDragDist:c,absoluteOrigin:l}=t,u=i?4:3;return K(Ot(o,ct(c,[e,n]),u),l)}function Cc(t,e,n,r=e,s=n,o=[0,0]){return t?t.map((i,a)=>{const{value:c,unit:l}=tn(i),u=a?s:r,f=a?n:e;if(i==="%"||isNaN(c)){const d=u?o[a]/u:0;return f*d}else if(l!=="%")return c;return f*c/100}):o}function fo(t){const e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function Dc(t,e){return fo(e).map(n=>t[n])}function Mr(t,e){const n=(e+1)/2;return[Rn(t[0][0],t[1][0],n,1-n),Rn(t[0][1],t[1][1],n,1-n)]}function Mt(t,e){const n=Mr([t[0],t[1]],e[0]),r=Mr([t[2],t[3]],e[0]);return Mr([n,r],e[1])}function bc(t,e,n,r,s,o){const i=De(e,n,r,s),a=Mt(i,o),c=t[0]-a[0],l=t[1]-a[1];return[c,l]}function cn(t,e,n,r){return ft(t,gn(e,r,n),r)}function yc(t,e,n,r){const{transformOrigin:s,offsetMatrix:o,is3d:i}=t,a=i?4:3;let c;if(ne(n)){const{beforeTransform:l,afterTransform:u}=e;r?c=Ut(on(n),4,a):c=Ut(ft(ft(l,on([n]),4),u,4),4,a)}else c=n;return cn(o,c,s,a)}function Rc(t,e){const{transformOrigin:n,offsetMatrix:r,is3d:s,targetMatrix:o,targetAllTransform:i}=t,a=s?4:3;return cn(r,ft(i||o,yr(e,a),a),n,a)}function On(t,e){const n=ke(e);return{setTransform:(r,s=-1)=>{n.startTransforms=Pt(r)?r:ie(r),Pr(t,e,s)},setTransformIndex:r=>{Pr(t,e,r)}}}function wn(t,e,n){const s=ke(e).startTransforms;Pr(t,e,re(s,o=>o.indexOf(`${n}(`)===0))}function Pr(t,e,n){const r=ke(e),s=e.datas;if(s.transformIndex=n,n===-1)return;const o=r.startTransforms[n];if(!o)return;const i=t.state,a=Ae([o],{"x%":c=>c/100*i.offsetWidth,"y%":c=>c/100*i.offsetHeight});s.startValue=a[0].functionValue}function _r(t,e){const n=ke(t);n.nextTransforms=ie(e)}function ke(t){return t.originalDatas.beforeRenderable}function In(t){const{originalDatas:{beforeRenderable:e}}=t;return e.nextTransforms}function Bn(t){return(In(t)||[]).join(" ")}function zn(t){return ke(t).nextStyle}function po(t,e,n,r,s){_r(s,e);const o=wt.drag(t,an(s,t.state,n,r)),i=o?o.transform:e;return{transform:e,drag:o,...Bt({transform:i},s),afterTransform:i}}function Tr(t,e,n,r,s,o){const i=yc(t.state,s,e,o);return _c(t,n,r,i)}function go(t,e,n,r,s,o,i){const a=Tr(t,e,n,s,o,i),c=t.state,{left:l,top:u}=c,f=t.props.groupable,d=f?l:0,p=f?u:0,g=K(r,a);return K(g,[d,p])}function Mc(t,e,n,r,s,o,i){return go(t,e,n,r,s,o,i)}function Pc(t,e,n){return[e?-1+t[0]/(e/2):0,n?-1+t[1]/(n/2):0]}function _c(t,e,n,r=t.state.allMatrix){const{width:s,height:o,is3d:i}=t.state,a=i?4:3,c=[s/2*(1+e[0])+n[0],o/2*(1+e[1])+n[1]];return mt(r,c,a)}function Tc(t,e,n){const r=n.fixedDirection,s=n.fixedPosition,o=n.fixedOffset;return go(t,`rotate(${e}deg)`,r,s,o,n)}function Oc(t,e,n,r,s,o){const{groupable:i}=t.props,a=t.state,{transformOrigin:c,offsetMatrix:l,is3d:u,width:f,height:d,left:p,top:g}=a,h=o.fixedDirection,v=o.nextTargetMatrix||a.targetMatrix,m=u?4:3,S=Cc(s,e,n,f,d,c),x=i?p:0,C=i?g:0,E=cn(l,v,S,m),D=bc(r,E,e,n,m,h);return K(D,[x,C])}function wc(t,e){return Mt(Yt(t.state),e)}function Ic(t,e){const n=t.targetGesto,r=t.controlGesto;let s;return n!=null&&n.isFlag()&&(s=n.getEventData()[e]),!s&&(r!=null&&r.isFlag())&&(s=r.getEventData()[e]),s||{}}function Bc(t){if(t&&t.getRootNode){const e=t.getRootNode();if(e.nodeType===11)return e}}function zc(t){const e=t("scale"),n=t("rotate"),r=t("translate"),s=[];return r&&r!=="0px"&&r!=="none"&&s.push(`translate(${r.split(/\s+/).join(",")})`),n&&n!=="1"&&n!=="none"&&s.push(`rotate(${n})`),e&&e!=="1"&&e!=="none"&&s.push(`scale(${e.split(/\s+/).join(",")})`),s}function ho(t,e,n){let r=t;const s=[],o=Cr(t)||ae(t);let i=!n&&t===e||t===o,a=i,c=!1,l=3,u,f,d,p=!1,g=hn(e,e,!0).offsetParent,h=1;for(;r&&!a;){a=i;const v=Gt(r),m=v("position"),S=ai(r),x=m==="fixed",C=zc(v);let E=dc($l(S)),D,R=!1,y=!1,M=0,P=0,_=0,O=0,T={hasTransform:!1,fixedContainer:null};x&&(p=!0,T=Vl(r),g=T.fixedContainer);const w=E.length;!c&&(w===16||C.length)&&(c=!0,l=4,qr(s),d&&(d=Ut(d,3,4))),c&&w===9&&(E=Ut(E,3,4));const{tagName:k,hasOffset:I,isSVG:F,origin:G,targetOrigin:L,offset:z}=Yl(r,t);let[N,Z]=z;k==="svg"&&!r.ownerSVGElement&&d&&(s.push({type:"target",target:r,matrix:jl(r,l)}),s.push({type:"offset",target:r,matrix:ht(l)}));const Y=parseFloat(v("zoom"))||1;if(x)D=T.fixedContainer,R=!0;else{const W=hn(r,e,!1,!0,v),J=W.offsetZoom;if(D=W.offsetParent,R=W.isEnd,y=W.isStatic,h*=J,(W.isCustomElement||J!==1)&&y)N-=D.offsetLeft,Z-=D.offsetTop;else if((Fa||ka)&&W.parentSlotElement){let $=D,X=0,nt=0;for(;$&&Bc($);)X+=$.offsetLeft,nt+=$.offsetTop,$=$.offsetParent;N-=X,Z-=nt}}if($s&&!$a&&I&&!F&&y&&(m==="relative"||m==="static")&&(N-=D.offsetLeft,Z-=D.offsetTop,i=i||R),x)I&&T.hasTransform&&(_=D.clientLeft,O=D.clientTop);else if(I&&g!==D&&(M=D.clientLeft,P=D.clientTop),I&&D===o){const W=ci(r,!1);N+=W[0],Z+=W[1]}if(s.push({type:"target",target:r,matrix:gn(E,l,G)}),C.length&&(s.push({type:"offset",target:r,matrix:ht(l)}),s.push({type:"target",target:r,matrix:gn(on(C),l,G)})),I){const W=r===t,J=W?0:r.scrollLeft,q=W?0:r.scrollTop;s.push({type:"offset",target:r,matrix:me([N-J+M-_,Z-q+P-O],l)})}else s.push({type:"offset",target:r,origin:G});if(Y!==1&&s.push({type:"zoom",target:r,matrix:gn(yr([Y,Y],l),l,[0,0])}),d||(d=E),u||(u=G),f||(f=L),a||x)break;r=D,i=R,(!n||r===o)&&(a=i)}return d||(d=ht(l)),u||(u=[0,0]),f||(f=[0,0]),{zoom:h,offsetContainer:g,matrixes:s,targetMatrix:d,transformOrigin:u,targetOrigin:f,is3d:c,hasFixed:p}}let Ee=null,Ce=null,Fe=null;function $e(t){t?(window.Map&&(Ee=new Map,Ce=new Map),Fe=[]):(Ee=null,Fe=null,Ce=null)}function Ac(t){const e=Ce==null?void 0:Ce.get(t);if(e)return e;const n=mn(t,!0);return Ce&&Ce.set(t,n),n}function Gc(t,e){if(Fe){const r=$t(Fe,s=>s[0][0]==t&&s[0][1]==e);if(r)return r[1]}const n=ho(t,e,!0);return Fe&&Fe.push([[t,e],n]),n}function Gt(t){let e=Ee==null?void 0:Ee.get(t);if(!e){const s=ce(t).getComputedStyle(t);if(!Ee)return o=>s[o];e={style:s,cached:{}},Ee.set(t,e)}const n=e.cached,r=e.style;return s=>(s in n||(n[s]=r[s]),n[s])}var Or={exports:{}},ln={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vo;function kc(){if(vo)return ln;vo=1;var t=vt,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(a,c,l){var u,f={},d=null,p=null;l!==void 0&&(d=""+l),c.key!==void 0&&(d=""+c.key),c.ref!==void 0&&(p=c.ref);for(u in c)r.call(c,u)&&!o.hasOwnProperty(u)&&(f[u]=c[u]);if(a&&a.defaultProps)for(u in c=a.defaultProps,c)f[u]===void 0&&(f[u]=c[u]);return{$$typeof:e,type:a,key:d,ref:p,props:f,_owner:s.current}}return ln.Fragment=n,ln.jsx=i,ln.jsxs=i,ln}var un={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mo;function Fc(){return mo||(mo=1,process.env.NODE_ENV!=="production"&&function(){var t=vt,e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),g=Symbol.iterator,h="@@iterator";function v(b){if(b===null||typeof b!="object")return null;var A=g&&b[g]||b[h];return typeof A=="function"?A:null}var m=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function S(b){{for(var A=arguments.length,V=new Array(A>1?A-1:0),Q=1;Q<A;Q++)V[Q-1]=arguments[Q];x("error",b,V)}}function x(b,A,V){{var Q=m.ReactDebugCurrentFrame,lt=Q.getStackAddendum();lt!==""&&(A+="%s",V=V.concat([lt]));var gt=V.map(function(it){return String(it)});gt.unshift("Warning: "+A),Function.prototype.apply.call(console[b],console,gt)}}var C=!1,E=!1,D=!1,R=!1,y=!1,M;M=Symbol.for("react.module.reference");function P(b){return!!(typeof b=="string"||typeof b=="function"||b===r||b===o||y||b===s||b===l||b===u||R||b===p||C||E||D||typeof b=="object"&&b!==null&&(b.$$typeof===d||b.$$typeof===f||b.$$typeof===i||b.$$typeof===a||b.$$typeof===c||b.$$typeof===M||b.getModuleId!==void 0))}function _(b,A,V){var Q=b.displayName;if(Q)return Q;var lt=A.displayName||A.name||"";return lt!==""?V+"("+lt+")":V}function O(b){return b.displayName||"Context"}function T(b){if(b==null)return null;if(typeof b.tag=="number"&&S("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case r:return"Fragment";case n:return"Portal";case o:return"Profiler";case s:return"StrictMode";case l:return"Suspense";case u:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case a:var A=b;return O(A)+".Consumer";case i:var V=b;return O(V._context)+".Provider";case c:return _(b,b.render,"ForwardRef");case f:var Q=b.displayName||null;return Q!==null?Q:T(b.type)||"Memo";case d:{var lt=b,gt=lt._payload,it=lt._init;try{return T(it(gt))}catch{return null}}}return null}var w=Object.assign,k=0,I,F,G,L,z,N,Z;function Y(){}Y.__reactDisabledLog=!0;function W(){{if(k===0){I=console.log,F=console.info,G=console.warn,L=console.error,z=console.group,N=console.groupCollapsed,Z=console.groupEnd;var b={configurable:!0,enumerable:!0,value:Y,writable:!0};Object.defineProperties(console,{info:b,log:b,warn:b,error:b,group:b,groupCollapsed:b,groupEnd:b})}k++}}function J(){{if(k--,k===0){var b={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:w({},b,{value:I}),info:w({},b,{value:F}),warn:w({},b,{value:G}),error:w({},b,{value:L}),group:w({},b,{value:z}),groupCollapsed:w({},b,{value:N}),groupEnd:w({},b,{value:Z})})}k<0&&S("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var q=m.ReactCurrentDispatcher,$;function X(b,A,V){{if($===void 0)try{throw Error()}catch(lt){var Q=lt.stack.trim().match(/\n( *(at )?)/);$=Q&&Q[1]||""}return`
`+$+b}}var nt=!1,dt;{var St=typeof WeakMap=="function"?WeakMap:Map;dt=new St}function st(b,A){if(!b||nt)return"";{var V=dt.get(b);if(V!==void 0)return V}var Q;nt=!0;var lt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var gt;gt=q.current,q.current=null,W();try{if(A){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(Ft){Q=Ft}Reflect.construct(b,[],it)}else{try{it.call()}catch(Ft){Q=Ft}b.call(it.prototype)}}else{try{throw Error()}catch(Ft){Q=Ft}b()}}catch(Ft){if(Ft&&Q&&typeof Ft.stack=="string"){for(var rt=Ft.stack.split(`
`),At=Q.stack.split(`
`),Et=rt.length-1,yt=At.length-1;Et>=1&&yt>=0&&rt[Et]!==At[yt];)yt--;for(;Et>=1&&yt>=0;Et--,yt--)if(rt[Et]!==At[yt]){if(Et!==1||yt!==1)do if(Et--,yt--,yt<0||rt[Et]!==At[yt]){var Xt=`
`+rt[Et].replace(" at new "," at ");return b.displayName&&Xt.includes("<anonymous>")&&(Xt=Xt.replace("<anonymous>",b.displayName)),typeof b=="function"&&dt.set(b,Xt),Xt}while(Et>=1&&yt>=0);break}}}finally{nt=!1,q.current=gt,J(),Error.prepareStackTrace=lt}var Ze=b?b.displayName||b.name:"",Te=Ze?X(Ze):"";return typeof b=="function"&&dt.set(b,Te),Te}function jt(b,A,V){return st(b,!1)}function Ht(b){var A=b.prototype;return!!(A&&A.isReactComponent)}function pt(b,A,V){if(b==null)return"";if(typeof b=="function")return st(b,Ht(b));if(typeof b=="string")return X(b);switch(b){case l:return X("Suspense");case u:return X("SuspenseList")}if(typeof b=="object")switch(b.$$typeof){case c:return jt(b.render);case f:return pt(b.type,A,V);case d:{var Q=b,lt=Q._payload,gt=Q._init;try{return pt(gt(lt),A,V)}catch{}}}return""}var bt=Object.prototype.hasOwnProperty,ee={},_e=m.ReactDebugCurrentFrame;function Ue(b){if(b){var A=b._owner,V=pt(b.type,b._source,A?A.type:null);_e.setExtraStackFrame(V)}else _e.setExtraStackFrame(null)}function sf(b,A,V,Q,lt){{var gt=Function.call.bind(bt);for(var it in b)if(gt(b,it)){var rt=void 0;try{if(typeof b[it]!="function"){var At=Error((Q||"React class")+": "+V+" type `"+it+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof b[it]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw At.name="Invariant Violation",At}rt=b[it](A,it,Q,V,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Et){rt=Et}rt&&!(rt instanceof Error)&&(Ue(lt),S("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Q||"React class",V,it,typeof rt),Ue(null)),rt instanceof Error&&!(rt.message in ee)&&(ee[rt.message]=!0,Ue(lt),S("Failed %s type: %s",V,rt.message),Ue(null))}}}var of=Array.isArray;function ys(b){return of(b)}function af(b){{var A=typeof Symbol=="function"&&Symbol.toStringTag,V=A&&b[Symbol.toStringTag]||b.constructor.name||"Object";return V}}function cf(b){try{return ha(b),!1}catch{return!0}}function ha(b){return""+b}function va(b){if(cf(b))return S("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",af(b)),ha(b)}var En=m.ReactCurrentOwner,lf={key:!0,ref:!0,__self:!0,__source:!0},ma,xa,Rs;Rs={};function uf(b){if(bt.call(b,"ref")){var A=Object.getOwnPropertyDescriptor(b,"ref").get;if(A&&A.isReactWarning)return!1}return b.ref!==void 0}function ff(b){if(bt.call(b,"key")){var A=Object.getOwnPropertyDescriptor(b,"key").get;if(A&&A.isReactWarning)return!1}return b.key!==void 0}function df(b,A){if(typeof b.ref=="string"&&En.current&&A&&En.current.stateNode!==A){var V=T(En.current.type);Rs[V]||(S('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(En.current.type),b.ref),Rs[V]=!0)}}function pf(b,A){{var V=function(){ma||(ma=!0,S("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",A))};V.isReactWarning=!0,Object.defineProperty(b,"key",{get:V,configurable:!0})}}function gf(b,A){{var V=function(){xa||(xa=!0,S("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",A))};V.isReactWarning=!0,Object.defineProperty(b,"ref",{get:V,configurable:!0})}}var hf=function(b,A,V,Q,lt,gt,it){var rt={$$typeof:e,type:b,key:A,ref:V,props:it,_owner:gt};return rt._store={},Object.defineProperty(rt._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(rt,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Q}),Object.defineProperty(rt,"_source",{configurable:!1,enumerable:!1,writable:!1,value:lt}),Object.freeze&&(Object.freeze(rt.props),Object.freeze(rt)),rt};function vf(b,A,V,Q,lt){{var gt,it={},rt=null,At=null;V!==void 0&&(va(V),rt=""+V),ff(A)&&(va(A.key),rt=""+A.key),uf(A)&&(At=A.ref,df(A,lt));for(gt in A)bt.call(A,gt)&&!lf.hasOwnProperty(gt)&&(it[gt]=A[gt]);if(b&&b.defaultProps){var Et=b.defaultProps;for(gt in Et)it[gt]===void 0&&(it[gt]=Et[gt])}if(rt||At){var yt=typeof b=="function"?b.displayName||b.name||"Unknown":b;rt&&pf(it,yt),At&&gf(it,yt)}return hf(b,rt,At,lt,Q,En.current,it)}}var Ms=m.ReactCurrentOwner,Sa=m.ReactDebugCurrentFrame;function Ke(b){if(b){var A=b._owner,V=pt(b.type,b._source,A?A.type:null);Sa.setExtraStackFrame(V)}else Sa.setExtraStackFrame(null)}var Ps;Ps=!1;function _s(b){return typeof b=="object"&&b!==null&&b.$$typeof===e}function Ea(){{if(Ms.current){var b=T(Ms.current.type);if(b)return`

Check the render method of \``+b+"`."}return""}}function mf(b){return""}var Ca={};function xf(b){{var A=Ea();if(!A){var V=typeof b=="string"?b:b.displayName||b.name;V&&(A=`

Check the top-level render call using <`+V+">.")}return A}}function Da(b,A){{if(!b._store||b._store.validated||b.key!=null)return;b._store.validated=!0;var V=xf(A);if(Ca[V])return;Ca[V]=!0;var Q="";b&&b._owner&&b._owner!==Ms.current&&(Q=" It was passed a child from "+T(b._owner.type)+"."),Ke(b),S('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',V,Q),Ke(null)}}function ba(b,A){{if(typeof b!="object")return;if(ys(b))for(var V=0;V<b.length;V++){var Q=b[V];_s(Q)&&Da(Q,A)}else if(_s(b))b._store&&(b._store.validated=!0);else if(b){var lt=v(b);if(typeof lt=="function"&&lt!==b.entries)for(var gt=lt.call(b),it;!(it=gt.next()).done;)_s(it.value)&&Da(it.value,A)}}}function Sf(b){{var A=b.type;if(A==null||typeof A=="string")return;var V;if(typeof A=="function")V=A.propTypes;else if(typeof A=="object"&&(A.$$typeof===c||A.$$typeof===f))V=A.propTypes;else return;if(V){var Q=T(A);sf(V,b.props,"prop",Q,b)}else if(A.PropTypes!==void 0&&!Ps){Ps=!0;var lt=T(A);S("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",lt||"Unknown")}typeof A.getDefaultProps=="function"&&!A.getDefaultProps.isReactClassApproved&&S("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ef(b){{for(var A=Object.keys(b.props),V=0;V<A.length;V++){var Q=A[V];if(Q!=="children"&&Q!=="key"){Ke(b),S("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Q),Ke(null);break}}b.ref!==null&&(Ke(b),S("Invalid attribute `ref` supplied to `React.Fragment`."),Ke(null))}}var ya={};function Ra(b,A,V,Q,lt,gt){{var it=P(b);if(!it){var rt="";(b===void 0||typeof b=="object"&&b!==null&&Object.keys(b).length===0)&&(rt+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var At=mf();At?rt+=At:rt+=Ea();var Et;b===null?Et="null":ys(b)?Et="array":b!==void 0&&b.$$typeof===e?(Et="<"+(T(b.type)||"Unknown")+" />",rt=" Did you accidentally export a JSX literal instead of a component?"):Et=typeof b,S("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Et,rt)}var yt=vf(b,A,V,lt,gt);if(yt==null)return yt;if(it){var Xt=A.children;if(Xt!==void 0)if(Q)if(ys(Xt)){for(var Ze=0;Ze<Xt.length;Ze++)ba(Xt[Ze],b);Object.freeze&&Object.freeze(Xt)}else S("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ba(Xt,b)}if(bt.call(A,"key")){var Te=T(b),Ft=Object.keys(A).filter(function(Mf){return Mf!=="key"}),Ts=Ft.length>0?"{key: someKey, "+Ft.join(": ..., ")+": ...}":"{key: someKey}";if(!ya[Te+Ts]){var Rf=Ft.length>0?"{"+Ft.join(": ..., ")+": ...}":"{}";S(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Ts,Te,Rf,Te),ya[Te+Ts]=!0}}return b===r?Ef(yt):Sf(yt),yt}}function Cf(b,A,V){return Ra(b,A,V,!0)}function Df(b,A,V){return Ra(b,A,V,!1)}var bf=Df,yf=Cf;un.Fragment=r,un.jsx=bf,un.jsxs=yf}()),un}process.env.NODE_ENV==="production"?Or.exports=kc():Or.exports=Fc();var ot=Or.exports;function Kt(t,e,n){const r=n.originalDatas;r.groupable=r.groupable||{};const s=r.groupable;s.childDatas=s.childDatas||[];const o=s.childDatas;return t.moveables.map((i,a)=>(o[a]=o[a]||{},o[a][e]=o[a][e]||{},{...n,isRequestChild:!0,datas:o[a][e],originalDatas:o[a]}))}function wr(t,e,n,r,s,o,i){const a=!!n.match(/Start$/g),c=!!n.match(/End$/g),l=s.isPinch,u=s.datas,f=Kt(t,e.name,s),d=t.moveables,p=[],g=f.map((h,v)=>{const m=d[v],S=m.state,x=S.gestos;let C=h;if(a)C=new Ge(i).dragStart(r,h),p.push(C);else{if(x[i]||(x[i]=u.childGestos[v]),!x[i])return;C=an(h,S,r,l,o,i),p.push(C)}const E=e[n](m,{...C,parentFlag:!0});return c&&(x[i]=null),E});return a&&(u.childGestos=d.map(h=>h.state.gestos[i])),{eventParams:g,childEvents:p}}function oe(t,e,n,r,s=(i,a)=>a,o){const i=!!n.match(/End$/g),a=Kt(t,e.name,r),c=t.moveables;return a.map((u,f)=>{const d=c[f];let p=u;p=s(d,u);const g=e[n](d,{...p,parentFlag:!0});return g&&o&&o(d,u,g,f),i&&(d.state.gestos={}),g})}function An(t,e,n,r){const s=n.fixedDirection,o=n.fixedPosition,i=r.datas.startPositions||Yt(e.state),a=Mt(i,s),[c,l]=Ot(rn(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3);return r.datas.originalX=c,r.datas.originalY=l,r}function xo(t,e,n,r){const{renderPoses:s,rotation:o,direction:i}=t.getState(),{zoom:a}=be(t.props,e),c=pn(o/Math.PI*180),l={},u=t.renderState;u.renderDirectionMap||(u.renderDirectionMap={});const f=u.renderDirectionMap;n.forEach(({dir:p})=>{l[p]=!0});const d=zt(i);return n.map(({data:p,classNames:g,dir:h})=>{const v=dr[h];if(!v||!l[h])return null;f[h]=!0;const m=(tt(c,15)+d*Vs[h]+720)%180,S={};return Be(p).forEach(x=>{S[`data-${x}`]=p[x]}),vt.createElement("div",{className:U("control","direction",h,e,...g),"data-rotation":m,"data-direction":h,...S,key:`direction-${h}`,style:Hn(o,a,...v.map(x=>s[x]))})})}function So(t,e,n,r){const{renderDirections:s=e,displayAroundControls:o}=be(t.props,n);if(!s)return[];const i=s===!0?Dn:s;return[...o?bo(t,r,n,i):[],...xo(t,n,i.map(a=>({data:{},classNames:[],dir:a})))]}function fn(t,e,n,r,s,o,...i){const a=xt(n,r),c=e?tt(a/Math.PI*180,15)%180:-1;return ot.jsx("div",{className:U("line","direction",e?"edge":"",e,...i),"data-rotation":c,"data-line-key":o,"data-direction":e,style:vn(n,r,s,a)},`line-${o}`)}function Eo(t,e,n,r,s){return(n===!0?wa:n).map((i,a)=>{const[c,l]=dr[i];if(l!=null)return fn(t,i,r[c],r[l],s,`${e}Edge${a}`,e)}).filter(Boolean)}function Co(t){return(e,n)=>{const r=be(e.props,t).edge;return r&&(r===!0||r.length)?[...Eo(n,t,r,e.getState().renderPoses,e.props.zoom),...$c(e,t,n)]:Do(e,t,n)}}function Do(t,e,n){return So(t,Dn,e,n)}function $c(t,e,n){return So(t,["nw","ne","sw","se"],e,n)}function bo(t,e,n,r){const s=t.renderState;s.renderDirectionMap||(s.renderDirectionMap={});const{renderPoses:o,rotation:i,direction:a}=t.getState(),c=s.renderDirectionMap,{zoom:l}=t.props,u=zt(a),f=i/Math.PI*180;return(r||Be(c)).map(d=>{const p=dr[d];if(!p)return null;const g=(tt(f,15)+u*Vs[d]+720)%180,h=["around-control"];return n&&h.push("direction",n),ot.jsx("div",{className:U(...h),"data-rotation":g,"data-direction":d,style:Hn(i,l,...p.map(v=>o[v]))},`direction-around-${d}`)})}function Ir(t,e,n){const{position:r="client",left:s=-1/0,top:o=-1/0,right:i=1/0,bottom:a=1/0}=t||{},c={position:r,left:s,top:o,right:i,bottom:a};return{vertical:yo(c,e,!0),horizontal:yo(c,n,!1)}}function Gn(t,e){const{containerClientRect:{clientHeight:n,clientWidth:r,clientLeft:s,clientTop:o},snapOffset:{left:i,top:a,right:c,bottom:l}}=t.state,u=e||t.props.bounds||{},d=(u.position||"client")==="css",{left:p=-1/0,top:g=-1/0}=u;let{right:h=d?-1/0:1/0,bottom:v=d?-1/0:1/0}=u;return d&&(h=r+c-i-h,v=n+l-a-v),{left:p+i-s,right:h+i-s,top:g+a-o,bottom:v+a-o}}function Lc(t,e,n){const{left:r,top:s,right:o,bottom:i}=Gn(t),[a,c]=n;let[l,u]=K(n,e);B(l)<It&&(l=0),B(u)<It&&(u=0);const f=u>0,d=l>0,p={isBound:!1,offset:0,pos:0},g={isBound:!1,offset:0,pos:0};if(l===0&&u===0)return{vertical:p,horizontal:g};if(l===0)f?i<c&&(g.pos=i,g.offset=c-i):s>c&&(g.pos=s,g.offset=c-s);else if(u===0)d?o<a&&(p.pos=o,p.offset=a-o):r>a&&(p.pos=r,p.offset=a-r);else{const h=u/l,v=n[1]-h*a;let m=0,S=0,x=!1;d&&o<=a?(m=h*o+v,S=o,x=!0):!d&&a<=r&&(m=h*r+v,S=r,x=!0),x&&(m<s||m>i)&&(x=!1),x||(f&&i<=c?(m=i,S=(m-v)/h,x=!0):!f&&c<=s&&(m=s,S=(m-v)/h,x=!0)),x&&(p.isBound=!0,p.pos=S,p.offset=a-S,g.isBound=!0,g.pos=m,g.offset=c-m)}return{vertical:p,horizontal:g}}function yo(t,e,n){const r=t[n?"left":"top"],s=t[n?"right":"bottom"],o=Math.min(...e),i=Math.max(...e),a=[];return r+1>o&&a.push({direction:"start",isBound:!0,offset:o-r,pos:r}),s-1<i&&a.push({direction:"end",isBound:!0,offset:i-s,pos:s}),a.length||a.push({isBound:!1,offset:0,pos:0}),a.sort((c,l)=>B(l.offset)-B(c.offset))}function Ro(t,e,n){return(n?t.map(s=>nn(s,n)):t).some(s=>s[0]<e.left&&B(s[0]-e.left)>.1||s[0]>e.right&&B(s[0]-e.right)>.1||s[1]<e.top&&B(s[1]-e.top)>.1||s[1]>e.bottom&&B(s[1]-e.bottom)>.1)}function Nc(t,e,n){const r=Wt(t),s=Math.sqrt(r*r-e*e)||0;return[s,-s].sort((o,i)=>B(o-t[n?0:1])-B(i-t[n?0:1])).map(o=>xt([0,0],n?[o,e]:[e,o]))}function Wc(t,e,n,r,s){if(!t.props.bounds)return[];const o=s*Math.PI/180,{left:i,top:a,right:c,bottom:l}=Gn(t),u=i-r[0],f=c-r[0],d=a-r[1],p=l-r[1],g={left:u,top:d,right:f,bottom:p};if(!Ro(n,g,0))return[];const h=[];return[[u,0],[f,0],[d,1],[p,1]].forEach(([v,m])=>{n.forEach(S=>{const x=xt([0,0],S);h.push(...Nc(S,v,m).map(C=>o+C-x).filter(C=>!Ro(e,g,C)).map(C=>tt(C*180/Math.PI,It)))})}),h}const Yc=["left","right","center"],Vc=["top","bottom","middle"],Mo={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},le={start:"left",end:"right",center:"center"},ue={start:"top",end:"bottom",center:"middle"};function Le(){return{left:!1,top:!1,right:!1,bottom:!1}}function Ne(t,e){const{props:{snappable:n,bounds:r,innerBounds:s,verticalGuidelines:o,horizontalGuidelines:i,snapGridWidth:a,snapGridHeight:c},state:{guidelines:l,enableSnap:u}}=t;return!n||!u||e&&n!==!0&&n.indexOf(e)<0?!1:!!(a||c||r||s||l&&l.length||o&&o.length||i&&i.length)}function Br(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function jc(t,e){const n=Br(t),r={};for(const s in n)s in e&&n[s]&&(r[s]=e[s]);return r}function zr(t,e){const n=jc(t,e),r=Vc.filter(o=>o in n),s=Yc.filter(o=>o in n);return{horizontalNames:r,verticalNames:s,horizontal:r.map(o=>n[o]),vertical:s.map(o=>n[o])}}function Hc(t,e,n){const r=mt(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function Xc([t,e]){let n=e[0]-t[0],r=e[1]-t[1];Math.abs(n)<Ct&&(n=0),Math.abs(r)<Ct&&(r=0);let s=0,o=0,i=0;return n?r?(s=-r/n,o=1,i=s*t[0]-t[1]):(o=1,i=-t[1]):(s=-1,i=t[0]),[s,o,i].map(a=>tt(a,Ct))}const Po="snapRotationThreshold",_o="snapRotationDegrees",To="snapHorizontalThreshold",Oo="snapVerticalThreshold";function kn(t,e,n,r=[],s=[],o,i){var f;const a=t.props,c=((f=t.state.snapThresholdInfo)==null?void 0:f.multiples)||[1,1],l=mi(i,a[To],5),u=mi(o,a[Oo],5);return wo(t.state.guidelines,e,n,r,s,l,u,c)}function wo(t,e,n,r,s,o,i,a){return{vertical:Bo(t,"vertical",e,i*a[0],r),horizontal:Bo(t,"horizontal",n,o*a[1],s)}}function qc(t,e,n){const[r,s]=n,[o,i]=e;let[a,c]=K(n,e);const l=c>0,u=a>0;a=Kn(a),c=Kn(c);const f={isSnap:!1,offset:0,pos:0},d={isSnap:!1,offset:0,pos:0};if(a===0&&c===0)return{vertical:f,horizontal:d};const{vertical:p,horizontal:g}=kn(t,a?[r]:[],c?[s]:[],[],[],void 0,void 0);p.posInfos.filter(({pos:E})=>u?E>=o:E<=o),g.posInfos.filter(({pos:E})=>l?E>=i:E<=i),p.isSnap=p.posInfos.length>0,g.isSnap=g.posInfos.length>0;const{isSnap:h,guideline:v}=Ar(p),{isSnap:m,guideline:S}=Ar(g),x=m?S.pos[1]:0,C=h?v.pos[0]:0;if(a===0)m&&(d.isSnap=!0,d.pos=S.pos[1],d.offset=s-d.pos);else if(c===0)h&&(f.isSnap=!0,f.pos=C,f.offset=r-C);else{const E=c/a,D=n[1]-E*r;let R=0,y=0,M=!1;h?(y=C,R=E*y+D,M=!0):m&&(R=x,y=(R-D)/E,M=!0),M&&(f.isSnap=!0,f.pos=y,f.offset=r-y,d.isSnap=!0,d.pos=R,d.offset=s-R)}return{vertical:f,horizontal:d}}function fe(t){let e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function Io(t,e,n,r){const s=zr(t.props.snapDirections,e),o=kn(t,s.vertical,s.horizontal,s.verticalNames.map(c=>fe(c)),s.horizontalNames.map(c=>fe(c)),n,r),i=fe(s.horizontalNames[o.horizontal.index]),a=fe(s.verticalNames[o.vertical.index]);return{vertical:{...o.vertical,direction:a},horizontal:{...o.horizontal,direction:i}}}function Ar(t){const e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};const n=t.posInfos[0],r=n.guidelineInfos[0],s=r.offset,o=r.dist,i=r.guideline;return{isSnap:e,offset:s,dist:o,pos:n.pos,guideline:i}}function Bo(t,e,n,r,s=[]){var l;if(!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};const i=e==="vertical"?0:1,a=n.map((u,f)=>{const d=s[f]||"",p=t.map(g=>{const{pos:h}=g,v=u-h[i];return{offset:v,dist:B(v),guideline:g,direction:d}}).filter(({guideline:g,dist:h})=>{const{type:v}=g;return!(v!==e||h>r)}).sort((g,h)=>g.dist-h.dist);return{pos:u,index:f,guidelineInfos:p,direction:d}}).filter(u=>u.guidelineInfos.length>0).sort((u,f)=>u.guidelineInfos[0].dist-f.guidelineInfos[0].dist),c=a.length>0;return{isSnap:c,index:c?a[0].index:-1,direction:((l=a[0])==null?void 0:l.direction)??"",posInfos:a}}function Uc(t,e,n,r,s){let o=[];n[0]&&n[1]?o=[n,[-n[0],n[1]],[n[0],-n[1]]]:!n[0]&&!n[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach((d,p,g)=>{const h=g[p+1]||g[0];o.push(d),o.push([(d[0]+h[0])/2,(d[1]+h[1])/2])}):t.props.keepRatio?o.push([-1,-1],[-1,1],[1,-1],[1,1],n):(o.push(...Dc([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),o.length>1&&o.push([(o[0][0]+o[1][0])/2,(o[0][1]+o[1][1])/2]));const i=o.map(d=>Mt(e,d)),a=i.map(d=>d[0]),c=i.map(d=>d[1]),l=kn(t,a,c,o.map(d=>fe(d[0])),o.map(d=>fe(d[1])),r,s),u=fe(o.map(d=>d[0])[l.vertical.index]),f=fe(o.map(d=>d[1])[l.horizontal.index]);return{vertical:{...l.vertical,direction:u},horizontal:{...l.horizontal,direction:f}}}function zo(t,e){const n=B(t.offset),r=B(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<It?1:r<It?-1:n-r}function Fn(t,e){return t.slice().sort((n,r)=>{const s=n.sign[e],o=r.sign[e],i=n.offset[e],a=r.offset[e];if(s){if(!o)return-1}else return 1;return zo({isBound:n.isBound,isSnap:n.isSnap,offset:i},{isBound:r.isBound,isSnap:r.isSnap,offset:a})})[0]}function Kc(t,e,n){const r=[];if(n)B(e[0])!==1||B(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){const s=t[0]?t:[1,1];[1,-1].forEach(o=>{[1,-1].forEach(i=>{const a=[o*s[0],i*s[1]];e[0]===a[0]&&e[1]===a[1]||r.push([e,a])})})}else t[0]?(B(e[0])===1?[1]:[1,-1]).forEach(o=>{r.push([[e[0],-1],[o*t[0],-1]],[[e[0],0],[o*t[0],0]],[[e[0],1],[o*t[0],1]])}):t[1]&&(B(e[1])===1?[1]:[1,-1]).forEach(o=>{r.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])});return r}function Ao(t,e){const n=Sr([e[0][0],e[1][0]]),r=Sr([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function Gr(t,[e,n]){let r=n[0]-e[0],s=n[1]-e[1];B(r)<It&&(r=0),B(s)<It&&(s=0);let o,i;return r?s?(o=s/r*(t[0]-e[0])+e[1],i=t[1]):(o=e[1],i=t[1]):(o=e[0],i=t[0]),o-i}function Go(t,e,n,r=It){return t.every(s=>{const o=Gr(s,e);return o<=0===n||B(o)<=r})}function ko(t,e,n,r,s=0){return r&&e-s<=t||!r&&t<=n+s?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function Zc(t,{line:e,centerSign:n,verticalSign:r,horizontalSign:s,lineConstants:o}){const i=t.props.innerBounds;if(!i)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};const{left:a,top:c,width:l,height:u}=i,f=[[a,c],[a,c+u]],d=[[a,c],[a+l,c]],p=[[a+l,c],[a+l,c+u]],g=[[a,c+u],[a+l,c+u]];if(Go([[a,c],[a+l,c],[a,c+u],[a+l,c+u]],e,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};const h=de(e,o,d,r),v=de(e,o,g,r),m=de(e,o,f,s),S=de(e,o,p,s),x=h.isBound&&v.isBound,C=h.isBound||v.isBound,E=m.isBound&&S.isBound,D=m.isBound||S.isBound,R=Ye(h.offset,v.offset),y=Ye(m.offset,S.offset);let M=[0,0],P=!1,_=!1;return B(y)<B(R)?(M=[R,0],P=C,_=x):(M=[0,y],P=D,_=E),{isAllBound:_,isVerticalBound:C,isHorizontalBound:D,isBound:P,offset:M}}function de(t,[e,n],r,s,o,i){const a=t[0],c=r[0],l=r[1],u=Kn(l[1]-c[1]),f=Kn(l[0]-c[0]),d=n,p=e,g=-e/n;if(f){if(!u){if(i&&!d)return{isBound:!1,offset:0};if(p){const h=(c[1]-a[1])/g+a[0];return ko(h,c[0],l[0],s,o)}else{const h=c[1]-a[1],v=B(h)<=(o||0);return{isBound:v,offset:v?h:0}}}}else{if(i&&!p)return{isBound:!1,offset:0};if(d){const h=g*(c[0]-a[0])+a[1];return ko(h,c[1],l[1],s,o)}else{const h=c[0]-a[0],v=B(h)<=(o||0);return{isBound:v,offset:v?h:0}}}return{isBound:!1,offset:0}}function Fo(t,e,n){return e.map(r=>{const{isBound:s,offset:o,isVerticalBound:i,isHorizontalBound:a}=Zc(t,r),c=r.multiple,l=Qt({datas:n,distX:o[0],distY:o[1]}).map((u,f)=>u*(c[f]?2/c[f]:0));return{sign:c,isBound:s,isVerticalBound:i,isHorizontalBound:a,isSnap:!1,offset:l}})}function Jc(t,e,n){const r=kr(t,e,[0,0],!1).map(f=>({...f,multiple:f.multiple.map(d=>B(d)*2)})),s=Fo(t,r,n),o=Fn(s,0),i=Fn(s,1);let a=0,c=0;const l=o.isVerticalBound||i.isVerticalBound,u=o.isHorizontalBound||i.isHorizontalBound;return(l||u)&&([a,c]=Ec({datas:n,distX:-o.offset[0],distY:-i.offset[1]})),{vertical:{isBound:l,offset:a},horizontal:{isBound:u,offset:c}}}function Qc(t,e){const n=[],r=t[0],s=t[1];return r&&s?n.push([[0,s*2],t,[-r,s]],[[r*2,0],t,[r,-s]]):r?(n.push([[r*2,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):s?(n.push([[0,s*2],[1,s],[-1,s]]),e&&n.push([[-1,0],[-1,s],[-1,-s]],[[1,0],[1,s],[1,-s]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function kr(t,e,n,r){const{allMatrix:s,is3d:o}=t.state,i=De(s,100,100,o?4:3),a=Mt(i,[0,0]);return Qc(n,r).map(([c,l,u])=>{const f=[Mt(i,l),Mt(i,u)],d=Xc(f),{vertical:p,horizontal:g}=Ao(a,f),h=Gr(a,f)<=0;return{multiple:c,centerSign:h,verticalSign:p,horizontalSign:g,lineConstants:d,line:[Mt(e,l),Mt(e,u)]}})}function $o(t,e,n,r){const s=r?t.map(o=>nn(o,r)):t;return[[s[0],s[1]],[s[1],s[3]],[s[3],s[2]],[s[2],s[0]]].some(o=>{const i=Gr(n,o)<=0;return!Go(e,o,i)})}function tl([t,e]){const n=e[0]-t[0],r=e[1]-t[1];if(!n)return B(t[0]);if(!r)return B(t[1]);const s=r/n;return B((-s*t[0]+t[1])/Math.sqrt(Math.pow(s,2)+1))}function el([t,e]){const n=e[0]-t[0],r=e[1]-t[1];if(!n)return[t[0],0];if(!r)return[0,t[1]];const s=r/n,o=-s*t[0]+t[1];return[-o/(s+1/s),o/(s*s+1)]}function nl(t,e,n,r,s){const o=t.props.innerBounds,i=s*Math.PI/180;if(!o)return[];const{left:a,top:c,width:l,height:u}=o,f=a-r[0],d=a+l-r[0],p=c-r[1],g=c+u-r[1],h=[[f,p],[d,p],[f,g],[d,g]],v=Mt(n,[0,0]);if(!$o(n,h,v,0))return[];const m=[],S=h.map(x=>[Wt(x),xt([0,0],x)]);return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(x=>{const C=xt([0,0],el(x)),E=tl(x);m.push(...S.filter(([D])=>D&&E<=D).map(([D,R])=>{const y=Math.acos(D?E/D:0),M=R+y,P=R-y;return[i+M-C,i+P-C]}).reduce((D,R)=>(D.push(...R),D),[]).filter(D=>!$o(e,h,v,D)).map(D=>tt(D*180/Math.PI,It)))}),m}function rl(t){const e=t.props.innerBounds,n=Le();if(!e)return{boundMap:n,vertical:[],horizontal:[]};const{pos1:r,pos2:s,pos3:o,pos4:i}=t.getRect(),a=[r,s,o,i],c=Mt(a,[0,0]),{left:l,top:u,width:f,height:d}=e,p=[[l,u],[l,u+d]],g=[[l,u],[l+f,u]],h=[[l+f,u],[l+f,u+d]],v=[[l,u+d],[l+f,u+d]],m=kr(t,a,[0,0],!1),S=[],x=[];return m.forEach(C=>{const{line:E,lineConstants:D}=C,{horizontal:R,vertical:y}=Ao(c,E),M=de(E,D,g,y,1,!0),P=de(E,D,v,y,1,!0),_=de(E,D,p,R,1,!0),O=de(E,D,h,R,1,!0);M.isBound&&!n.top&&(S.push(u),n.top=!0),P.isBound&&!n.bottom&&(S.push(u+d),n.bottom=!0),_.isBound&&!n.left&&(x.push(l),n.left=!0),O.isBound&&!n.right&&(x.push(l+f),n.right=!0)}),{boundMap:n,horizontal:S,vertical:x}}function sl(t,e,n,r){let s=e[0]-t[0],o=e[1]-t[1];if(B(s)<Ct&&(s=0),B(o)<Ct&&(o=0),!s)return r?[0,0]:[0,n];if(!o)return r?[n,0]:[0,0];const i=o/s,a=t[1]-i*t[0];if(r){const c=i*(e[0]+n)+a;return[n,c-e[1]]}else return[(e[1]+n-a)/i-e[0],n]}function Fr(t,e,n,r,s){const o=sl(t,e,n,r);if(!o)return{isOutside:!1,offset:[0,0]};const i=se(t,e),a=se(o,t),c=se(o,e),l=a>i||c>i,[u,f]=Qt({datas:s,distX:o[0],distY:o[1]});return{offset:[u,f],isOutside:l}}function $n(t,e){return t.isBound?t.offset:e.isSnap?Ar(e).offset:0}function ol(t,[e,n],[r,s],[o,i],[a,c]){let l=-a,u=-c;if(t&&e&&n){l=0,u=0;const f=[];if(r&&s?f.push([0,c],[a,0]):r?f.push([a,0]):s?f.push([0,c]):o&&i?f.push([0,c],[a,0]):o?f.push([a,0]):i&&f.push([0,c]),f.length){f.sort((p,g)=>Wt(K([e,n],p))-Wt(K([e,n],g)));const d=f[0];if(d[0]&&B(e)>Ct)l=-d[0],u=n*B(e+l)/B(e)-n;else if(d[1]&&B(n)>Ct){const p=n;u=-d[1],l=e*B(n+u)/B(p)-e}if(t&&s&&r)if(B(l)>Ct&&B(l)<B(a)){const p=B(a)/B(l);l*=p,u*=p}else if(B(u)>Ct&&B(u)<B(c)){const p=B(c)/B(u);l*=p,u*=p}else l=Ye(-a,l),u=Ye(-c,u)}}else l=e||r?-a:0,u=n||s?-c:0;return[l,u]}function il(t,e,n,r,s,o){if(!Ne(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];const i=Zr(o.absolutePoses,[e,n]),{left:a,right:c,top:l,bottom:u}=Nt(i),f={horizontal:i.map(P=>P[1]),vertical:i.map(P=>P[0])},d=Br(t.props.snapDirections),p=zr(d,{left:a,right:c,top:l,bottom:u,center:(a+c)/2,middle:(l+u)/2}),{vertical:g,horizontal:h}=Ln(t,s,p,f),{vertical:v,horizontal:m}=Jc(t,i,o),S=g.isSnap,x=h.isSnap,C=g.isBound||v.isBound,E=h.isBound||m.isBound,D=Ye(g.offset,v.offset),R=Ye(h.offset,m.offset),[y,M]=ol(r,[e,n],[C,E],[S,x],[D,R]);return[{isBound:C,isSnap:S,offset:y},{isBound:E,isSnap:x,offset:M}]}function Ln(t,e,n,r=n){const{horizontal:s,vertical:o}=Ir(Gn(t),r.vertical,r.horizontal),{horizontal:i,vertical:a}=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:kn(t,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),c=$n(s[0],i),l=$n(o[0],a),u=B(c),f=B(l);return{horizontal:{isBound:s[0].isBound,isSnap:i.isSnap,snapIndex:i.index,offset:c,dist:u,bounds:s,snap:i},vertical:{isBound:o[0].isBound,isSnap:a.isSnap,snapIndex:a.index,offset:l,dist:f,bounds:o,snap:a}}}function Lo(t,e,n,r,s,o,i=[1,1]){const{horizontal:a,vertical:c}=Ir(e,n,r),{horizontal:l,vertical:u}=wo(t,n,r,[],[],s,o,i),f=$n(a[0],l),d=$n(c[0],u),p=B(f),g=B(d);return{horizontal:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:f,dist:p,bounds:a,snap:l},vertical:{isBound:c[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:g,bounds:c,snap:u}}}function al(t,e,n,r){const s=xt(t,e)/Math.PI*180,{vertical:{isBound:o,isSnap:i,dist:a},horizontal:{isBound:c,isSnap:l,dist:u}}=n,f=s%180,d=f<3||f>177,p=f>87&&f<93;return u<a&&(o||i&&!p&&(!r||!d))?"vertical":c||l&&!d&&(!r||!p)?"horizontal":""}function cl(t,e,n,r,s,o){return n.map(([i,a])=>{const c=Mt(e,i),l=Mt(e,a),u=r?ll(t,c,l,s):Ln(t,s,{vertical:[l[0]],horizontal:[l[1]]}),{horizontal:{offset:f,isBound:d,isSnap:p},vertical:{offset:g,isBound:h,isSnap:v}}=u,m=K(a,i);if(!g&&!f)return{isBound:h||d,isSnap:v||p,sign:m,offset:[0,0]};const S=al(c,l,u,r);if(!S)return{sign:m,isBound:!1,isSnap:!1,offset:[0,0]};const x=S==="vertical";let C=[0,0];return!r&&B(a[0])===1&&B(a[1])===1&&i[0]!==a[0]&&i[1]!==a[1]?C=Qt({datas:o,distX:-g,distY:-f}):C=Fr(c,l,-(x?g:f),x,o).offset,C=C.map((E,D)=>E*(m[D]?2/m[D]:0)),{sign:m,isBound:x?h:d,isSnap:x?v:p,offset:C}})}function No(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function ll(t,e,n,r){const{horizontal:s,vertical:o}=Lc(t,e,n),{horizontal:i,vertical:a}=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:qc(t,e,n),c=No(s,i),l=No(o,a),u=B(c),f=B(l);return{horizontal:{isBound:s.isBound,isSnap:i.isSnap,offset:c,dist:u},vertical:{isBound:o.isBound,isSnap:a.isSnap,offset:l,dist:f}}}function ul(t,e,n,r,s){const o=[-n[0],-n[1]],{width:i,height:a}=t.state,c=t.props.bounds;let l=1/0,u=1/0;if(c){const f=[[n[0],-n[1]],[-n[0],n[1]]],{left:d=-1/0,top:p=-1/0,right:g=1/0,bottom:h=1/0}=c;f.forEach(v=>{const m=v[0]!==o[0],S=v[1]!==o[1],x=Mt(e,v),C=xt(r,x)*360/Math.PI;if(S){const E=x.slice();(B(C-360)<2||B(C-180)<2)&&(E[1]=r[1]);const{offset:[,D],isOutside:R}=Fr(r,E,(r[1]<x[1]?h:p)-x[1],!1,s);isNaN(D)||(u=a+(R?1:-1)*B(D))}if(m){const E=x.slice();(B(C-90)<2||B(C-270)<2)&&(E[0]=r[0]);const{offset:[D],isOutside:R}=Fr(r,E,(r[0]<x[0]?g:d)-x[0],!0,s);isNaN(D)||(l=i+(R?1:-1)*B(D))}})}return{maxWidth:l,maxHeight:u}}const wt={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle(){return["left","top","right","bottom"]},requestChildStyle(){return["left","top","right","bottom"]},render(t,e){const{hideThrottleDragRotateLine:n,throttleDragRotate:r,zoom:s}=t.props,{dragInfo:o,beforeOrigin:i}=t.getState();if(n||!r||!o)return[];const a=o.dist;if(!a[0]&&!a[1])return[];const c=Wt(a),l=xt(a,[0,0]);return[ot.jsx("div",{className:U("line","horizontal","dragline","dashed"),style:{width:`${c}px`,transform:`translate(${i[0]}px, ${i[1]}px) rotate(${l}rad) scaleY(${s})`}},"dragRotateGuideline")]},dragStart(t,e){const{datas:n,parentEvent:r,parentGesto:s}=e,o=t.state,{gestos:i,style:a}=o;if(i.draggable)return!1;i.draggable=s||t.targetGesto,n.datas={},n.left=parseFloat(a.left||"")||0,n.top=parseFloat(a.top||"")||0,n.bottom=parseFloat(a.bottom||"")||0,n.right=parseFloat(a.right||"")||0,n.startValue=[0,0],Se(t,e),wn(t,e,"translate"),Gl(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];const c=et(t,e,{set:u=>{n.startValue=u},...On(t,e)});return(r||j(t,"onDragStart",c))!==!1?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(i.draggable=null,n.isPinch=!1),n.isDrag?c:!1},drag(t,e){if(!e)return;_n(t,e,"translate");const{datas:n,parentEvent:r,parentFlag:s,isPinch:o,deltaOffset:i,useSnap:a,isRequest:c,isGroup:l,parentThrottleDrag:u}=e;let{distX:f,distY:d}=e;const{isDrag:p,prevDist:g,prevBeforeDist:h,startValue:v}=n;if(!p)return;i&&(f+=i[0],d+=i[1]);const m=t.props,S=m.parentMoveable,x=l?0:m.throttleDrag||u||0,C=r?0:m.throttleDragRotate||0;let E=0,D=!1,R=!1,y=!1,M=!1;if(!r&&C>0&&(f||d)){const W=m.startDragRotate||0,J=tt(W+xt([0,0],[f,d])*180/Math.PI,C)-W,q=d*Math.abs(Math.cos((J-90)/180*Math.PI)),$=f*Math.abs(Math.cos(J/180*Math.PI)),X=Wt([$,q]);E=J*Math.PI/180,f=X*Math.cos(E),d=X*Math.sin(E)}if(!o&&!r&&!s){const[W,J]=il(t,f,d,C,!a&&c||i,n);D=W.isSnap,R=W.isBound,y=J.isSnap,M=J.isBound;const q=W.offset,$=J.offset;f+=q,d+=$}const P=ct(uo({datas:n,distX:f,distY:d}),v),_=ct(Sc({datas:n,distX:f,distY:d}),v);Qs(_,It),Qs(P,It),C||(!D&&!R&&(_[0]=tt(_[0],x),P[0]=tt(P[0],x)),!y&&!M&&(_[1]=tt(_[1],x),P[1]=tt(P[1],x)));const O=K(P,v),T=K(_,v),w=K(T,g),k=K(O,h);n.prevDist=T,n.prevBeforeDist=O,n.passDelta=w,n.passDist=T;const I=n.left+O[0],F=n.top+O[1],G=n.right-O[0],L=n.bottom-O[1],z=Tn(n,`translate(${_[0]}px, ${_[1]}px)`,`translate(${T[0]}px, ${T[1]}px)`);if(_r(e,z),t.state.dragInfo.dist=r?[0,0]:T,!r&&!S&&w.every(W=>!W)&&k.some(W=>!W))return;const{width:N,height:Z}=t.state,Y=et(t,e,{transform:z,dist:T,delta:w,translate:_,beforeDist:O,beforeDelta:k,beforeTranslate:P,left:I,top:F,right:G,bottom:L,width:N,height:Z,isPinch:o,...Bt({transform:z},e)});return!r&&j(t,"onDrag",Y),Y},dragAfter(t,e){const n=e.datas,{deltaOffset:r}=n;return r[0]||r[1]?(n.deltaOffset=[0,0],this.drag(t,{...e,deltaOffset:r})):!1},dragEnd(t,e){const{parentEvent:n,datas:r}=e;if(t.state.dragInfo=null,!r.isDrag)return;r.isDrag=!1;const s=Lt(t,e,{});return!n&&j(t,"onDragEnd",s),s},dragGroupStart(t,e){var f;const{datas:n,clientX:r,clientY:s}=e,o=this.dragStart(t,e);if(!o)return!1;const{childEvents:i,eventParams:a}=wr(t,this,"dragStart",[r||0,s||0],e,!1,"draggable"),c={...o,targets:t.props.targets,events:a},l=j(t,"onDragGroupStart",c);n.isDrag=l!==!1;const u=((f=i[0])==null?void 0:f.datas.startValue)??[0,0];return n.throttleOffset=[u[0]%1,u[1]%1],n.isDrag?o:!1},dragGroup(t,e){const{datas:n}=e;if(!n.isDrag)return;const r=this.drag(t,{...e,parentThrottleDrag:t.props.throttleDrag}),{passDelta:s}=e.datas,{eventParams:o}=wr(t,this,"drag",s,e,!1,"draggable");if(!r)return;const i={targets:t.props.targets,events:o,...r};return j(t,"onDragGroup",i),i},dragGroupEnd(t,e){const{isDrag:n,datas:r}=e;if(!r.isDrag)return;this.dragEnd(t,e);const{eventParams:s}=wr(t,this,"dragEnd",[0,0],e,!1,"draggable");return j(t,"onDragGroupEnd",Lt(t,e,{targets:t.props.targets,events:s})),n},request(t){const e={},n=t.getRect();let r=0,s=0,o=!1;return{isControl:!1,requestStart(i){return o=i.useSnap,{datas:e,useSnap:o}},request(i){return"x"in i?r=i.x-n.left:"deltaX"in i&&(r+=i.deltaX),"y"in i?s=i.y-n.top:"deltaY"in i&&(s+=i.deltaY),{datas:e,distX:r,distY:s,useSnap:o}},requestEnd(){return{datas:e,isDrag:!0,useSnap:o}}}},unset(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function Wo(t,e){return{fixedPosition:Mt(t,e),fixedDirection:e,fixedOffset:[0,0]}}function fl(t,e){const{allMatrix:n,is3d:r,width:s,height:o}=t,i=r?4:3,a=[s/2*(1+e[0]),o/2*(1+e[1])];return{fixedPosition:mt(n,a,i),fixedDirection:e,fixedOffset:[0,0]}}function Yo(t,e){const{allMatrix:n,is3d:r,width:s,height:o}=t,i=r?4:3,a=Pc(e,s,o),c=mt(n,e,i),l=[s?0:e[0],o?0:e[1]];return{fixedPosition:c,fixedDirection:a,fixedOffset:l}}const Vo=ns("resizable"),Nn={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Co("resizable"),dragControlCondition:Vo,viewClassName:es("resizable"),dragControlStart(t,e){const{inputEvent:n,isPinch:r,isGroup:s,parentDirection:o,parentGesto:i,datas:a,parentFixedDirection:c,parentEvent:l}=e,u=gi(o,r,n,a),f=t.state,{target:d,width:p,height:g,gestos:h}=f;if(!u||!d||h.resizable)return!1;h.resizable=i||t.controlGesto,!r&&Se(t,e),a.datas={},a.direction=u,a.startOffsetWidth=p,a.startOffsetHeight=g,a.prevWidth=0,a.prevHeight=0,a.minSize=[0,0],a.startWidth=f.inlineCSSWidth||f.cssWidth,a.startHeight=f.inlineCSSHeight||f.cssHeight,a.maxSize=[1/0,1/0],s||(a.minSize=[f.minOffsetWidth,f.minOffsetHeight],a.maxSize=[f.maxOffsetWidth,f.maxOffsetHeight]);const v=t.props.transformOrigin||"% %";a.transformOrigin=v&&ne(v)?v.split(" "):v,a.startOffsetMatrix=f.offsetMatrix,a.startTransformOrigin=f.transformOrigin,a.isWidth=(e==null?void 0:e.parentIsWidth)??(!u[0]&&!u[1]||u[0]||!u[1]);function m(y){a.ratio=y&&isFinite(y)?y:0}a.startPositions=Yt(t.state);function S(y){const M=Wo(a.startPositions,y);a.fixedDirection=M.fixedDirection,a.fixedPosition=M.fixedPosition,a.fixedOffset=M.fixedOffset}function x(y){const M=Yo(t.state,y);a.fixedDirection=M.fixedDirection,a.fixedPosition=M.fixedPosition,a.fixedOffset=M.fixedOffset}function C(y){a.minSize=[ut(`${y[0]}`,0)||0,ut(`${y[1]}`,0)||0]}function E(y){const M=[y[0]||1/0,y[1]||1/0];(!Qe(M[0])||isFinite(M[0]))&&(M[0]=ut(`${M[0]}`,0)||1/0),(!Qe(M[1])||isFinite(M[1]))&&(M[1]=ut(`${M[1]}`,0)||1/0),a.maxSize=M}m(p/g),S(c||[-u[0],-u[1]]),a.setFixedDirection=S,a.setFixedPosition=x,a.setMin=C,a.setMax=E;const D=et(t,e,{direction:u,startRatio:a.ratio,set:([y,M])=>{a.startWidth=y,a.startHeight=M},setMin:C,setMax:E,setRatio:m,setFixedDirection:S,setFixedPosition:x,setOrigin:y=>{a.transformOrigin=y},dragStart:wt.dragStart(t,new Ge().dragStart([0,0],e))}),R=l||j(t,"onResizeStart",D);return a.startFixedDirection=a.fixedDirection,a.startFixedPosition=a.fixedPosition,R!==!1&&(a.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:u}),a.isResize?D:!1},dragControl(t,e){const{datas:n,parentFlag:r,isPinch:s,parentKeepRatio:o,dragClient:i,parentDist:a,useSnap:c,isRequest:l,isGroup:u,parentEvent:f,resolveMatrix:d}=e,{isResize:p,transformOrigin:g,startWidth:h,startHeight:v,prevWidth:m,prevHeight:S,minSize:x,maxSize:C,ratio:E,startOffsetWidth:D,startOffsetHeight:R,isWidth:y}=n;if(!p)return;if(d){const{is3d:st}=t.state,{startOffsetMatrix:jt,startTransformOrigin:Ht}=n,pt=st?4:3;let bt=on(In(e));const ee=Math.sqrt(bt.length);pt!==ee&&(bt=Ut(bt,ee,pt));const _e=cn(jt,bt,Ht,pt),Ue=De(_e,D,R,pt);n.startPositions=Ue,n.nextTargetMatrix=bt,n.nextAllMatrix=_e}const M=be(t.props,"resizable"),{resizeFormat:P,throttleResize:_=r?0:1,parentMoveable:O,keepRatioFinally:T}=M,w=n.direction;let k=w,I=0,F=0;!w[0]&&!w[1]&&(k=[1,1]);const G=E&&(o??M.keepRatio)||!1;function L(){const st=n.fixedDirection,jt=Di(k,G,n,e);I=jt.distWidth,F=jt.distHeight;let Ht=k[0]-st[0]||G?Math.max(D+I,It):D,pt=k[1]-st[1]||G?Math.max(R+F,It):R;return G&&D&&R&&(y?pt=Ht/E:Ht=pt*E),[Ht,pt]}let[z,N]=L();f||(n.setFixedDirection(n.fixedDirection),j(t,"onBeforeResize",et(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection(st){return n.setFixedDirection(st),[z,N]=L(),[z,N]},setFixedPosition(st){return n.setFixedPosition(st),[z,N]=L(),[z,N]},boundingWidth:z,boundingHeight:N,setSize(st){[z,N]=st}},!0)));let Z=i;i||(!r&&s?Z=wc(t,[0,0]):Z=n.fixedPosition);let Y=[0,0];s||(Y=zl(t,z,N,w,Z,!c&&l,n)),a&&(!a[0]&&(Y[0]=0),!a[1]&&(Y[1]=0));function W(){P&&([z,N]=P([z,N])),z=tt(z,_),N=tt(N,_)}if(G){k[0]&&k[1]&&Y[0]&&Y[1]&&(B(Y[0])>B(Y[1])?Y[1]=0:Y[0]=0);const st=!Y[0]&&!Y[1];st&&W(),k[0]&&!k[1]||Y[0]&&!Y[1]||st&&y?(z+=Y[0],N=z/E):(!k[0]&&k[1]||!Y[0]&&Y[1]||st&&!y)&&(N+=Y[1],z=N*E)}else z+=Y[0],N+=Y[1],z=Math.max(0,z),N=Math.max(0,N);[z,N]=Zs([z,N],x,C,G?E:!1),W(),G&&(u||T)&&(y?N=z/E:z=N*E),I=z-D,F=N-R;const J=[I-m,F-S];n.prevWidth=I,n.prevHeight=F;const q=Oc(t,z,N,Z,g,n);if(!O&&J.every(st=>!st)&&q.every(st=>!st))return;const $=wt.drag(t,an(e,t.state,q,!!s,!1,"draggable")),X=$.transform,nt=h+I,dt=v+F,St=et(t,e,{width:nt,height:dt,offsetWidth:Math.round(z),offsetHeight:Math.round(N),startRatio:E,boundingWidth:z,boundingHeight:N,direction:w,dist:[I,F],delta:J,isPinch:!!s,drag:$,...vi({style:{width:`${nt}px`,height:`${dt}px`},transform:X},$,e)});return!f&&j(t,"onResize",St),St},dragControlAfter(t,e){const n=e.datas,{isResize:r,startOffsetWidth:s,startOffsetHeight:o,prevWidth:i,prevHeight:a}=n;if(!r||t.props.checkResizableError===!1)return;const{width:c,height:l}=t.state,u=c-(s+i),f=l-(o+a),d=B(u)>3,p=B(f)>3;if(d&&(n.startWidth+=u,n.startOffsetWidth+=u,n.prevWidth+=u),p&&(n.startHeight+=f,n.startOffsetHeight+=f,n.prevHeight+=f),d||p)return this.dragControl(t,e)},dragControlEnd(t,e){const{datas:n,parentEvent:r}=e;if(!n.isResize)return;n.isResize=!1;const s=Lt(t,e,{});return!r&&j(t,"onResizeEnd",s),s},dragGroupControlCondition:Vo,dragGroupControlStart(t,e){const{datas:n}=e,r=this.dragControlStart(t,{...e,isGroup:!0});if(!r)return!1;const s=Kt(t,"resizable",e),{startOffsetWidth:o,startOffsetHeight:i}=n;function a(){const p=n.minSize;s.forEach(g=>{const{minSize:h,startOffsetWidth:v,startOffsetHeight:m}=g.datas,S=o*(v?h[0]/v:0),x=i*(m?h[1]/m:0);p[0]=Math.max(p[0],S),p[1]=Math.max(p[1],x)})}function c(){const p=n.maxSize;s.forEach(g=>{const{maxSize:h,startOffsetWidth:v,startOffsetHeight:m}=g.datas,S=o*(v?h[0]/v:0),x=i*(m?h[1]/m:0);p[0]=Math.min(p[0],S),p[1]=Math.min(p[1],x)})}const l=oe(t,this,"dragControlStart",e,(p,g)=>An(t,p,n,g));a(),c();const u=p=>{r.setFixedDirection(p),l.forEach((g,h)=>{g.setFixedDirection(p),An(t,g.moveable,n,s[h])})};n.setFixedDirection=u;const f={...r,targets:t.props.targets,events:l.map(p=>({...p,setMin:g=>{p.setMin(g),a()},setMax:g=>{p.setMax(g),c()}})),setFixedDirection:u,setMin:p=>{r.setMin(p),a()},setMax:p=>{r.setMax(p),c()}},d=j(t,"onResizeGroupStart",f);return n.isResize=d!==!1,n.isResize?r:!1},dragGroupControl(t,e){const{datas:n}=e;if(!n.isResize)return;const r=be(t.props,"resizable");qn(t,"onBeforeResize",p=>{j(t,"onBeforeResizeGroup",et(t,e,{...p,targets:r.targets},!0))});const s=this.dragControl(t,{...e,isGroup:!0});if(!s)return;const{boundingWidth:o,boundingHeight:i,dist:a}=s,c=r.keepRatio,l=[o/(o-a[0]),i/(i-a[1])],u=n.fixedPosition,f=oe(t,this,"dragControl",e,(p,g)=>{const[h,v]=Ot(rn(t.rotation/180*Math.PI,3),[g.datas.originalX*l[0],g.datas.originalY*l[1],1],3);return{...g,parentDist:null,parentScale:l,dragClient:ct(u,[h,v]),parentKeepRatio:c}}),d={targets:r.targets,events:f,...s};return j(t,"onResizeGroup",d),d},dragGroupControlEnd(t,e){const{isDrag:n,datas:r}=e;if(!r.isResize)return;this.dragControlEnd(t,e);const s=oe(t,this,"dragControlEnd",e),o=Lt(t,e,{targets:t.props.targets,events:s});return j(t,"onResizeGroupEnd",o),n},request(t){const e={};let n=0,r=0,s=!1;const o=t.getRect();return{isControl:!0,requestStart(i){return s=i.useSnap,{datas:e,parentDirection:i.direction||[1,1],parentIsWidth:(i==null?void 0:i.horizontal)??!0,useSnap:s}},request(i){return"offsetWidth"in i?n=i.offsetWidth-o.offsetWidth:"deltaWidth"in i&&(n+=i.deltaWidth),"offsetHeight"in i?r=i.offsetHeight-o.offsetHeight:"deltaHeight"in i&&(r+=i.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:i.keepRatio,useSnap:s}},requestEnd(){return{datas:e,isDrag:!0,useSnap:s}}}},unset(t){t.state.gestos.resizable=null}};function $r(t,e,n,r,s){const o=t.props.groupable,i=t.state,a=i.is3d?4:3,c=e.origin,l=mt(t.state.rootMatrix,K([c[0],c[1]],o?[0,0]:[i.left,i.top]),a),u=ct([s.left,s.top],l);e.startAbsoluteOrigin=u,e.prevDeg=xt(u,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=se(u,[n,r])}function Wn(t,e,n){const{defaultDeg:r,prevDeg:s}=n;let o=s%360,i=Math.floor(s/360);o<0&&(o+=360),o>t&&o>270&&t<90?++i:o<t&&o<90&&t>270&&--i;const a=e*(i*360+t-r);return n.prevDeg=r+a,a}function Lr(t,e,n,r){return Wn(xt(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function Nr(t,e,n,r,s,o){const{throttleRotate:i=0}=t.props,a=n.prevSnapDeg;let c=0,l=!1;if(o){const f=Bl(t,e,r,s+r);l=f.isSnap,c=s+f.dist}l||(c=tt(s+r,i));const u=c-s;return n.prevSnapDeg=u,[u-a,u,c]}function jo(t,[e,n,r,s],o){if(t==="none")return[];if(Pt(t))return t.map(f=>jo(f,[e,n,r,s],o)[0]);const[i,a]=(t||"top").split("-");let c=[e,n];i==="left"?c=[r,e]:i==="right"?c=[n,s]:i==="bottom"&&(c=[s,r]);let l=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2];const u=di(c,o);if(a){const f=a==="top"||a==="left",d=i==="bottom"||i==="left";l=c[f&&!d||!f&&d?0:1]}return[[l,u]]}function Wr(t,e){if(e.isRequest)return e.requestAble==="rotatable";const n=e.inputEvent.target;if(Rt(n,U("rotation-control"))||t.props.rotateAroundControls&&Rt(n,U("around-control"))||Rt(n,U("control"))&&Rt(n,U("rotatable")))return!0;const r=t.props.rotationTarget;return r?rs(r,!0).some(s=>s?n===s||n.contains(s):!1):!1}const Ho={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`],viewClassName(t){return t.isDragging("rotatable")?U("view-rotation-dragging"):""},render(t,e){const{rotatable:n,rotationPosition:r,zoom:s,renderDirections:o,rotateAroundControls:i,resolveAblesWithRotatable:a}=be(t.props,"rotatable"),{renderPoses:c,direction:l}=t.getState();if(!n)return null;const u=jo(r,c,l),f=[];if(u.forEach(([d,p],g)=>{f.push(ot.jsxs("div",{className:U("rotation"),style:{transform:`translate(-50%) translate(${d[0]}px, ${d[1]}px) rotate(${p}rad)`},children:[ot.jsx("div",{className:U("line rotation-line"),style:{transform:`scaleX(${s})`}}),ot.jsx("div",{className:U("control rotation-control"),style:{transform:`translate(0.5px) scale(${s})`}})]},`rotation${g}`))}),o){const d=Be(a||{}),p={};d.forEach(h=>{a[h].forEach(v=>{p[v]=h})});let g=[];Pt(o)&&(g=o.map(h=>{const v=p[h];return{data:v?{resolve:v}:{},classNames:v?["move"]:[],dir:h}})),f.push(...xo(t,"rotatable",g))}return i&&f.push(...bo(t)),f},dragControlCondition:Wr,dragControlStart(t,e){var k;const{datas:n,clientX:r,clientY:s,parentRotate:o,parentFlag:i,isPinch:a,isRequest:c}=e,l=t.state,{target:u,left:f,top:d,direction:p,beforeDirection:g,targetTransform:h,moveableClientRect:v,offsetMatrix:m,targetMatrix:S,allMatrix:x,width:C,height:E}=l;if(!c&&!u)return!1;const D=t.getRect();n.rect=D,n.transform=h,n.left=f,n.top=d;let R=I=>{const F=Yo(t.state,I);n.fixedDirection=F.fixedDirection,n.fixedOffset=F.fixedOffset,n.fixedPosition=F.fixedPosition,O&&O.setFixedPosition(I)},y=I=>{const F=fl(t.state,I);n.fixedDirection=F.fixedDirection,n.fixedOffset=F.fixedOffset,n.fixedPosition=F.fixedPosition,O&&O.setFixedDirection(I)},M=r,P=s;if(c||a||i){const I=o||0;n.beforeInfo={origin:D.beforeOrigin,prevDeg:I,defaultDeg:I,prevSnapDeg:0,startDist:0},n.afterInfo={...n.beforeInfo,origin:D.origin},n.absoluteInfo={...n.beforeInfo,origin:D.origin,startValue:I}}else{const I=(k=e.inputEvent)==null?void 0:k.target;if(I){const G=I.getAttribute("data-direction")||"",L=Wa[G];if(L){n.isControl=!0,n.isAroundControl=Rt(I,U("around-control")),n.controlDirection=L;const z=I.getAttribute("data-resolve");z&&(n.resolveAble=z);const N=ql(l.rootMatrix,l.renderPoses,v);[M,P]=Mt(N,L)}}n.beforeInfo={origin:D.beforeOrigin},n.afterInfo={origin:D.origin},n.absoluteInfo={origin:D.origin,startValue:D.rotation};const F=R;R=G=>{const L=l.is3d?4:3,[z,N]=ct(oo(S,L),G),Z=Ot(m,ve([z,N],L)),Y=Ot(x,ve([G[0],G[1]],L));F(G);const W=l.posDelta;n.beforeInfo.origin=K(Z,W),n.afterInfo.origin=K(Y,W),n.absoluteInfo.origin=K(Y,W),$r(t,n.beforeInfo,M,P,v),$r(t,n.afterInfo,M,P,v),$r(t,n.absoluteInfo,M,P,v)},y=G=>{const L=Mt([[0,0],[C,0],[0,E],[C,E]],G);R(L)}}n.startClientX=M,n.startClientY=P,n.direction=p,n.beforeDirection=g,n.startValue=0,n.datas={},wn(t,e,"rotate");let _=!1,O=!1;n.isControl&&n.resolveAble&&n.resolveAble==="resizable"&&(O=Nn.dragControlStart(t,{...new Ge("resizable").dragStart([0,0],e),parentPosition:n.controlPosition,parentFixedPosition:n.fixedPosition})),O||(_=wt.dragStart(t,new Ge().dragStart([0,0],e))),R(Ul(t));const T=et(t,e,{set:I=>{n.startValue=I*Math.PI/180},setFixedDirection:y,setFixedPosition:R,...On(t,e),dragStart:_,resizeStart:O}),w=j(t,"onRotateStart",T);return n.isRotate=w!==!1,l.snapRenderInfo={request:e.isRequest},n.isRotate?T:!1},dragControl(t,e){const{datas:n,clientDistX:r,clientDistY:s,parentRotate:o,parentFlag:i,isPinch:a,groupDelta:c,resolveMatrix:l}=e,{beforeDirection:u,beforeInfo:f,afterInfo:d,absoluteInfo:p,isRotate:g,startValue:h,rect:v,startClientX:m,startClientY:S}=n;if(!g)return;_n(t,e,"rotate");const x=xc(e),C=u*x,{parentMoveable:E}=t.props;let D=0,R,y,M=0,P,_,O=0,T,w;const k=180/Math.PI*h,I=p.startValue;let F=!1;const G=m+r,L=S+s;if(!i&&"parentDist"in e){const X=e.parentDist;R=X,P=X,T=X}else a||i?(R=Wn(o,u,f),P=Wn(o,C,d),T=Wn(o,C,p)):(R=Lr(G,L,u,f),P=Lr(G,L,C,d),T=Lr(G,L,C,p),F=!0);if(y=k+R,_=k+P,w=I+T,j(t,"onBeforeRotate",et(t,e,{beforeRotation:y,rotation:_,absoluteRotation:w,setRotation(X){P=X-k,R=P,T=P}},!0)),[D,R,y]=Nr(t,v,f,R,k,F),[M,P,_]=Nr(t,v,d,P,k,F),[O,T,w]=Nr(t,v,p,T,I,F),!O&&!M&&!D&&!E&&!l)return;const z=Tn(n,`rotate(${_}deg)`,`rotate(${P}deg)`);l&&(n.fixedPosition=Tr(t,n.targetAllTransform,n.fixedDirection,n.fixedOffset,n));const N=Tc(t,P,n),Z=K(ct(c||[0,0],N),n.prevInverseDist||[0,0]);n.prevInverseDist=N,n.requestValue=null;const Y=po(t,z,Z,a,e);let W=Y;const J=se([G,L],p.startAbsoluteOrigin)-p.startDist;let q;if(n.resolveAble==="resizable"){const X=Nn.dragControl(t,{...an(e,t.state,[e.deltaX,e.deltaY],!!a,!1,"resizable"),resolveMatrix:!0,parentDistance:J});X&&(q=X,W=vi(W,X,e))}const $=et(t,e,{delta:M,dist:P,rotate:_,rotation:_,beforeDist:R,beforeDelta:D,beforeRotate:y,beforeRotation:y,absoluteDist:T,absoluteDelta:O,absoluteRotate:w,absoluteRotation:w,isPinch:!!a,resize:q,...Y,...W});return j(t,"onRotate",$),$},dragControlEnd(t,e){const{datas:n}=e;if(!n.isRotate)return;n.isRotate=!1;const r=Lt(t,e,{});return j(t,"onRotateEnd",r),r},dragGroupControlCondition:Wr,dragGroupControlStart(t,e){const{datas:n}=e,{left:r,top:s,beforeOrigin:o}=t.state,i=this.dragControlStart(t,e);if(!i)return!1;i.set(n.beforeDirection*t.rotation);const a=oe(t,this,"dragControlStart",e,(u,f)=>{const{left:d,top:p,beforeOrigin:g}=u.state,h=ct(K([d,p],[r,s]),K(g,o));return f.datas.startGroupClient=h,f.datas.groupClient=h,{...f,parentRotate:0}}),c={...i,targets:t.props.targets,events:a},l=j(t,"onRotateGroupStart",c);return n.isRotate=l!==!1,n.isRotate?i:!1},dragGroupControl(t,e){const{datas:n}=e;if(!n.isRotate)return;qn(t,"onBeforeRotate",l=>{j(t,"onBeforeRotateGroup",et(t,e,{...l,targets:t.props.targets},!0))});const r=this.dragControl(t,e);if(!r)return;const s=n.beforeDirection,o=r.beforeDist,i=o/180*Math.PI,a=oe(t,this,"dragControl",e,(l,u)=>{const f=u.datas.startGroupClient,[d,p]=u.datas.groupClient,[g,h]=nn(f,i*s),v=[g-d,h-p];return u.datas.groupClient=[g,h],{...u,parentRotate:o,groupDelta:v}});t.rotation=s*r.beforeRotation;const c={targets:t.props.targets,events:a,set(l){t.rotation=l},setGroupRotation(l){t.rotation=l},...r};return j(t,"onRotateGroup",c),c},dragGroupControlEnd(t,e){const{isDrag:n,datas:r}=e;if(!r.isRotate)return;this.dragControlEnd(t,e);const s=oe(t,this,"dragControlEnd",e),o=Lt(t,e,{targets:t.props.targets,events:s});return j(t,"onRotateGroupEnd",o),n},request(t){const e={};let n=0;const r=t.getRotation();return{isControl:!0,requestStart(){return{datas:e}},request(s){return"deltaRotate"in s?n+=s.deltaRotate:"rotate"in s&&(n=s.rotate-r),{datas:e,parentDist:n}},requestEnd(){return{datas:e,isDrag:!0}}}}};function dl(t,e){const{direction:n,classNames:r,size:s,pos:o,zoom:i,key:a}=t,c=n==="horizontal",l=c?"Y":"X";return e.createElement("div",{key:a,className:r.join(" "),style:{[c?"width":"height"]:`${s}`,transform:`translate(${o[0]}, ${o[1]}) translate${l}(-50%) scale${l}(${i})`}})}function Yr(t,e){return dl({...t,classNames:[U("line","guideline",t.direction),...t.classNames].filter(n=>n),size:t.size||`${t.sizeValue}px`,pos:t.pos||t.posValue.map(n=>`${tt(n,.1)}px`)},e)}function Xo(t,e,n,r,s,o,i,a){const{zoom:c}=t.props;return n.map(({type:l,pos:u},f)=>{const d=[0,0];return d[i]=r,d[i?0:1]=-s+u,Yr({key:`${e}TargetGuideline${f}`,classNames:[U("target","bold",l)],posValue:d,sizeValue:o,zoom:c,direction:e},a)})}function qo(t,e,n,r,s,o){const{zoom:i,isDisplayInnerSnapDigit:a}=t.props,c=e==="horizontal"?le:ue,l=s[c.start],u=s[c.end];return n.filter(({hide:f,elementRect:d})=>{if(f)return!1;if(a&&d){const p=d.rect;if(p[c.start]<=l&&u<=p[c.end])return!1}return!0}).map((f,d)=>{const{pos:p,size:g,element:h,className:v}=f,m=[-r[0]+p[0],-r[1]+p[1]];return Yr({key:`${e}-default-guideline-${d}`,classNames:h?[U("bold"),v]:[U("normal"),v],direction:e,posValue:m,sizeValue:g,zoom:i},o)})}function dn(t,e,n,r,s,o,i,a){const{snapDigit:c=0,isDisplaySnapDigit:l=!0,snapDistFormat:u=(v,m)=>v,zoom:f}=t.props,d=e==="horizontal"?"X":"Y",p=e==="vertical"?"height":"width",g=Math.abs(s),h=l?parseFloat(g.toFixed(c)):0;return ot.jsxs("div",{className:U("guideline-group",e),style:{left:`${o[0]}px`,top:`${o[1]}px`,[p]:`${g}px`},children:[Yr({direction:e,classNames:[U(n),i],size:"100%",posValue:[0,0],sizeValue:g,zoom:f},a),ot.jsx("div",{className:U("size-value","gap"),style:{transform:`translate${d}(-50%) scale(${f})`},children:h>0?u(h,e):""})]},`${e}-${n}-guideline-${r}`)}function pl(t,e,n,r){const s=t==="vertical"?0:1,o=t==="vertical"?1:0,i=s?le:ue,a=n[i.start],c=n[i.end];return xi(e,l=>l.pos[s]).map(l=>{const u=[],f=[],d=[];return l.forEach(p=>{const g=p.element,h=p.elementRect.rect;if(h[i.end]<a)u.push(p);else if(c<h[i.start])f.push(p);else if(h[i.start]<=a&&c<=h[i.end]&&r){const v=p.pos,m={element:g,rect:{...h,[i.end]:h[i.start]}},S={element:g,rect:{...h,[i.start]:h[i.end]}},x=[0,0],C=[0,0];x[s]=v[s],x[o]=v[o],C[s]=v[s],C[o]=v[o]+p.size,u.push({type:t,pos:x,size:0,elementRect:m,direction:"",elementDirection:"end"}),f.push({type:t,pos:C,size:0,elementRect:S,direction:"",elementDirection:"start"})}}),u.sort((p,g)=>g.pos[o]-p.pos[o]),f.sort((p,g)=>p.pos[o]-g.pos[o]),{total:l,start:u,end:f,inner:d}})}function gl(t,e,n,r,s){const{isDisplayInnerSnapDigit:o}=t.props,i=[];return["vertical","horizontal"].forEach(a=>{const c=e.filter(v=>v.type===a),l=a==="vertical"?1:0,u=l?0:1,f=pl(a,c,r,o),d=l?ue:le,p=l?le:ue,g=r[d.start],h=r[d.end];f.forEach(({total:v,start:m,end:S,inner:x})=>{const C=n[u]+v[0].pos[u]-r[p.start];let E=r;m.forEach(D=>{const R=D.elementRect.rect,y=E[d.start]-R[d.end];if(y>0){const M=[0,0];M[l]=n[l]+E[d.start]-g-y,M[u]=C,i.push(dn(t,a,"dashed",i.length,y,M,D.className,s))}E=R}),E=r,S.forEach(D=>{const R=D.elementRect.rect,y=R[d.start]-E[d.end];if(y>0){const M=[0,0];M[l]=n[l]+E[d.end]-g,M[u]=C,i.push(dn(t,a,"dashed",i.length,y,M,D.className,s))}E=R}),x.forEach(D=>{const R=D.elementRect.rect,y=g-R[d.start],M=R[d.end]-h,P=[0,0],_=[0,0];P[l]=n[l]-y,P[u]=C,_[l]=n[l]+h-g,_[u]=C,i.push(dn(t,a,"dashed",i.length,y,P,D.className,s)),i.push(dn(t,a,"dashed",i.length,M,_,D.className,s))})})}),i}function hl(t,e,n,r,s){const o=[];return["horizontal","vertical"].forEach(i=>{const a=e.filter(v=>v.type===i).slice(0,1),c=i==="vertical"?0:1,l=c?0:1,u=c?ue:le,f=c?le:ue,d=r[u.start],p=r[u.end],g=r[f.start],h=r[f.end];a.forEach(({gap:v,gapRects:m})=>{const S=Math.max(g,...m.map(({rect:E})=>E[f.start])),x=Math.min(h,...m.map(({rect:E})=>E[f.end])),C=(S+x)/2;S===x||C===(g+h)/2||m.forEach(({rect:E,className:D})=>{const R=[n[0],n[1]];if(E[u.end]<d)R[c]+=E[u.end]-d;else if(p<E[u.start])R[c]+=E[u.start]-d-v;else return;R[l]+=C-g,o.push(dn(t,c?"vertical":"horizontal","gap",o.length,v,R,D,s))})})}),o}var vl=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(n){return this.values[this.keys.indexOf(n)]},e.set=function(n,r){var s=this.keys,o=this.values,i=s.indexOf(n),a=i===-1?s.length:i;s[a]=n,o[a]=r},t}(),ml=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(n){return this.object[n]},e.set=function(n,r){this.object[n]=r},t}(),xl=typeof Map=="function",Sl=function(){function t(){}var e=t.prototype;return e.connect=function(n,r){this.prev=n,this.next=r,n&&(n.next=this),r&&(r.prev=this)},e.disconnect=function(){var n=this.prev,r=this.next;n&&(n.next=r),r&&(r.prev=n)},e.getIndex=function(){for(var n=this,r=-1;n;)n=n.prev,++r;return r},t}();function El(t,e){var n=[],r=[];return t.forEach(function(s){var o=s[0],i=s[1],a=new Sl;n[o]=a,r[i]=a}),n.forEach(function(s,o){s.connect(n[o-1])}),t.filter(function(s,o){return!e[o]}).map(function(s,o){var i=s[0],a=s[1];if(i===a)return[0,0];var c=n[i],l=r[a-1],u=c.getIndex();c.disconnect(),l?c.connect(l,l.next):c.connect(void 0,n[0]);var f=c.getIndex();return[u,f]})}var Cl=function(){function t(n,r,s,o,i,a,c,l){this.prevList=n,this.list=r,this.added=s,this.removed=o,this.changed=i,this.maintained=a,this.changedBeforeAdded=c,this.fixed=l}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var n=El(this.changedBeforeAdded,this.fixed),r=this.changed,s=[];this.cacheOrdered=n.filter(function(o,i){var a=o[0],c=o[1],l=r[i],u=l[0],f=l[1];if(a!==c)return s.push([u,f]),!0}),this.cachePureChanged=s},t}();function Vr(t,e,n){var r=xl?Map:n?ml:vl,s=n||function(S){return S},o=[],i=[],a=[],c=t.map(s),l=e.map(s),u=new r,f=new r,d=[],p=[],g={},h=[],v=0,m=0;return c.forEach(function(S,x){u.set(S,x)}),l.forEach(function(S,x){f.set(S,x)}),c.forEach(function(S,x){var C=f.get(S);typeof C>"u"?(++m,i.push(x)):g[C]=m}),l.forEach(function(S,x){var C=u.get(S);typeof C>"u"?(o.push(x),++v):(a.push([C,x]),m=g[x]||0,d.push([C-m,x-v]),p.push(x===C),C!==x&&h.push([C,x]))}),i.reverse(),new Cl(t,e,o,i,h,a,d,p)}var Dl=function(){function t(n,r){n===void 0&&(n=[]),this.findKeyCallback=r,this.list=[].slice.call(n)}var e=t.prototype;return e.update=function(n){var r=[].slice.call(n),s=Vr(this.list,r,this.findKeyCallback);return this.list=r,s},t}();/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var jr=function(t,e){return jr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},jr(t,e)};function bl(t,e){jr(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Uo=typeof Map=="function"?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),Ko=function(t){bl(e,t);function e(n){return n===void 0&&(n=[]),t.call(this,n,Uo)||this}return e}(Dl);function yl(t,e){return Vr(t,e,Uo)}function Hr(t){var P;const e=t.state,{containerClientRect:n,hasFixed:r}=e,{overflow:s,scrollHeight:o,scrollWidth:i,clientHeight:a,clientWidth:c,clientLeft:l,clientTop:u}=n,{snapGap:f=!0,verticalGuidelines:d,horizontalGuidelines:p,snapThreshold:g=5,maxSnapElementGuidelineDistance:h=1/0,isDisplayGridGuidelines:v}=t.props,{top:m,left:S,bottom:x,right:C}=Nt(Yt(t.state)),E={top:m,left:S,bottom:x,right:C,center:(S+C)/2,middle:(m+x)/2};let R=[..._l(t)];const y=(((P=e.snapThresholdInfo)==null?void 0:P.multiples)??[1,1]).map(_=>_*g);f&&R.push(...Rl(t,E,y));const M={...e.snapOffset||{left:0,top:0,bottom:0,right:0}};if(R.push(...Pl(t,s?i:c,s?o:a,l,u,M,v)),r){const{left:_,top:O}=n;M.left+=_,M.top+=O,M.right+=_,M.bottom+=O}return R.push(...Qo(p||!1,d||!1,s?i:c,s?o:a,l,u,M)),R=R.filter(({element:_,elementRect:O,type:T})=>{if(!_||!O)return!0;const w=O.rect;return Zo(E,w,T,h)}),R}function Rl(t,e,n){const{maxSnapElementGuidelineDistance:r=1/0,maxSnapElementGapDistance:s=1/0}=t.props,o=t.state.elementRects,i=[];return[["vertical",le,ue],["horizontal",ue,le]].forEach(([a,c,l])=>{const u=e[c.start],f=e[c.end],d=e[c.center],p=e[l.start],g=e[l.end],h={left:n[0],top:n[1]};function v(x){const C=x.rect,E=h[c.start];return C[c.end]<u+E?u-C[c.end]:f-E<C[c.start]?C[c.start]-f:-1}const m=o.filter(x=>{const C=x.rect;return C[l.start]>g||C[l.end]<p?!1:v(x)>0}).sort((x,C)=>v(x)-v(C)),S=[];m.forEach(x=>{m.forEach(C=>{if(x===C)return;const{rect:E}=x,{rect:D}=C,R=E[l.start],y=E[l.end],M=D[l.start],P=D[l.end];R>P||M>y||S.push([x,C])})}),S.forEach(([x,C])=>{const{rect:E}=x,{rect:D}=C,R=E[c.start],y=E[c.end],M=D[c.start],P=D[c.end],_=h[c.start];let O=0,T=0,w=!1,k=!1,I=!1;if(y<=u&&f<=M){if(k=!0,O=(M-y-(f-u))/2,T=y+O+(f-u)/2,B(T-d)>_)return}else if(y<M&&P<u+_){if(w=!0,O=M-y,T=P+O,B(T-u)>_)return}else if(y<M&&f-_<R){if(I=!0,O=M-y,T=R-O,B(T-f)>_)return}else return;O&&Zo(e,D,a,r)&&(O>s||i.push({type:a,pos:a==="vertical"?[T,0]:[0,T],element:C.element,size:0,className:C.className,isStart:w,isCenter:k,isEnd:I,gap:O,hide:!0,gapRects:[x,C],direction:"",elementDirection:""}))})}),i}function Ml(t,e,n,r){var d,p;const s=t.props,o=t.state,{snapGridAll:i}=s,{snapGridWidth:a=0,snapGridHeight:c=0}=s,{snapRenderInfo:l}=o,u=l&&(((d=l.direction)==null?void 0:d[0])||((p=l.direction)==null?void 0:p[1])),f=t.moveables;if(i&&f&&u&&(a||c)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};const g=t.getRect(),h=g.children,v=l.direction;if(h){const m=v.map((x,C)=>{const{snapSize:E,posName:D,sizeName:R,clientOffset:y}=C===0?{snapSize:a,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:c,posName:"top",sizeName:"height",clientOffset:r.top-n};if(!E)return{dir:x,multiple:1,snapSize:E,snapOffset:0};const M=g[R],P=g[D],_=ic(h.map(G=>[G[D]-P,G[R],M-G[R]-G[D]+P])).filter(G=>G).sort((G,L)=>G-L),O=_[0],T=_.map(G=>tt(G/O,.1)*E);let w=1;const k=tt(M/O,.1);for(w=1;w<=10&&!T.every(G=>G*w%1===0);++w);const I=(-x+1)/2,F=Rn(P-y,P-y+M,I,1-I);return{multiple:k*w,dir:x,snapSize:E,snapOffset:Math.round(F/E)}}),S=m.map(x=>x.multiple||1);o.snapThresholdInfo.multiples=S,o.snapThresholdInfo.offset=m.map(x=>x.snapOffset),m.forEach((x,C)=>{x.snapSize})}}else o.snapThresholdInfo=null}function Pl(t,e,n,r=0,s=0,o,i){const a=t.props,c=t.state;let{snapGridWidth:l=0,snapGridHeight:u=0}=a;const f=[],{left:d,top:p}=o;let g=[0,0];Ml(t,r,s,o);const h=c.snapThresholdInfo,v=l,m=u;if(h&&(l*=h.multiples[0]||1,u*=h.multiples[1]||1,g=h.offset),u){const S=x=>{f.push({type:"horizontal",pos:[d,tt(g[1]*m+x-s+p,.1)],className:U("grid-guideline"),size:e,hide:!i,direction:"",grid:!0})};for(let x=0;x<=n*2;x+=u)S(x);for(let x=-u;x>=-n;x-=u)S(x)}if(l){const S=x=>{f.push({type:"vertical",pos:[tt(g[0]*v+x-r+d,.1),p],className:U("grid-guideline"),size:n,hide:!i,direction:"",grid:!0})};for(let x=0;x<=e*2;x+=l)S(x);for(let x=-l;x>=-e;x-=l)S(x)}return f}function Zo(t,e,n,r){return n==="horizontal"?B(t.right-e.left)<=r||B(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:n==="vertical"?B(t.bottom-e.top)<=r||B(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom:!0}function _l(t){const e=t.state,{elementGuidelines:n=[]}=t.props;if(!n.length)return e.elementRects=[],[];const r=(e.elementRects||[]).filter(u=>!u.refresh),s=n.map(u=>qt(u)&&"element"in u?{...u,element:te(u.element,!0)}:{element:te(u,!0)}).filter(u=>u.element),{maintained:o,added:i}=yl(r.map(u=>u.element),s.map(u=>u.element)),a=[];o.forEach(([u,f])=>{a[f]=r[u]}),Tl(t,i.map(u=>s[u])).map((u,f)=>{a[i[f]]=u}),e.elementRects=a;const c=Br(t.props.elementSnapDirections),l=[];return a.forEach(u=>{const{element:f,top:d=c.top,left:p=c.left,right:g=c.right,bottom:h=c.bottom,center:v=c.center,middle:m=c.middle,className:S,rect:x}=u,{horizontal:C,vertical:E,horizontalNames:D,verticalNames:R}=zr({top:d,right:g,left:p,bottom:h,center:v,middle:m},x),y=x.top,M=x.left,P=x.right-M,_=x.bottom-y,O=[P,_];E.forEach((T,w)=>{l.push({type:"vertical",element:f,pos:[tt(T,.1),y],size:_,sizes:O,className:S,elementRect:u,elementDirection:Mo[R[w]]||R[w],direction:""})}),C.forEach((T,w)=>{l.push({type:"horizontal",element:f,pos:[M,tt(T,.1)],size:P,sizes:O,className:S,elementRect:u,elementDirection:Mo[D[w]]||D[w],direction:""})})}),l}function Jo(t,e){return t?t.map(n=>{const r=qt(n)?n:{pos:n},s=r.pos;return Qe(s)?r:{...r,pos:ut(s,e)}}):[]}function Qo(t,e,n,r,s=0,o=0,i={left:0,top:0,right:0,bottom:0}){const a=[],{left:c,top:l,bottom:u,right:f}=i,d=n+f-c,p=r+u-l;return Jo(t,p).forEach(g=>{a.push({type:"horizontal",pos:[c,tt(g.pos-o+l,.1)],size:d,className:g.className,direction:""})}),Jo(e,d).forEach(g=>{a.push({type:"vertical",pos:[tt(g.pos-s+c,.1),l],size:p,className:g.className,direction:""})}),a}function Tl(t,e){if(!e.length)return[];const n=t.props.groupable,r=t.state,{containerClientRect:s,rootMatrix:o,is3d:i,offsetDelta:a}=r,c=i?4:3,[l,u]=Hc(o,s,c),f=n?0:a[0],d=n?0:a[1];return e.map(p=>{const g=p.element.getBoundingClientRect(),h=g.left-l-f,v=g.top-u-d,m=v+g.height,S=h+g.width,[x,C]=Ve(o,[h,v],c),[E,D]=Ve(o,[S,m],c);return{...p,rect:{left:x,right:E,top:C,bottom:D,center:(x+E)/2,middle:(C+D)/2}}})}function Yn(t){const e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;const s=e.containerClientRect,o={left:0,top:0,bottom:0,right:0};if(n!==r){const i=te(r,!0);if(i){const a=mn(i),c=Ei(e,[a.left-s.left,a.top-s.top]),l=Ei(e,[a.right-s.right,a.bottom-s.bottom]);o.left=tt(c[0],1e-5),o.top=tt(c[1],1e-5),o.right=tt(l[0],1e-5),o.bottom=tt(l[1],1e-5)}}return e.snapContainer=r,e.snapOffset=o,e.guidelines=Hr(t),e.enableSnap=!0,!0}function ti(t,e,n,r,s,o){const i=De(t,e,n,o?4:3),a=Mt(i,r);return Zr(i,K(s,a))}function ei(t){return t?t/B(t):0}function Ol(t,e,n,r,s,o){const{fixedDirection:i}=o,a=Kc(n,i,r),c=kr(t,e,n,r),l=[...cl(t,e,a,r,s,o),...Fo(t,c,o)],u=Fn(l,0),f=Fn(l,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:f.isBound,offset:f.offset[1]}}}function wl(t,e,n,r,s,o,i,a,c){const l=Mt(e,i),{horizontal:{offset:u},vertical:{offset:f}}=Ln(t,a,{vertical:[l[0]],horizontal:[l[1]]});if(tt(f,ur)||tt(u,ur)){const[d,p]=Qt({datas:c,distX:-f,distY:-u}),g=Math.min(s||1/0,n+i[0]*d),h=Math.min(o||1/0,r+i[1]*p);return[g-n,h-r]}return[0,0]}function ni(t,e,n,r,s,o,i,a){const c=Yt(t.state),l=t.props.keepRatio;let u=0,f=0;for(let d=0;d<2;++d){const p=e(u,f),{width:g,height:h}=Ol(t,p,s,l,i,a),v=g.isBound,m=h.isBound;let S=g.offset,x=h.offset;if(d===1&&(v||(S=0),m||(x=0)),d===0&&i&&!v&&!m)return[0,0];if(l){const C=B(S)*(n?1/n:1),E=B(x)*(r?1/r:1);(v&&m?C<E:m||!v&&C<E)?S=n*x/r:x=r*S/n}u+=S,f+=x}if(!l&&s[0]&&s[1]){const{maxWidth:d,maxHeight:p}=ul(t,c,s,o,a),[g,h]=wl(t,e(u,f).map(v=>v.map(m=>tt(m,ur))),n+u,r+f,d,p,s,i,a);u+=g,f+=h}return[u,f]}function pn(t){return t<0&&(t=t%360+360),t%=360,t}function Il(t,e){e=pn(e);const n=Math.floor(t/360),r=n*360+360-e,s=n*360+e;return B(t-r)<B(t-s)?r:s}function Xr(t,e){t=pn(t),e=pn(e);const n=pn(t-e);return Math.min(n,360-n)}function Bl(t,e,n,r){const s=t.props,o=s[Po]??5,i=s[_o];if(Ne(t,"rotatable")){const{pos1:a,pos2:c,pos3:l,pos4:u,origin:f}=e,d=n*Math.PI/180,p=[a,c,l,u].map(m=>K(m,f)),g=p.map(m=>nn(m,d)),h=[...Wc(t,p,g,f,n),...nl(t,p,g,f,n)];h.sort((m,S)=>B(m-n)-B(S-n));const v=h.length>0;if(v)return{isSnap:v,dist:v?h[0]:n}}if(i!=null&&i.length&&o){const c=i.slice().sort((l,u)=>Xr(l,r)-Xr(u,r))[0];if(Xr(c,r)<=o)return{isSnap:!0,dist:n+Il(r,c)-r}}return{isSnap:!1,dist:n}}function zl(t,e,n,r,s,o,i){if(!Ne(t,"resizable"))return[0,0];const{fixedDirection:a,nextAllMatrix:c}=i,{allMatrix:l,is3d:u}=t.state;return ni(t,(f,d)=>ti(c||l,e+f,n+d,a,s,u),e,n,r,s,o,i)}function Al(t,e,n,r,s){if(!Ne(t,"scalable"))return[0,0];const{startOffsetWidth:o,startOffsetHeight:i,fixedPosition:a,fixedDirection:c,is3d:l}=s,u=ni(t,(f,d)=>ti(Rc(s,ct(e,[f/o,d/i])),o,i,c,a,l),o,i,n,a,r,s);return[u[0]/o,u[1]/i]}function Gl(t,e){e.absolutePoses=Yt(t.state)}function ri(t){const e=[];return t.forEach(n=>{n.guidelineInfos.forEach(({guideline:r})=>{$t(e,s=>s.guideline===r)||(r.direction="",e.push({guideline:r,posInfo:n}))})}),e.map(({guideline:n,posInfo:r})=>({...n,direction:r.direction}))}function si(t,e,n,r,s,o){const{vertical:i,horizontal:a}=Ir(Gn(t,o),e,n),c=Le();i.forEach(d=>{d.isBound&&(d.direction==="start"&&(c.left=!0),d.direction==="end"&&(c.right=!0),r.push({type:"bounds",pos:d.pos}))}),a.forEach(d=>{d.isBound&&(d.direction==="start"&&(c.top=!0),d.direction==="end"&&(c.bottom=!0),s.push({type:"bounds",pos:d.pos}))});const{boundMap:l,vertical:u,horizontal:f}=rl(t);return u.forEach(d=>{re(r,({type:p,pos:g})=>p==="bounds"&&g===d)>=0||r.push({type:"bounds",pos:d})}),f.forEach(d=>{re(s,({type:p,pos:g})=>p==="bounds"&&g===d)>=0||s.push({type:"bounds",pos:d})}),{boundMap:c,innerBoundMap:l}}const kl=ns("",["resizable","scalable"]),oi={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",Po,_o,To,Oo,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render(t,e){const n=t.state,{top:r,left:s,pos1:o,pos2:i,pos3:a,pos4:c,snapRenderInfo:l}=n,{snapRenderThreshold:u=1}=t.props;if(!l||!l.render||!Ne(t,""))return je(t,"boundMap",Le(),z=>JSON.stringify(z)),je(t,"innerBoundMap",Le(),z=>JSON.stringify(z)),[];n.guidelines=Hr(t);const f=Math.min(o[0],i[0],a[0],c[0]),d=Math.min(o[1],i[1],a[1],c[1]),p=l.externalPoses||[],g=Yt(t.state),h=[],v=[],m=[],S=[],x=[],{width:C,height:E,top:D,left:R,bottom:y,right:M}=Nt(g),P={left:R,right:M,top:D,bottom:y,center:(R+M)/2,middle:(D+y)/2},_=p.length>0,O=_?Nt(p):{};if(!l.request){if(l.direction&&x.push(Uc(t,g,l.direction,u,u)),l.snap){const z=Nt(g);l.center&&(z.middle=(z.top+z.bottom)/2,z.center=(z.left+z.right)/2),x.push(Io(t,z,u,u))}_&&(l.center&&(O.middle=(O.top+O.bottom)/2,O.center=(O.left+O.right)/2),x.push(Io(t,O,u,u))),x.forEach(z=>{const{vertical:{posInfos:N},horizontal:{posInfos:Z}}=z;h.push(...N.filter(({guidelineInfos:Y})=>Y.some(({guideline:W})=>!W.hide)).map(Y=>({type:"snap",pos:Y.pos}))),v.push(...Z.filter(({guidelineInfos:Y})=>Y.some(({guideline:W})=>!W.hide)).map(Y=>({type:"snap",pos:Y.pos}))),m.push(...ri(N)),S.push(...ri(Z))})}const{boundMap:T,innerBoundMap:w}=si(t,[R,M],[D,y],h,v);_&&si(t,[O.left,O.right],[O.top,O.bottom],h,v,l.externalBounds);const k=[...m,...S],I=k.filter(z=>z.element&&!z.gapRects),F=k.filter(z=>z.gapRects).sort((z,N)=>z.gap-N.gap);j(t,"onSnap",{guidelines:k.filter(({element:z})=>!z),elements:I,gaps:F},!0);const G=je(t,"boundMap",T,z=>JSON.stringify(z),Le()),L=je(t,"innerBoundMap",w,z=>JSON.stringify(z),Le());return(T===G||w===L)&&j(t,"onBound",{bounds:T,innerBounds:w},!0),[...gl(t,I,[f,d],P,e),...hl(t,F,[f,d],P,e),...qo(t,"horizontal",S,[s,r],P,e),...qo(t,"vertical",m,[s,r],P,e),...Xo(t,"horizontal",v,f,r,C,0,e),...Xo(t,"vertical",h,d,s,E,1,e)]},dragStart(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Yn(t)},drag(t){const e=t.state;Yn(t)||(e.guidelines=Hr(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart(t){this.unset(t)},dragEnd(t){this.unset(t)},dragControlCondition(t,e){if(kl(t,e)||Wr(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Rt(e.inputEvent.target,U("snap-control"))},dragControlStart(t){t.state.snapRenderInfo=null,Yn(t)},dragControl(t){this.drag(t)},dragControlEnd(t){this.unset(t)},dragGroupStart(t,e){this.dragStart(t,e)},dragGroup(t){this.drag(t)},dragGroupEnd(t){this.unset(t)},dragGroupControlStart(t){t.state.snapRenderInfo=null,Yn(t)},dragGroupControl(t){this.drag(t)},dragGroupControlEnd(t){this.unset(t)},unset(t){const e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function Fl(t,e){return[t[0]*e[0],t[1]*e[1]]}function U(...t){return Va(lr,...t)}function ii(t){t()}function $l(t){return!t||t==="none"?[1,0,0,1,0,0]:qt(t)?t:on(t)}function gn(t,e,n){return Mn(e,me(n,e),t,me(n.map(r=>-r),e))}function Ll(t,e,n){return e==="%"?Ur(t.ownerSVGElement)[n?"width":"height"]/100:1}function Nl(t){return Wl(Qr(t,":before")).map((n,r)=>{const{value:s,unit:o}=tn(n);return s*Ll(t,o,r===0)})}function Vn(t){return t?t.split(" "):["0","0"]}function Wl(t){return Vn(t.transformOrigin)}function ai(t){const n=Gt(t)("transform");if(n&&n!=="none")return n;if("transform"in t){const s=t.transform.baseVal;if(!s)return"";const o=s.length;if(!o)return"";const i=[];for(let a=0;a<o;++a){const c=s[a].matrix;i.push(`matrix(${["a","b","c","d","e","f"].map(l=>c[l]).join(", ")})`)}return i.join(" ")}return""}function hn(t,e,n,r,s){var h,v;const o=Cr(t)||ae(t);let i=!1,a,c;if(!t||n)a=t;else{const m=(h=t==null?void 0:t.assignedSlot)==null?void 0:h.parentElement,S=t.parentElement;m?(i=!0,c=S,a=m):a=S}let l=!1,u=t===e||a===e,f="relative",d=1;const p=parseFloat(s==null?void 0:s("zoom"))||1,g=s==null?void 0:s("position");for(;a&&a!==o;){e===a&&(u=!0);const m=Gt(a),S=a.tagName.toLowerCase(),x=ai(a),C=m("willChange"),E=parseFloat(m("zoom"))||1;if(f=m("position"),r&&E!==1){d=E;break}if(!n&&r&&p!==1&&g&&g!=="absolute"||S==="svg"||S==="foreignobject"||f!=="static"||x&&x!=="none"||C==="transform")break;const D=(v=t==null?void 0:t.assignedSlot)==null?void 0:v.parentNode,R=a.parentNode;D&&(i=!0,c=R);const y=R;if(y&&y.nodeType===11){a=y.host,l=!0,f=Gt(a)("position");break}a=y,f="relative"}return{offsetZoom:d,hasSlot:i,parentSlotElement:c,isCustomElement:l,isStatic:f==="static",isEnd:u||!a||a===o,offsetParent:a||o}}function Yl(t,e){const n=t.tagName.toLowerCase();let r=t.offsetLeft,s=t.offsetTop;const o=Gt(t),i=gr(r);let a=!i,c,l;return!a&&(n!=="svg"||t.ownerSVGElement)?(c=Ls?Nl(t):Vn(o("transformOrigin")).map(u=>parseFloat(u)),l=c.slice(),a=!0,n==="svg"?(r=0,s=0):[r,s,c[0],c[1]]=Hl(t,c,t===e&&e.tagName.toLowerCase()==="g")):(c=Vn(o("transformOrigin")).map(u=>parseFloat(u)),l=c.slice()),{tagName:n,isSVG:i,hasOffset:a,offset:[r||0,s||0],origin:c,targetOrigin:l}}function ci(t,e){const n=Gt(t),r=Gt(ae(t)),s=r("position");if(!e&&(!s||s==="static"))return[0,0];let o=parseInt(r("marginLeft"),10),i=parseInt(r("marginTop"),10);return n("position")==="absolute"&&((n("top")!=="auto"||n("bottom")!=="auto")&&(i=0),(n("left")!=="auto"||n("right")!=="auto")&&(o=0)),[o,i]}function qr(t){t.forEach(e=>{const n=e.matrix;n&&(e.matrix=Ut(n,3,4))})}function Vl(t){let e=t.parentElement,n=!1;const r=ae(t);for(;e;){const s=Qr(e).transform;if(s&&s!=="none"){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function jn(t,e=t.length>9){return`${e?"matrix3d":"matrix"}(${io(t,!e).join(",")})`}function Ur(t){const e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};const r=t.viewBox,s=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:s.x,y:s.y,width:s.width||e,height:s.height||n,clientWidth:e,clientHeight:n}}function jl(t,e){const{width:n,height:r,clientWidth:s,clientHeight:o}=Ur(t),i=s/n,a=o/r,c=t.preserveAspectRatio.baseVal,l=c.align,u=c.meetOrSlice,f=[0,0],d=[i,a],p=[0,0];if(l!==1){const h=(l-2)%3,v=Math.floor((l-2)/3);f[0]=n*h/2,f[1]=r*v/2;const m=u===2?Math.max(a,i):Math.min(i,a);d[0]=m,d[1]=m,p[0]=(s-n)/2*h,p[1]=(o-r)/2*v}const g=yr(d,e);return[g[e*(e-1)],g[e*(e-1)+1]]=p,gn(g,e,f)}function Hl(t,e,n){const r=t.tagName.toLowerCase();if(!t.getBBox||!n&&r==="g")return[0,0,0,0];const o=Gt(t)("transform-box")==="fill-box",i=t.getBBox(),a=Ur(t.ownerSVGElement);let c=i.x,l=i.y;r==="foreignobject"&&!c&&!l&&(c=parseFloat(t.getAttribute("x"))||0,l=parseFloat(t.getAttribute("y"))||0);const u=c-a.x,f=l-a.y,d=o?e[0]:e[0]-u,p=o?e[1]:e[1]-f;return[u,f,d,p]}function mt(t,e,n){return Ot(t,ve(e,n),n)}function De(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(s=>mt(t,s,r))}function Nt(t){const e=t.map(l=>l[0]),n=t.map(l=>l[1]),r=Math.min(...e),s=Math.min(...n),o=Math.max(...e),i=Math.max(...n),a=o-r,c=i-s;return{left:r,top:s,right:o,bottom:i,width:a,height:c}}function li(t,e,n,r){const s=De(t,e,n,r);return Nt(s)}function Xl(t,e,n,r,s){const o=t.target,i=t.origin,a=e.matrix,{offsetWidth:c,offsetHeight:l}=fi(o),u=n.getBoundingClientRect();let f=[0,0];n===ae(n)&&(f=ci(o,!0));const d=o.getBoundingClientRect(),p=d.left-u.left+n.scrollLeft-(n.clientLeft||0)+f[0],g=d.top-u.top+n.scrollTop-(n.clientTop||0)+f[1],h=d.width,v=d.height,m=Mn(r,s,a),{left:S,top:x,width:C,height:E}=li(m,c,l,r),D=mt(m,i,r),R=K(D,[S,x]),y=[p+R[0]*h/C,g+R[1]*v/E],M=[0,0];let P=0;for(;++P<10;){const _=Jt(s,r);[M[0],M[1]]=K(mt(_,y,r),mt(_,D,r));const O=Mn(r,s,me(M,r),a),{left:T,top:w}=li(O,c,l,r),k=T-p,I=w-g;if(B(k)<2&&B(I)<2)break;y[0]-=k,y[1]-=I}return M.map(_=>Math.round(_))}function ql(t,e,n){const s=t.length===16?4:3,o=e.map(c=>mt(t,c,s)),{left:i,top:a}=n;return o.map(c=>[c[0]+i,c[1]+a])}function Wt(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ui(t,e){return Wt([e[0]-t[0],e[1]-t[1]])}function vn(t,e,n=1,r=xt(t,e)){const s=ui(t,e);return{transform:`translateY(-50%) translate(${t[0]}px, ${t[1]}px) rotate(${r}rad) scaleY(${n})`,width:`${s}px`}}function Hn(t,e,...n){const r=n.length,s=n.reduce((i,a)=>i+a[0],0)/r,o=n.reduce((i,a)=>i+a[1],0)/r;return{transform:`translateZ(0px) translate(${s}px, ${o}px) rotate(${t}rad) scale(${e})`}}function be(t,e){const n=t[e];return qt(n)?{...t,...n}:t}function fi(t){const e=t&&!gr(t.offsetWidth);let n=0,r=0,s=0,o=0,i=0,a=0,c=0,l=0,u=0,f=0,d=0,p=0,g=1/0,h=1/0,v=1/0,m=1/0,S=0,x=0,C=!1;if(t)if(!e&&t.ownerSVGElement){const E=t.getBBox();C=!0,n=E.width,r=E.height,i=n,a=r,c=n,l=r,s=n,o=r}else{const E=Gt(t),D=t.style,R=E("boxSizing")==="border-box",y=parseFloat(E("borderLeftWidth"))||0,M=parseFloat(E("borderRightWidth"))||0,P=parseFloat(E("borderTopWidth"))||0,_=parseFloat(E("borderBottomWidth"))||0,O=parseFloat(E("paddingLeft"))||0,T=parseFloat(E("paddingRight"))||0,w=parseFloat(E("paddingTop"))||0,k=parseFloat(E("paddingBottom"))||0,I=O+T,F=w+k,G=y+M,L=P+_,z=I+G,N=F+L,Z=E("position");let Y=0,W=0;if("clientLeft"in t){let J=null;if(Z==="absolute"?J=hn(t,ae(t)).offsetParent:J=t.parentElement,J){const q=Gt(J);Y=parseFloat(q("width")),W=parseFloat(q("height"))}}u=Math.max(I,ut(E("minWidth"),Y)||0),f=Math.max(F,ut(E("minHeight"),W)||0),g=ut(E("maxWidth"),Y),h=ut(E("maxHeight"),W),isNaN(g)&&(g=1/0),isNaN(h)&&(h=1/0),S=ut(D.width,0)||0,x=ut(D.height,0)||0,i=parseFloat(E("width"))||0,a=parseFloat(E("height"))||0,c=B(i-S)<1?xr(u,S||i,g):i,l=B(a-x)<1?xr(f,x||a,h):a,n=c,r=l,s=c,o=l,R?(v=g,m=h,d=u,p=f,c=n-z,l=r-N):(v=g+z,m=h+N,d=u+z,p=f+N,n=c+z,r=l+N),s=c+I,o=l+F}return{svg:C,offsetWidth:n,offsetHeight:r,clientWidth:s,clientHeight:o,contentWidth:c,contentHeight:l,inlineCSSWidth:S,inlineCSSHeight:x,cssWidth:i,cssHeight:a,minWidth:u,minHeight:f,maxWidth:g,maxHeight:h,minOffsetWidth:d,minOffsetHeight:p,maxOffsetWidth:v,maxOffsetHeight:m}}function di(t,e){return xt(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Xn(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function pi(t,e){const n=t===ae(t)||t===Cr(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=Gt(t)("overflow")!=="visible",{...e,...r}}function Kr(t,e,n,r){const{left:s,right:o,top:i,bottom:a}=t,c=e.top,l=e.left,u={left:l+s,top:c+i,right:l+o,bottom:c+a,width:o-s,height:a-i};return n&&r?pi(n,u):u}function mn(t,e){let n=0,r=0,s=0,o=0;if(t){const a=t.getBoundingClientRect();n=a.left,r=a.top,s=a.width,o=a.height}const i={left:n,top:r,width:s,height:o,right:n+s,bottom:r+o};return t&&e?pi(t,i):i}function Ul(t){const{groupable:e,svgOrigin:n}=t.props,{offsetWidth:r,offsetHeight:s,svg:o,transformOrigin:i}=t.getState();return!e&&o&&n?os(n,r,s):i}function gi(t,e,n,r){let s;if(t)s=t;else if(e)s=[0,0];else{const o=n.target;s=hi(o,r)}return s}function hi(t,e){if(!t)return;const n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,!r)return;const s=[0,0];return r.indexOf("w")>-1&&(s[0]=-1),r.indexOf("e")>-1&&(s[0]=1),r.indexOf("n")>-1&&(s[1]=-1),r.indexOf("s")>-1&&(s[1]=1),s}function Zr(t,e){return[ct(e,t[0]),ct(e,t[1]),ct(e,t[2]),ct(e,t[3])]}function Yt({left:t,top:e,pos1:n,pos2:r,pos3:s,pos4:o}){return Zr([n,r,s,o],[t,e])}function Jr(t,e){t[e?"controlAbles":"targetAbles"].forEach(n=>{n.unset&&n.unset(t)})}function We(t,e){const n=e?"controlGesto":"targetGesto",r=t[n];(r==null?void 0:r.isIdle())===!1&&Jr(t,e),r==null||r.unset(),t[n]=null}function Bt(t,e){if(e){const n=ke(e);n.nextStyle={...n.nextStyle,...t}}return{style:t,cssText:Be(t).map(n=>`${ec(n,"-")}: ${t[n]};`).join("")}}function vi(t,e,n){const r=e.afterTransform||e.transform;return{...Bt({...t.style,...e.style,transform:r},n),afterTransform:r,transform:t.transform}}function et(t,e,n,r){const s=e.datas;s.datas||(s.datas={});const o={...n,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:s.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble(){s.isEventStart=!1},stopDrag(){var i;(i=e.stop)==null||i.call(e)}};return s.isStartEvent?r||(s.lastEvent=o):s.isStartEvent=!0,o}function Lt(t,e,n){const r=e.datas,s="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),{isDrag:s,...n,moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag}}function qn(t,e,n){t._emitter.on(e,n)}function j(t,e,n,r,s){return t.triggerEvent(e,n,r,s)}function Qr(t,e){return ce(t).getComputedStyle(t,e)}function Un(t,e,n){const r={},s={};return t.filter(o=>{const i=o.name;if(r[i]||!e.some(a=>o[a]))return!1;if(!n&&o.ableGroup){if(s[o.ableGroup])return!1;s[o.ableGroup]=!0}return r[i]=!0,!0})}function ts(t,e){return t===e||t==null&&e==null}function mi(...t){const e=t.length-1;for(let n=0;n<e;++n){const r=t[n];if(!gr(r))return r}return t[e]}function xi(t,e){const n=[],r=[];return t.forEach((s,o)=>{const i=e(s,o,t),a=r.indexOf(i),c=n[a]||[];a===-1&&(r.push(i),n.push(c)),c.push(s)}),n}function Kl(t,e){const n=[],r={};return t.forEach((s,o)=>{const i=e(s,o,t);let a=r[i];a||(a=[],r[i]=a,n.push(a)),a.push(s)}),n}function Si(t){return t.reduce((e,n)=>e.concat(n),[])}function Ye(...t){return t.sort((e,n)=>B(n)-B(e)),t[0]}function Ve(t,e,n){return Ot(Jt(t,n),ve(e,n),n)}function Zl(t,e){const{is3d:n,rootMatrix:r}=t,s=n?4:3;return[e.distX,e.distY]=Ve(r,[e.distX,e.distY],s),e}function Vt(t,e,n,r){if(!n[0]&&!n[1])return e;const s=mt(t,[ei(n[0]||1),0],r),o=mt(t,[0,ei(n[1]||1)],r),i=mt(t,[n[0]/Wt(s),n[1]/Wt(o)],r);return ct(e,i)}function Zt(t,e,n){return n?`${t/e*100}%`:`${t}px`}function Kn(t){return B(t)<=It?0:t}function es(t){return e=>{if(!e.isDragging(t))return"";const r=Ic(e,t).deg;return r?U(`view-control-rotation${r}`):""}}function ns(t,e=[t]){return(n,r)=>{if(r.isRequest)return e.some(o=>r.requestAble===o)?r.parentDirection:!1;const s=r.inputEvent.target;return Rt(s,U("direction"))&&(!t||Rt(s,U(t)))}}function Jl(t,e,n){const r=Ae(t,{"x%":C=>C/100*e.offsetWidth,"y%":C=>C/100*e.offsetHeight}),s=t.slice(0,n<0?void 0:n),o=t.slice(0,n<0?void 0:n+1),i=t[n]||"",a=n<0?[]:t.slice(n),c=n<0?[]:t.slice(n+1),l=r.slice(0,n<0?void 0:n),u=r.slice(0,n<0?void 0:n+1),f=r[n]??Ae([""])[0],d=n<0?[]:r.slice(n),p=n<0?[]:r.slice(n+1),g=f?[f]:[],h=ze(l),v=ze(u),m=ze(d),S=ze(p),x=ft(h,m,4);return{transforms:t,beforeFunctionMatrix:h,beforeFunctionMatrix2:v,targetFunctionMatrix:ze(g),afterFunctionMatrix:m,afterFunctionMatrix2:S,allFunctionMatrix:x,beforeFunctions:l,beforeFunctions2:u,targetFunction:g[0],afterFunctions:d,afterFunctions2:p,beforeFunctionTexts:s,beforeFunctionTexts2:o,targetFunctionText:i,afterFunctionTexts:a,afterFunctionTexts2:c}}function Ql(t){return!t||!qt(t)||Dr(t)?!1:Pt(t)||"length"in t}function te(t,e){return t?Dr(t)?t:ne(t)?e?document.querySelector(t):t:hr(t)?t():ro(t)?t:"current"in t?t.current:t:null}function rs(t,e){return t?(Ql(t)?[].slice.call(t):[t]).reduce((r,s)=>ne(s)&&e?[...r,...[].slice.call(document.querySelectorAll(s))]:(Pt(s)?r.push(rs(s,e)):r.push(te(s,e)),r),[]):[]}function tu(t,e,n){let r=xt(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function Ei(t,e){const{rootMatrix:n,is3d:r}=t;let o=Jt(n,r?4:3);return r||(o=Ut(o,3,4)),o[12]=0,o[13]=0,o[14]=0,mc(o,e)}function Ci(t,e,n,r,s){const[o,i]=t;let a=0,c=0;if(s&&o&&i){const l=xt([0,0],e),u=xt([0,0],r),f=Wt(e),d=Math.cos(l-u)*f;if(!r[0])c=d,a=c*n;else if(!r[1])a=d,c=a/n;else{const p=r[0]*o,g=r[1]*i;let h=Math.atan2(p+e[0],g+e[1]),v=Math.atan2(p,g);h<0&&(h+=Math.PI*2),v<0&&(v+=Math.PI*2);let m=0;B(h-v)<Math.PI/2||B(h-v)>Math.PI/2*3||(v+=Math.PI),m=h-v,m>Math.PI*2?m-=Math.PI*2:m>Math.PI?m=2*Math.PI-m:m<-Math.PI&&(m=-2*Math.PI-m);const S=Wt([p+e[0],g+e[1]])*Math.cos(m);a=S*Math.sin(v)-p,c=S*Math.cos(v)-g,r[0]<0&&(a*=-1),r[1]<0&&(c*=-1)}}else a=r[0]*e[0],c=r[1]*e[1];return[a,c]}function Di(t,e,n,r){const{ratio:s,startOffsetWidth:o,startOffsetHeight:i}=n;let a=0,c=0;const{distX:l,distY:u,pinchScale:f,parentDistance:d,parentDist:p,parentScale:g}=r,h=n.fixedDirection,v=[0,1].map(S=>B(t[S]-h[S])),m=[0,1].map(S=>{let x=v[S];return x!==0&&(x=2/x),x});if(p)a=p[0],c=p[1],e&&(a?c||(c=a/s):a=c*s);else if(Qe(f))a=(f-1)*o,c=(f-1)*i;else if(g)a=(g[0]-1)*o,c=(g[1]-1)*i;else if(d){const S=o*v[0],x=i*v[1],C=Wt([S,x]);a=d/C*S*m[0],c=d/C*x*m[1]}else{let S=Qt({datas:n,distX:l,distY:u});S=m.map((x,C)=>S[C]*x),[a,c]=Ci([o,i],S,s,t,e)}return{distWidth:a,distHeight:c}}function ss(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};const[n,r]=t.split(" "),s=ss(n||""),o=ss(r||""),i={...s,...o},a={x:"50%",y:"50%"};return i.x&&(a.x=i.x),i.y&&(a.y=i.y),i.value&&(i.x&&!i.y&&(a.y=i.value),!i.x&&i.y&&(a.x=i.value)),a}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function os(t,e,n){const{x:r,y:s}=ss(t,!0);return[ut(r,e)||0,ut(s,n)||0]}function eu(t,e,n){const r=t.map(o=>K(o,e)),s=r.map(o=>nn(o,n));return{prev:r,next:s,result:s.map(o=>ct(o,e))}}function bi(t,e){return t.length===e.length&&t.every((n,r)=>{const s=e[r],o=Pt(n),i=Pt(s);return o&&i?bi(n,s):!o&&!i?n===s:!1})}function je(t,e,n,r,s){const o=t._store;let i=o[e];if(!(e in o))if(s!=null)o[e]=s,i=s;else return o[e]=n,n;return i===n||r(i)===r(n)?i:(o[e]=n,n)}function zt(t){return t>=0?1:-1}function B(t){return Math.abs(t)}function is(t,e){return oc(t).map(n=>e(n))}function yi(t){return Qe(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}const Ri=we("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart(){return!0},pinchStart(t,e){const{datas:n,targets:r,angle:s,originalDatas:o}=e,{pinchable:i,ables:a}=t.props;if(!i)return!1;const c=`onPinch${r?"Group":""}Start`,l=`drag${r?"Group":""}ControlStart`,u=(i===!0?t.controlAbles:a.filter(g=>i.indexOf(g.name)>-1)).filter(g=>g.canPinch&&g[l]),f=et(t,e,{});r&&(f.targets=r);const d=j(t,c,f);n.isPinch=d!==!1,n.ables=u;const p=n.isPinch;return p?(u.forEach(g=>{if(o[g.name]=o[g.name]||{},!g[l])return;const h={...e,datas:o[g.name],parentRotate:s,isPinch:!0};g[l](t,h)}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},p):!1},pinch(t,e){const{datas:n,scale:r,distance:s,originalDatas:o,inputEvent:i,targets:a,angle:c}=e;if(!n.isPinch)return;const l=s*(1-1/r),u=et(t,e,{});a&&(u.targets=a),j(t,`onPinch${a?"Group":""}`,u);const d=n.ables,p=`drag${a?"Group":""}Control`;return d.forEach(g=>{g[p]&&g[p](t,{...e,datas:o[g.name],inputEvent:i,resolveMatrix:!0,pinchScale:r,parentDistance:l,parentRotate:c,isPinch:!0})}),u},pinchEnd(t,e){const{datas:n,isPinch:r,inputEvent:s,targets:o,originalDatas:i}=e;if(!n.isPinch)return;const a=`onPinch${o?"Group":""}End`,c=Lt(t,e,{isDrag:r});o&&(c.targets=o),j(t,a,c);const l=n.ables,u=`drag${o?"Group":""}ControlEnd`;return l.forEach(f=>{f[u]&&f[u](t,{...e,isDrag:r,datas:i[f.name],inputEvent:s,isPinch:!0})}),r},pinchGroupStart(t,e){return this.pinchStart(t,{...e,targets:t.props.targets})},pinchGroup(t,e){return this.pinch(t,{...e,targets:t.props.targets})},pinchGroupEnd(t,e){return this.pinchEnd(t,{...e,targets:t.props.targets})}}),Mi=ns("scalable"),Pi={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Co("scalable"),dragControlCondition:Mi,viewClassName:es("scalable"),dragControlStart(t,e){const{datas:n,isPinch:r,inputEvent:s,parentDirection:o}=e,i=gi(o,r,s,n),{width:a,height:c,targetTransform:l,target:u,pos1:f,pos2:d,pos4:p}=t.state;if(!i||!u)return!1;r||Se(t,e),n.datas={},n.transform=l,n.prevDist=[1,1],n.direction=i,n.startOffsetWidth=a,n.startOffsetHeight=c,n.startValue=[1,1];const g=!i[0]&&!i[1]||i[0]||!i[1];wn(t,e,"scale"),n.isWidth=g;function h(E){n.ratio=E&&isFinite(E)?E:0}n.startPositions=Yt(t.state);function v(E){const D=Wo(n.startPositions,E);n.fixedDirection=D.fixedDirection,n.fixedPosition=D.fixedPosition,n.fixedOffset=D.fixedOffset}n.setFixedDirection=v,h(se(f,d)/se(d,p)),v([-i[0],-i[1]]);const m=E=>{n.minScaleSize=E},S=E=>{n.maxScaleSize=E};m([-1/0,-1/0]),S([1/0,1/0]);const x=et(t,e,{direction:i,set:E=>{n.startValue=E},setRatio:h,setFixedDirection:v,setMinScaleSize:m,setMaxScaleSize:S,...On(t,e),dragStart:wt.dragStart(t,new Ge().dragStart([0,0],e))}),C=j(t,"onScaleStart",x);return n.startFixedDirection=n.fixedDirection,C!==!1&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:i}),n.isScale?x:!1},dragControl(t,e){_n(t,e,"scale");const{datas:n,parentKeepRatio:r,parentFlag:s,isPinch:o,dragClient:i,isRequest:a,useSnap:c,resolveMatrix:l}=e,{prevDist:u,direction:f,startOffsetWidth:d,startOffsetHeight:p,isScale:g,startValue:h,isWidth:v,ratio:m}=n;if(!g)return!1;const S=t.props,{throttleScale:x,parentMoveable:C}=S;let E=f;!f[0]&&!f[1]&&(E=[1,1]);const D=m&&(r??S.keepRatio)||!1,R=t.state,y=[h[0],h[1]];function M(){const{distWidth:q,distHeight:$}=Di(E,D,n,e),X=d?(d+q)/d:1,nt=p?(p+$)/p:1;h[0]||(y[0]=q/d),h[1]||(y[1]=$/p);let dt=(E[0]||D?X:1)*y[0],St=(E[1]||D?nt:1)*y[1];return dt===0&&(dt=zt(u[0])*bn),St===0&&(St=zt(u[1])*bn),[dt,St]}let P=M();if(!o&&t.props.groupable){const $=(R.snapRenderInfo||{}).direction;Pt($)&&($[0]||$[1])&&(R.snapRenderInfo={direction:f,request:e.isRequest})}j(t,"onBeforeScale",et(t,e,{scale:P,setFixedDirection(q){return n.setFixedDirection(q),P=M(),P},startFixedDirection:n.startFixedDirection,setScale(q){P=q}},!0));let _=[P[0]/y[0],P[1]/y[1]],O=i,T=[0,0];const w=zt(_[0]*_[1]),k=!i&&!s&&o;if(k||l?O=Tr(t,n.targetAllTransform,[0,0],[0,0],n):i||(O=n.fixedPosition),o||(T=Al(t,_,f,!c&&a,n)),D){E[0]&&E[1]&&T[0]&&T[1]&&(Math.abs(T[0]*d)>Math.abs(T[1]*p)?T[1]=0:T[0]=0);const q=!T[0]&&!T[1];if(q&&(v?_[0]=tt(_[0]*y[0],x)/y[0]:_[1]=tt(_[1]*y[1],x)/y[1]),E[0]&&!E[1]||T[0]&&!T[1]||q&&v){_[0]+=T[0];const $=d*_[0]*y[0]/m;_[1]=zt(w*_[0])*B($/p/y[1])}else if(!E[0]&&E[1]||!T[0]&&T[1]||q&&!v){_[1]+=T[1];const $=p*_[1]*y[1]*m;_[0]=zt(w*_[1])*B($/d/y[0])}}else _[0]+=T[0],_[1]+=T[1],T[0]||(_[0]=tt(_[0]*y[0],x)/y[0]),T[1]||(_[1]=tt(_[1]*y[1],x)/y[1]);_[0]===0&&(_[0]=zt(u[0])*bn),_[1]===0&&(_[1]=zt(u[1])*bn),P=Fl(_,[y[0],y[1]]);const I=[d,p];let F=[d*P[0],p*P[1]];F=Zs(F,n.minScaleSize,n.maxScaleSize,D?m:!1),P=is(2,q=>I[q]?F[q]/I[q]:F[q]),_=is(2,q=>P[q]/y[q]);const G=is(2,q=>u[q]?_[q]/u[q]:_[q]),L=`scale(${_.join(", ")})`,z=`scale(${P.join(", ")})`,N=Tn(n,z,L),Z=!h[0]||!h[1],Y=Mc(t,Z?z:L,n.fixedDirection,O,n.fixedOffset,n,Z),W=k?Y:K(Y,n.prevInverseDist||[0,0]);if(n.prevDist=_,n.prevInverseDist=Y,P[0]===u[0]&&P[1]===u[1]&&W.every(q=>!q)&&!C&&!k)return!1;const J=et(t,e,{offsetWidth:d,offsetHeight:p,direction:f,scale:P,dist:_,delta:G,isPinch:!!o,...po(t,N,W,o,e)});return j(t,"onScale",J),J},dragControlEnd(t,e){const{datas:n}=e;if(!n.isScale)return!1;n.isScale=!1;const r=Lt(t,e,{});return j(t,"onScaleEnd",r),r},dragGroupControlCondition:Mi,dragGroupControlStart(t,e){const{datas:n}=e,r=this.dragControlStart(t,e);if(!r)return!1;const s=Kt(t,"resizable",e);n.moveableScale=t.scale;const o=oe(t,this,"dragControlStart",e,(l,u)=>An(t,l,n,u)),i=l=>{r.setFixedDirection(l),o.forEach((u,f)=>{u.setFixedDirection(l),An(t,u.moveable,n,s[f])})};n.setFixedDirection=i;const a={...r,targets:t.props.targets,events:o,setFixedDirection:i},c=j(t,"onScaleGroupStart",a);return n.isScale=c!==!1,n.isScale?a:!1},dragGroupControl(t,e){const{datas:n}=e;if(!n.isScale)return;qn(t,"onBeforeScale",u=>{j(t,"onBeforeScaleGroup",et(t,e,{...u,targets:t.props.targets},!0))});const r=this.dragControl(t,e);if(!r)return;const{dist:s}=r,o=n.moveableScale;t.scale=[s[0]*o[0],s[1]*o[1]];const i=t.props.keepRatio,a=n.fixedPosition,c=oe(t,this,"dragControl",e,(u,f)=>{const[d,p]=Ot(rn(t.rotation/180*Math.PI,3),[f.datas.originalX*s[0],f.datas.originalY*s[1],1],3);return{...f,parentDist:null,parentScale:s,parentKeepRatio:i,dragClient:ct(a,[d,p])}}),l={targets:t.props.targets,events:c,...r};return j(t,"onScaleGroup",l),l},dragGroupControlEnd(t,e){const{isDrag:n,datas:r}=e;if(!r.isScale)return;this.dragControlEnd(t,e);const s=oe(t,this,"dragControlEnd",e),o=Lt(t,e,{targets:t.props.targets,events:s});return j(t,"onScaleGroupEnd",o),n},request(){const t={};let e=0,n=0,r=!1;return{isControl:!0,requestStart(s){return r=s.useSnap,{datas:t,parentDirection:s.direction||[1,1],useSnap:r}},request(s){return e+=s.deltaWidth,n+=s.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:s.keepRatio,useSnap:r}},requestEnd(){return{datas:t,isDrag:!0,useSnap:r}}}}};function pe(t,e){return t.map((n,r)=>Rn(n,e[r],1,2))}function _i(t,e,n){const r=xt(t,e),o=xt(t,n)-r;return o>=0?o:o+2*Math.PI}function nu(t,e){const n=_i(t[0],t[1],t[2]),r=_i(e[0],e[1],e[2]),s=Math.PI;return!(n>=s&&r<=s||n<=s&&r>=s)}const Ti={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:es("warpable"),render(t,e){const{resizable:n,scalable:r,warpable:s,zoom:o}=t.props;if(n||r||!s)return[];const{pos1:i,pos2:a,pos3:c,pos4:l}=t.state,u=pe(i,a),f=pe(a,i),d=pe(i,c),p=pe(c,i),g=pe(c,l),h=pe(l,c),v=pe(a,l),m=pe(l,a);return[ot.jsx("div",{className:U("line"),style:vn(u,g,o)},"middeLine1"),ot.jsx("div",{className:U("line"),style:vn(f,h,o)},"middeLine2"),ot.jsx("div",{className:U("line"),style:vn(d,v,o)},"middeLine3"),ot.jsx("div",{className:U("line"),style:vn(p,m,o)},"middeLine4"),...Do(t,"warpable",e)]},dragControlCondition(t,e){if(e.isRequest)return!1;const n=e.inputEvent.target;return Rt(n,U("direction"))&&Rt(n,U("warpable"))},dragControlStart(t,e){const{datas:n,inputEvent:r}=e,{target:s}=t.props,{target:o}=r,i=hi(o,n);if(!i||!s)return!1;const a=t.state,{transformOrigin:c,is3d:l,targetTransform:u,targetMatrix:f,width:d,height:p,left:g,top:h}=a;n.datas={},n.targetTransform=u,n.warpTargetMatrix=l?f:Ut(f,3,4),n.targetInverseMatrix=so(Jt(n.warpTargetMatrix,4),3,4),n.direction=i,n.left=g,n.top=h,n.poses=[[0,0],[d,0],[0,p],[d,p]].map(S=>K(S,c)),n.nextPoses=n.poses.map(([S,x])=>Ot(n.warpTargetMatrix,[S,x,0,1],4)),n.startValue=ht(4),n.prevMatrix=ht(4),n.absolutePoses=Yt(a),n.posIndexes=fo(i),Se(t,e),wn(t,e,"matrix3d"),a.snapRenderInfo={request:e.isRequest,direction:i};const v=et(t,e,{set:S=>{n.startValue=S},...On(t,e)});return j(t,"onWarpStart",v)!==!1&&(n.isWarp=!0),n.isWarp},dragControl(t,e){const{datas:n,isRequest:r}=e;let{distX:s,distY:o}=e;const{targetInverseMatrix:i,prevMatrix:a,isWarp:c,startValue:l,poses:u,posIndexes:f,absolutePoses:d}=n;if(!c)return!1;if(_n(t,e,"matrix3d"),Ne(t,"warpable")){const E=f.map(y=>d[y]);E.length>1&&E.push([(E[0][0]+E[1][0])/2,(E[0][1]+E[1][1])/2]);const{horizontal:D,vertical:R}=Ln(t,r,{horizontal:E.map(y=>y[1]+o),vertical:E.map(y=>y[0]+s)});o-=D.offset,s-=R.offset}const p=Qt({datas:n,distX:s,distY:o},!0),g=n.nextPoses.slice();if(f.forEach(E=>{g[E]=ct(g[E],p)}),!Na.every(E=>nu(E.map(D=>u[D]),E.map(D=>g[D]))))return!1;const h=Rr(u[0],u[2],u[1],u[3],g[0],g[2],g[1],g[3]);if(!h.length)return!1;const v=ft(i,h,4),m=lo(n,v,!0),S=ft(Jt(a,4),m,4);n.prevMatrix=m;const x=ft(l,m,4),C=Tn(n,`matrix3d(${x.join(", ")})`,`matrix3d(${m.join(", ")})`);return _r(e,C),j(t,"onWarp",et(t,e,{delta:S,matrix:x,dist:m,multiply:ft,transform:C,...Bt({transform:C},e)})),!0},dragControlEnd(t,e){const{datas:n,isDrag:r}=e;return n.isWarp?(n.isWarp=!1,j(t,"onWarpEnd",Lt(t,e,{})),r):!1}},ru=U("area-pieces"),Zn=U("area-piece"),Oi=U("avoid"),su=U("view-dragging");function as(t){const e=t.areaElement;if(!e)return;const{width:n,height:r}=t.state;no(e,Oi),e.style.cssText+=`left: 0px; top: 0px; width: ${n}px; height: ${r}px`}function wi(t){return ot.jsxs("div",{className:ru,children:[ot.jsx("div",{className:Zn}),ot.jsx("div",{className:Zn}),ot.jsx("div",{className:Zn}),ot.jsx("div",{className:Zn})]},"area_pieces")}const Ii={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render(t,e){const{target:n,dragArea:r,groupable:s,passDragArea:o}=t.props,{width:i,height:a,renderPoses:c}=t.getState(),l=o?U("area","pass"):U("area");if(s)return[ot.jsx("div",{ref:ge(t,"areaElement"),className:l},"area"),wi()];if(!n||!r)return[];const u=Rr([0,0],[i,0],[0,a],[i,a],c[0],c[1],c[2],c[3]),f=u.length?jn(u,!0):"none";return[ot.jsx("div",{ref:ge(t,"areaElement"),className:l,style:{top:"0px",left:"0px",width:`${i}px`,height:`${a}px`,transformOrigin:"0 0",transform:f}},"area"),wi()]},dragStart(t,{datas:e,clientX:n,clientY:r,inputEvent:s}){if(!s)return!1;e.isDragArea=!1;const o=t.areaElement,i=t.state,{moveableClientRect:a,renderPoses:c,rootMatrix:l,is3d:u}=i,{left:f,top:d}=a,{left:p,top:g,width:h,height:v}=Nt(c),m=u?4:3;let[S,x]=Ve(l,[n-f,r-d],m);S-=p,x-=g;const C=[{left:p,top:g,width:h,height:x-10},{left:p,top:g,width:S-10,height:v},{left:p,top:g+x+10,width:h,height:v-x-10},{left:p+S+10,top:g,width:h-S-10,height:v}],E=[].slice.call(o.nextElementSibling.children);C.forEach((D,R)=>{E[R].style.cssText=`left: ${D.left}px;top: ${D.top}px; width: ${D.width}px; height: ${D.height}px;`}),eo(o,Oi),i.disableNativeEvent=!0},drag(t,{datas:e,inputEvent:n}){if(this.enableNativeEvent(t),!n)return!1;e.isDragArea||(e.isDragArea=!0,as(t))},dragEnd(t,e){this.enableNativeEvent(t);const{inputEvent:n,datas:r}=e;if(!n)return!1;r.isDragArea||as(t)},dragGroupStart(t,e){return this.dragStart(t,e)},dragGroup(t,e){return this.drag(t,e)},dragGroupEnd(t,e){return this.dragEnd(t,e)},unset(t){as(t),t.state.disableNativeEvent=!1},enableNativeEvent(t){const e=t.state;e.disableNativeEvent&&Us(()=>{e.disableNativeEvent=!1})}},ou=we("origin",{props:["origin","svgOrigin"],render(t,e){const{zoom:n,svgOrigin:r,groupable:s}=t.props,{beforeOrigin:o,rotation:i,svg:a,allMatrix:c,is3d:l,left:u,top:f,offsetWidth:d,offsetHeight:p}=t.getState();let g;if(!s&&a&&r){const[h,v]=os(r,d,p),S=mt(c,[h,v],l?4:3);g=Hn(i,n,K(S,[u,f]))}else g=Hn(i,n,o);return[ot.jsx("div",{className:U("control","origin"),style:g},"beforeOrigin")]}});/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var cs=function(){return cs=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},cs.apply(this,arguments)};function iu(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var o=arguments[e],i=0,a=o.length;i<a;i++,s++)r[s]=o[i];return r}var ls=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if(qt(n))for(var s in n)this.on(s,n[s]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if(qt(n))for(var s in n)this.off(s);else if(!r)this._events[n]=[];else{var o=this._events[n];if(o){var i=re(o,function(a){return a.listener===r});i>-1&&o.splice(i,1)}}return this},e.once=function(n,r){var s=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(o){s._addEvent(n,o,{once:!0})})},e.emit=function(n,r){var s=this;r===void 0&&(r={});var o=this._events[n];if(!n||!o)return!0;var i=!1;return r.eventType=n,r.stop=function(){i=!0},r.currentTarget=this,iu(o).forEach(function(a){a.listener(r),a.once&&s.off(n,a.listener)}),!i},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,s){var o=this._events;o[n]=o[n]||[];var i=o[n];i.push(cs({listener:r},s))},t}();/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var us=function(t,e){return us=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},us(t,e)};function au(t,e){us(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var He=function(){return He=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},He.apply(this,arguments)};function cu(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function Bi(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function Jn(t){if(t){if(ne(t))return document.querySelector(t)}else return null;if(hr(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var lu=function(t){au(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var s=r._currentOptions;r._lock||!s||r.emit("scrollDrag",{next:function(o){r.checkScroll({container:s.container,inputEvent:o})}})},r}var n=e.prototype;return n.dragStart=function(r,s){var o=Jn(s.container);if(!o){this._flag=!1;return}var i=0,a=0,c=0,l=0;if(o===document.body)c=window.innerWidth,l=window.innerHeight;else{var u=o.getBoundingClientRect();i=u.top,a=u.left,c=u.width,l=u.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:i,left:a,width:c,height:l},this._prevScrollPos=this._getScrollPosition([0,0],s),this._currentOptions=s,this._registerScrollEvent(s)},n.drag=function(r,s){if(clearTimeout(this._timer),!!this._flag){var o=r.clientX,i=r.clientY,a=s.threshold,c=a===void 0?0:a,l=this,u=l._startRect,f=l._startPos;this._currentOptions=s;var d=[0,0];return u.top>i-c?(f[1]>u.top||i<f[1])&&(d[1]=-1):u.top+u.height<i+c&&(f[1]<u.top+u.height||i>f[1])&&(d[1]=1),u.left>o-c?(f[0]>u.left||o<f[0])&&(d[0]=-1):u.left+u.width<o+c&&(f[0]<u.left+u.width||o>f[0])&&(d[0]=1),!d[0]&&!d[1]?!1:this._continueDrag(He(He({},s),{direction:d,inputEvent:r,isDrag:!0}))}},n.checkScroll=function(r){var s=this;if(this._isWait)return!1;var o=r.prevScrollPos,i=o===void 0?this._prevScrollPos:o,a=r.direction,c=r.throttleTime,l=c===void 0?0:c,u=r.inputEvent,f=r.isDrag,d=this._getScrollPosition(a||[0,0],r),p=d[0]-i[0],g=d[1]-i[1],h=a||[p?Math.abs(p)/p:0,g?Math.abs(g)/g:0];return this._prevScrollPos=d,this._lock=!1,!p&&!g?!1:(this.emit("move",{offsetX:h[0]?p:0,offsetY:h[1]?g:0,inputEvent:u}),l&&f&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){s._continueDrag(r)},l)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(r,s){var o=s.container,i=s.getScrollPosition,a=i===void 0?cu:i;return a({container:Jn(o),direction:r})},n._continueDrag=function(r){var s=this,o,i=r.container,a=r.direction,c=r.throttleTime,l=r.useScroll,u=r.isDrag,f=r.inputEvent;if(!(!this._flag||u&&this._isWait)){var d=en(),p=Math.max(c+this._prevTime-d,0);if(p>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){s._continueDrag(r)},p),!1;this._prevTime=d;var g=this._getScrollPosition(a,r);this._prevScrollPos=g,u&&(this._isWait=!0),l||(this._lock=!0);var h={container:Jn(i),direction:a,inputEvent:f};return(o=r.requestScroll)===null||o===void 0||o.call(r,h),this.emit("scroll",h),this._isWait=!1,l||this.checkScroll(He(He({},r),{prevScrollPos:g,direction:a,inputEvent:f}))}},n._registerScrollEvent=function(r){this._unregisterScrollEvent();var s=r.checkScrollEvent;if(s){var o=s===!0?Bi:s,i=Jn(r.container);s===!0&&(i===document.body||i===document.documentElement)?this._unregister=Bi(window,this._onScroll):this._unregister=o(i,this._onScroll)}},n._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e}(ls);function uu(t){const e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}const fu={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart(t,e){const n=t.props,{scrollContainer:r=t.getContainer(),scrollOptions:s}=n,o=new lu,i=te(r,!0);e.datas.dragScroll=o,t.state.dragScroll=o;const a=e.isControl?"controlGesto":"targetGesto",c=e.targets;o.on("scroll",({container:l,direction:u})=>{const f=et(t,e,{scrollContainer:l,direction:u}),d=c?"onScrollGroup":"onScroll";c&&(f.targets=c),j(t,d,f)}).on("move",({offsetX:l,offsetY:u,inputEvent:f})=>{t[a].scrollBy(l,u,f.inputEvent,!1)}).on("scrollDrag",({next:l})=>{l(t[a].getCurrentEvent())}),o.dragStart(e,{container:i,...s})},checkScroll(t,e){const n=e.datas.dragScroll;if(!n)return;const{scrollContainer:r=t.getContainer(),scrollThreshold:s=0,scrollThrottleTime:o=0,getScrollPosition:i=uu,scrollOptions:a}=t.props;return n.drag(e,{container:r,threshold:s,throttleTime:o,getScrollPosition:c=>i({scrollContainer:c.container,direction:c.direction}),...a}),!0},drag(t,e){return this.checkScroll(t,e)},dragEnd(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart(t,e){return this.dragStart(t,{...e,isControl:!0})},dragControl(t,e){return this.drag(t,e)},dragControlEnd(t,e){return this.dragEnd(t,e)},dragGroupStart(t,e){return this.dragStart(t,{...e,targets:t.props.targets})},dragGroup(t,e){return this.drag(t,{...e,targets:t.props.targets})},dragGroupEnd(t,e){return this.dragEnd(t,{...e,targets:t.props.targets})},dragGroupControlStart(t,e){return this.dragStart(t,{...e,targets:t.props.targets,isControl:!0})},dragGroupControl(t,e){return this.drag(t,{...e,targets:t.props.targets})},dragGroupControEnd(t,e){return this.dragEnd(t,{...e,targets:t.props.targets})},unset(t){var n;const e=t.state;(n=e.dragScroll)==null||n.dragEnd(),e.dragScroll=null}},zi={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},du=we("padding",{props:["padding"],render(t,e){const n=t.props;if(n.dragArea)return[];const{left:r,top:s,right:o,bottom:i}=yi(n.padding||{}),{renderPoses:a,pos1:c,pos2:l,pos3:u,pos4:f}=t.getState(),d=[c,l,u,f],p=[];return r>0&&p.push([0,2]),s>0&&p.push([0,1]),o>0&&p.push([1,3]),i>0&&p.push([2,3]),p.map(([g,h],v)=>{const m=d[g],S=d[h],x=a[g],C=a[h],E=Rr([0,0],[100,0],[0,100],[100,100],m,S,x,C);if(E.length)return ot.jsx("div",{className:U("padding"),style:{transform:jn(E,!0)}},`padding${v}`)})}}),Ai=["nw","ne","se","sw"];function Qn(t,e){const n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}const pu=[1,2,5,6],gu=[0,3,4,7],ye=[1,-1,-1,1],Re=[1,1,-1,-1];function fs(t,e,n,r,s=0,o=0,i=n,a=r){const c=[];let l=!1;const u=t.filter(d=>!d.virtual),f=u.map(d=>{const{horizontal:p,vertical:g,pos:h}=d;if(g&&!l&&(l=!0,c.push("/")),l){const v=Math.max(0,g===1?h[1]-o:a-h[1]);return c.push(Zt(v,r,e)),v}else{const v=Math.max(0,p===1?h[0]-s:i-h[0]);return c.push(Zt(v,n,e)),v}});return{radiusPoses:u,styles:c,raws:f}}function Gi(t){const e=[0,0],n=[0,0],r=t.length;for(let s=0;s<r;++s){const o=t[s];o.sub&&(o.horizontal&&(e[1]===0&&(e[0]=s),e[1]=s-e[0]+1,n[0]=s+1),o.vertical&&(n[1]===0&&(n[0]=s),n[1]=s-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function hu(t,e,n,r,s,o=[0,0],i=!1){const a=t.indexOf("/"),c=(a>-1?t.slice(0,a):t).length,l=t.slice(0,c),u=t.slice(c+1),f=l.length,d=u.length,p=d>0,[g="0px",h=g,v=g,m=h]=l,[S=g,x=p?S:h,C=p?S:v,E=p?x:m]=u,D=[g,h,v,m].map(O=>ut(O,e)),R=[S,x,C,E].map(O=>ut(O,n)),y=D.slice(),M=R.slice();[y[0],y[1]]=Qn([y[0],y[1]],e),[y[3],y[2]]=Qn([y[3],y[2]],e),[M[0],M[3]]=Qn([M[0],M[3]],n),[M[1],M[2]]=Qn([M[1],M[2]],n);const P=i?y:y.slice(0,Math.max(o[0],f)),_=i?M:M.slice(0,Math.max(o[1],d));return[...P.map((O,T)=>{const w=Ai[T];return{virtual:T>=f,horizontal:ye[T],vertical:0,pos:[r+O,s+(Re[T]===-1?n:0)],sub:!0,raw:D[T],direction:w}}),..._.map((O,T)=>{const w=Ai[T];return{virtual:T>=d,horizontal:0,vertical:Re[T],pos:[r+(ye[T]===-1?e:0),s+O],sub:!0,raw:R[T],direction:w}})]}function vu(t,e,n,r,s=e.length){const{horizontalRange:o,verticalRange:i}=Gi(t.slice(r)),a=n-r;let c=0;if(a===0)c=s;else if(a>0&&a<o[1])c=o[1]-a;else if(a>=i[0])c=i[0]+i[1]-a;else return;t.splice(n,c),e.splice(n,c)}function mu(t,e,n,r,s,o,i,a,c,l=0,u=0){const{horizontalRange:f,verticalRange:d}=Gi(t.slice(n));if(r>-1){const p=ye[r]===1?o-l:a-o;for(let g=f[1];g<=r;++g){const h=Re[g]===1?u:c;let v=0;if(r===g?v=o:g===0?v=l+p:ye[g]===-1&&(v=a-(e[n][0]-l)),t.splice(n+g,0,{horizontal:ye[g],vertical:0,pos:[v,h]}),e.splice(n+g,0,[v,h]),g===0)break}}else if(s>-1){const p=Re[s]===1?i-u:c-i;if(f[1]===0&&d[1]===0){const h=[l+p,u];t.push({horizontal:ye[0],vertical:0,pos:h}),e.push(h)}const g=d[0];for(let h=d[1];h<=s;++h){const v=ye[h]===1?l:a;let m=0;if(s===h?m=i:h===0?m=u+p:Re[h]===1?m=e[n+g][1]:Re[h]===-1&&(m=c-(e[n+g][1]-u)),t.push({horizontal:0,vertical:Re[h],pos:[v,m]}),e.push([v,m]),h===0)break}}}function xu(t,e=t.map(n=>n.raw)){const n=t.map((s,o)=>s.horizontal?e[o]:null).filter(s=>s!=null),r=t.map((s,o)=>s.vertical?e[o]:null).filter(s=>s!=null);return{horizontals:n,verticals:r}}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Su(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var o=arguments[e],i=0,a=o.length;i<a;i++,s++)r[s]=o[i];return r}function kt(t){return tt(t,Ct)}function Eu(t,e){return t.every(function(n,r){return kt(n-e[r])===0})}function Cu(t,e){return!kt(t[0]-e[0])&&!kt(t[1]-e[1])}function ki(t){return t.length<3?0:Math.abs(rc(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function Fi(t,e){var n=e.width,r=e.height,s=e.left,o=e.top,i=Me(t),a=i.minX,c=i.minY,l=i.maxX,u=i.maxY,f=n/(l-a),d=r/(u-c);return t.map(function(p){return[s+(p[0]-a)*f,o+(p[1]-c)*d]})}function Me(t){var e=t.map(function(r){return r[0]}),n=t.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function ds(t,e,n){var r=t[0],s=t[1],o=Me(e),i=o.minX,a=o.maxX,c=[[i,s],[a,s]],l=tr(c[0],c[1]),u=gs(e),f=[];if(u.forEach(function(g){var h=tr(g[0],g[1]),v=g[0];if(Eu(l,h))f.push({pos:t,line:g,type:"line"});else{var m=$i(ps(l,h),[c,g]);m.forEach(function(S){g.some(function(x){return Cu(x,S)})?f.push({pos:S,line:g,type:"point"}):kt(v[1]-s)!==0&&f.push({pos:S,line:g,type:"intersection"})})}}),$t(f,function(g){return g[0]===r}))return!0;var d=0,p={};return f.forEach(function(g){var h=g.pos,v=g.type,m=g.line;if(!(h[0]>r))if(v==="intersection")++d;else{if(v==="line")return;if(v==="point"){var S=$t(m,function(E){return E[1]!==s}),x=p[h[0]],C=S[1]>s?1:-1;x?x!==C&&++d:p[h[0]]=C}}}),d%2===1}function tr(t,e){var n=t[0],r=t[1],s=e[0],o=e[1],i=s-n,a=o-r;Math.abs(i)<Ct&&(i=0),Math.abs(a)<Ct&&(a=0);var c=0,l=0,u=0;return i?a?(c=-a/i,l=1,u=-c*n-r):(l=1,u=-r):a&&(c=-1,u=n),[c,l,u]}function ps(t,e){var n=t[0],r=t[1],s=t[2],o=e[0],i=e[1],a=e[2],c=n===0&&o===0,l=r===0&&i===0,u=[];if(c&&l)return[];if(c){var f=-s/r,d=-a/i;return f!==d?[]:[[-1/0,f],[1/0,f]]}else if(l){var p=-s/n,g=-a/o;return p!==g?[]:[[p,-1/0],[p,1/0]]}else if(n===0){var h=-s/r,v=-(i*h+a)/o;u=[[v,h]]}else if(o===0){var h=-a/i,v=-(r*h+s)/n;u=[[v,h]]}else if(r===0){var v=-s/n,h=-(o*v+a)/i;u=[[v,h]]}else if(i===0){var v=-a/o,h=-(n*v+s)/r;u=[[v,h]]}else{var v=(r*a-i*s)/(i*n-r*o),h=-(n*v+s)/r;u=[[v,h]]}return u.map(function(m){return[m[0],m[1]]})}function $i(t,e){var n=e.map(function(f){return[0,1].map(function(d){return[Math.min(f[0][d],f[1][d]),Math.max(f[0][d],f[1][d])]})}),r=[];if(t.length===2){var s=t[0],o=s[0],i=s[1];if(kt(o-t[1][0])){if(!kt(i-t[1][1])){var l=Math.max.apply(Math,n.map(function(f){return f[0][0]})),u=Math.min.apply(Math,n.map(function(f){return f[0][1]}));if(kt(l-u)>0)return[];r=[[l,i],[u,i]]}}else{var a=Math.max.apply(Math,n.map(function(f){return f[1][0]})),c=Math.min.apply(Math,n.map(function(f){return f[1][1]}));if(kt(a-c)>0)return[];r=[[o,a],[o,c]]}}return r.length||(r=t.filter(function(f){var d=f[0],p=f[1];return n.every(function(g){return 0<=kt(d-g[0][0])&&0<=kt(g[0][1]-d)&&0<=kt(p-g[1][0])&&0<=kt(g[1][1]-p)})})),r.map(function(f){return[kt(f[0]),kt(f[1])]})}function gs(t){return Su(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function Du(t,e){var n=t.slice(),r=e.slice();Js(n)===-1&&n.reverse(),Js(r)===-1&&r.reverse();var s=gs(n),o=gs(r),i=s.map(function(u){return tr(u[0],u[1])}),a=o.map(function(u){return tr(u[0],u[1])}),c=[];i.forEach(function(u,f){var d=s[f],p=[];a.forEach(function(g,h){var v=ps(u,g),m=$i(v,[d,o[h]]);p.push.apply(p,m.map(function(S){return{index1:f,index2:h,pos:S,type:"intersection"}}))}),p.sort(function(g,h){return se(d[0],g.pos)-se(d[0],h.pos)}),c.push.apply(c,p),ds(d[1],r)&&c.push({index1:f,index2:-1,pos:d[1],type:"inside"})}),o.forEach(function(u,f){if(ds(u[1],n)){var d=!1,p=re(c,function(g){var h=g.index2;return h===f?(d=!0,!1):!!d});p===-1&&(d=!1,p=re(c,function(g){var h=g.index1,v=g.index2;return h===-1&&v+1===f?(d=!0,!1):!!d})),p===-1?c.push({index1:-1,index2:f,pos:u[1],type:"inside"}):c.splice(p,0,{index1:-1,index2:f,pos:u[1],type:"inside"})}});var l={};return c.filter(function(u){var f=u.pos,d=f[0]+"x"+f[1];return l[d]?!1:(l[d]=!0,!0)})}function bu(t,e){var n=Du(t,e);return n.map(function(r){var s=r.pos;return s})}function yu(t,e){var n=bu(t,e);return ki(n)}const Ru=[[0,-1,"n"],[1,0,"e"]],Mu=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function hs(t,e,n){const{clipRelative:r}=t.props,{width:s,height:o}=t.state,{type:i,poses:a}=e,c=i==="rect",l=i==="circle";if(i==="polygon")return n.map(u=>`${Zt(u[0],s,r)} ${Zt(u[1],o,r)}`);if(c||i==="inset"){const u=n[1][1],f=n[3][0],d=n[7][0],p=n[5][1];if(c)return[u,f,p,d].map(h=>`${h}px`);const g=[u,s-f,o-p,d].map((h,v)=>Zt(h,v%2?s:o,r));if(n.length>8){const[h,v]=K(n[4],n[0]);g.push("round",...fs(a.slice(8).map((m,S)=>({...m,pos:n[S]})),r,h,v,d,u,f,p).styles)}return g}else if(l||i==="ellipse"){const u=n[0],f=Zt(B(n[1][1]-u[1]),l?Math.sqrt((s*s+o*o)/2):o,r),d=l?[f]:[Zt(B(n[2][0]-u[0]),s,r),f];return d.push("at",Zt(u[0],s,r),Zt(u[1],o,r)),d}}function er(t,e,n,r){const s=[r,(r+e)/2,e],o=[t,(t+n)/2,n];return Mu.map(([i,a,c])=>{const l=s[i+1],u=o[a+1];return{vertical:B(a),horizontal:B(i),direction:c,pos:[l,u]}})}function Li(t){const e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(({pos:r})=>{e[0]=Math.min(e[0],r[0]),e[1]=Math.max(e[1],r[0]),n[0]=Math.min(n[0],r[1]),n[1]=Math.max(n[1],r[1])}),[B(e[1]-e[0]),B(n[1]-n[0])]}function Ni(t,e,n,r,s){if(!t)return;let o=s;if(!o){const u=Gt(t),f=u("clipPath");o=f!=="none"?f:u("clip")}if((!o||o==="none"||o==="auto")&&(o=r,!o))return;const{prefix:i=o,value:a=""}=qs(o),c=i==="circle";let l=" ";if(i==="polygon"){const u=he(a||"0% 0%, 100% 0%, 100% 100%, 0% 100%");l=",";const f=u.map(p=>{const[g,h]=p.split(" ");return{vertical:1,horizontal:1,pos:[ut(g,e),ut(h,n)]}}),d=Me(f.map(p=>p.pos));return{type:i,clipText:o,poses:f,splitter:l,left:d.minX,right:d.maxX,top:d.minY,bottom:d.maxY}}else if(c||i==="ellipse"){let u="",f="",d=0,p=0;const g=ie(a);if(c){let m="";[m="50%",,u="50%",f="50%"]=g,d=ut(m,Math.sqrt((e*e+n*n)/2)),p=d}else{let m="",S="";[m="50%",S="50%",,u="50%",f="50%"]=g,d=ut(m,e),p=ut(S,n)}const h=[ut(u,e),ut(f,n)],v=[{vertical:1,horizontal:1,pos:h,direction:"nesw"},...Ru.slice(0,c?1:2).map(m=>({vertical:B(m[1]),horizontal:m[0],direction:m[2],sub:!0,pos:[h[0]+m[0]*d,h[1]+m[1]*p]}))];return{type:i,clipText:o,radiusX:d,radiusY:p,left:h[0]-d,top:h[1]-p,right:h[0]+d,bottom:h[1]+p,poses:v,splitter:l}}else if(i==="inset"){const u=ie(a||"0 0 0 0 round 0px"),f=u.indexOf("round"),d=(f>-1?u.slice(0,f):u).length,p=u.slice(d+1),[g,h=g,v=g,m=h]=u.slice(0,d),[S,x]=[g,v].map(M=>ut(M,n)),[C,E]=[m,h].map(M=>ut(M,e)),D=e-E,R=n-x,y=[...er(S,D,R,C)];return{type:"inset",clipText:o,poses:y,top:S,left:C,right:D,bottom:R,radius:p,splitter:l}}else if(i==="rect"){const u=he(a||`0px, ${e}px, ${n}px, 0px`);l=",";const[f,d,p,g]=u.map(v=>{const{value:m}=tn(v);return m}),h=er(f,d,p,g);return{type:"rect",clipText:o,poses:h,top:f,right:d,bottom:p,left:g,values:u,splitter:l}}}function Pu(t,e,n,r,s){const{direction:o,sub:i}=t[e],a=t.map(()=>[0,0]),c=o?o.split(""):[];if(r&&e<8){const l=c.filter(v=>v==="w"||v==="e"),u=c.filter(v=>v==="n"||v==="s"),f=l[0],d=u[0];a[e]=n;const[p,g]=Li(t),h=p&&g?p/g:0;if(h&&s){const v=(e+4)%8,m=t[v].pos,S=[0,0];o.indexOf("w")>-1?S[0]=-1:o.indexOf("e")>-1&&(S[0]=1),o.indexOf("n")>-1?S[1]=-1:o.indexOf("s")>-1&&(S[1]=1);const x=Ci([p,g],n,h,S,!0),C=p+x[0],E=g+x[1];let D=m[1],R=m[1],y=m[0],M=m[0];S[0]===-1?y=M-C:S[0]===1?M=y+C:(y=y-C/2,M=M+C/2),S[1]===-1?D=R-E:(S[1]===1||(D=R-E/2),R=D+E);const P=er(D,M,R,y);t.forEach((_,O)=>{a[O][0]=P[O].pos[0]-_.pos[0],a[O][1]=P[O].pos[1]-_.pos[1]})}else t.forEach((v,m)=>{const{direction:S}=v;S&&(S.indexOf(f)>-1&&(a[m][0]=n[0]),S.indexOf(d)>-1&&(a[m][1]=n[1]))}),f&&(a[1][0]=n[0]/2,a[5][0]=n[0]/2),d&&(a[3][1]=n[1]/2,a[7][1]=n[1]/2)}else o&&!i?c.forEach(l=>{const u=l==="n"||l==="s";t.forEach((f,d)=>{const{direction:p,horizontal:g,vertical:h}=f;!p||p.indexOf(l)===-1||(a[d]=[u||!g?0:n[0],!u||!h?0:n[1]])})}):a[e]=n;return a}function _u(t,e){const[n,r]=co(t,e),{clipPath:s,clipIndex:o}=e.datas,{type:i,poses:a,splitter:c}=s,l=a.map(d=>d.pos);if(i==="polygon")l.splice(o,0,[n,r]);else if(i==="inset"){const d=pu.indexOf(o),p=gu.indexOf(o),g=a.length;if(mu(a,l,8,d,p,n,r,l[4][0],l[4][1],l[0][0],l[0][1]),g===a.length)return}else return;const u=hs(t,s,l),f=`${i}(${u.join(c)})`;j(t,"onClip",et(t,e,{clipEventType:"added",clipType:i,poses:l,clipStyles:u,clipStyle:f,distX:0,distY:0,...Bt({clipPath:f},e)}))}function Tu(t,e){const{clipPath:n,clipIndex:r}=e.datas,{type:s,poses:o,splitter:i}=n,a=o.map(f=>f.pos),c=a.length;if(s==="polygon")o.splice(r,1),a.splice(r,1);else if(s==="inset"){if(r<8||(vu(o,a,r,8,c),c===o.length))return}else return;const l=hs(t,n,a),u=`${s}(${l.join(i)})`;j(t,"onClip",et(t,e,{clipEventType:"removed",clipType:s,poses:a,clipStyles:l,clipStyle:u,distX:0,distY:0,...Bt({clipPath:u},e)}))}const Wi={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: red;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render(t,e){const{customClipPath:n,defaultClipPath:r,clipArea:s,zoom:o,groupable:i}=t.props,{target:a,width:c,height:l,allMatrix:u,is3d:f,left:d,top:p,pos1:g,pos2:h,pos3:v,pos4:m,clipPathState:S,snapBoundInfos:x,rotation:C}=t.getState();if(!a||i)return[];const E=Ni(a,c,l,r||"inset",S||n);if(!E)return[];const D=f?4:3,R=E.type,M=E.poses.map(I=>{const F=mt(u,I.pos,D);return[F[0]-d,F[1]-p]});let P=[],_=[];const O=R==="rect",T=R==="inset",w=R==="polygon";if(O||T||w){const I=T?M.slice(0,8):M;_=I.map((F,G)=>{const L=G===0?I[I.length-1]:I[G-1],z=xt(L,F),N=ui(L,F);return ot.jsx("div",{className:U("line","clip-line","snap-control"),"data-clip-index":G,style:{width:`${N}px`,transform:`translate(${L[0]}px, ${L[1]}px) rotate(${z}rad) scaleY(${o})`}},`clipLine${G}`)})}const k=["nw","n","ne","e","se","s","sw","w"];if(P=M.map((I,F)=>{const G=k[F];return ot.jsx("div",{className:U("control","clip-control","snap-control",`clip-${G}`),"data-clip-index":F,style:{transform:`translate(${I[0]}px, ${I[1]}px) rotate(${C}rad) scale(${o})`,backgroundColor:"green"}},`clipControl${F}`)}),T&&P.push(...M.slice(8).map((I,F)=>ot.jsx("div",{className:U("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+F,style:{transform:`translate(${I[0]}px, ${I[1]}px) rotate(${C}rad) scale(${o})`}},`clipRadiusControl${F}`))),R==="circle"||R==="ellipse"){const{left:I,top:F,radiusX:G,radiusY:L}=E,[z,N]=K(mt(u,[I,F],D),mt(u,[0,0],D));let Z="none";if(!s){const Y=Math.max(10,G/5,L/5),W=[];for(let J=0;J<=Y;++J){const q=Math.PI*2/Y*J;W.push([G+(G-o)*Math.cos(q),L+(L-o)*Math.sin(q)])}W.push([G,-2]),W.push([-2,-2]),W.push([-2,L*2+2]),W.push([G*2+2,L*2+2]),W.push([G*2+2,-2]),W.push([G,-2]),Z=`polygon(${W.map(J=>`${J[0]}px ${J[1]}px`).join(", ")})`}P.push(ot.jsx("div",{className:U("clip-ellipse","snap-control"),style:{width:`${G*2}px`,height:`${L*2}px`,clipPath:Z,transform:`translate(${-d+z}px, ${-p+N}px) ${jn(u)}`}},"clipEllipse"))}if(s){const{width:I,height:F,left:G,top:L}=Nt([g,h,v,m,...M]);if(w||O||T){const z=T?M.slice(0,8):M;P.push(ot.jsx("div",{className:U("clip-area","snap-control"),style:{width:`${I}px`,height:`${F}px`,transform:`translate(${G}px, ${L}px)`,clipPath:`polygon(${z.map(N=>`${N[0]-G}px ${N[1]-L}px`).join(", ")})`}},"clipArea"))}}return x&&["vertical","horizontal"].forEach(I=>{const F=x[I],G=I==="horizontal";F.isSnap&&_.push(...F.snap.posInfos.map(({pos:L},z)=>{const N=K(mt(u,G?[0,L]:[L,0],D),[d,p]),Z=K(mt(u,G?[c,L]:[L,l],D),[d,p]);return fn(e,"",N,Z,o,`clip${I}snap${z}`,"guideline")})),F.isBound&&_.push(...F.bounds.map(({pos:L},z)=>{const N=K(mt(u,G?[0,L]:[L,0],D),[d,p]),Z=K(mt(u,G?[c,L]:[L,l],D),[d,p]);return fn(e,"",N,Z,o,`clip${I}bounds${z}`,"guideline","bounds","bold")}))}),[...P,..._]},dragControlCondition(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart(t,e){const n=t.props,{dragWithClip:r=!0}=n;return r?!1:this.dragControlStart(t,e)},drag(t,e){return this.dragControl(t,{...e,isDragTarget:!0})},dragEnd(t,e){return this.dragControlEnd(t,e)},dragControlStart(t,e){const n=t.state,{defaultClipPath:r,customClipPath:s}=t.props,{target:o,width:i,height:a}=n,c=e.inputEvent?e.inputEvent.target:null,l=c&&c.getAttribute("class")||"",u=e.datas,f=Ni(o,i,a,r||"inset",s);if(!f)return!1;const{clipText:d,type:p,poses:g}=f;return j(t,"onClipStart",et(t,e,{clipType:p,clipStyle:d,poses:g.map(v=>v.pos)}))===!1?(u.isClipStart=!1,!1):(u.isControl=l&&l.indexOf("clip-control")>-1,u.isLine=l.indexOf("clip-line")>-1,u.isArea=l.indexOf("clip-area")>-1||l.indexOf("clip-ellipse")>-1,u.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,u.clipPath=f,u.isClipStart=!0,n.clipPathState=d,Se(t,e),!0)},dragControl(t,e){const{datas:n,originalDatas:r,isDragTarget:s}=e;if(!n.isClipStart)return!1;const{isControl:o,isLine:i,isArea:a,clipIndex:c,clipPath:l}=n;if(!l)return!1;const u=be(t.props,"clippable"),{keepRatio:f}=u;let d=0,p=0;const g=r.draggable,h=Qt(e);s&&g?[d,p]=g.prevBeforeDist:[d,p]=h;const v=[d,p],m=t.state,{width:S,height:x}=m,C=!a&&!o&&!i,{type:E,poses:D,splitter:R}=l,y=D.map($=>$.pos);C&&(d=-d,p=-p);const M=!o||D[c].direction==="nesw",P=E==="inset"||E==="rect";let _=D.map(()=>[0,0]),O=u.defaultClipPath==="inset"?!1:f;if(o&&!M){const{horizontal:$,vertical:X}=D[c],nt=[d*B($),p*B(X)];_=Pu(D,c,nt,P,O)}else M&&(_=y.map(()=>[d,p]));const T=y.map(($,X)=>ct($,_[X])),w=[...T];m.snapBoundInfos=null;const k=l.type==="circle",I=l.type==="ellipse";if(k||I){const $=Nt(T),X=B($.bottom-$.top),nt=B(I?$.right-$.left:X),dt=T[0][1]+X,St=T[0][0]-nt,st=T[0][0]+nt;k&&(w.push([st,$.bottom]),_.push([1,0])),w.push([$.left,dt]),_.push([0,1]),w.push([St,$.bottom]),_.push([1,0])}const F=Qo((u.clipHorizontalGuidelines||[]).map($=>ut(`${$}`,x)),(u.clipVerticalGuidelines||[]).map($=>ut(`${$}`,S)),S,x);let G=[],L=[];if(k||I)G=[w[4][0],w[2][0]],L=[w[1][1],w[3][1]];else if(P){const $=[w[0],w[2],w[4],w[6]],X=[_[0],_[2],_[4],_[6]];G=$.filter((nt,dt)=>X[dt][0]).map(nt=>nt[0]),L=$.filter((nt,dt)=>X[dt][1]).map(nt=>nt[1])}else G=w.filter(($,X)=>_[X][0]).map($=>$[0]),L=w.filter(($,X)=>_[X][1]).map($=>$[1]);const z=[0,0],{horizontal:N,vertical:Z}=Lo(F,u.clipTargetBounds&&{left:0,top:0,right:S,bottom:x},G,L,5,5);let Y=N.offset,W=Z.offset;if(N.isBound&&(z[1]+=Y),Z.isBound&&(z[0]+=W),(I||k)&&_[0][0]===0&&_[0][1]===0){const $=Nt(T);let X=$.bottom-$.top,nt=I?$.right-$.left:X;const dt=Z.isBound?B(W):Z.snapIndex===0?-W:W,St=N.isBound?B(Y):N.snapIndex===0?-Y:Y;nt-=dt,X-=St,k&&(X=zo(Z,N)>0?X:nt,nt=X);const st=w[0];w[1][1]=st[1]-X,w[2][0]=st[0]+nt,w[3][1]=st[1]+X,w[4][0]=st[0]-nt}else if(P&&O&&o){const[$,X]=Li(D),nt=$&&X?$/X:0,St=D[c].direction||"";let st=w[1][1],jt=w[5][1],Ht=w[7][0],pt=w[3][0];B(Y)<=B(W)?Y=zt(Y)*B(W)/nt:W=zt(W)*B(Y)*nt,St.indexOf("w")>-1?Ht-=W:St.indexOf("e")>-1?pt-=W:(Ht+=W/2,pt-=W/2),St.indexOf("n")>-1?st-=Y:St.indexOf("s")>-1?jt-=Y:(st+=Y/2,jt-=Y/2);const bt=er(st,pt,jt,Ht);w.forEach((ee,_e)=>{[ee[0],ee[1]]=bt[_e].pos})}else w.forEach(($,X)=>{const nt=_[X];nt[0]&&($[0]-=W),nt[1]&&($[1]-=Y)});const J=hs(t,l,T),q=`${E}(${J.join(R)} ${l.radius.length?"round "+l.radius.join(" "):""})`;if(m.clipPathState=q,k||I)G=[w[4][0],w[2][0]],L=[w[1][1],w[3][1]];else if(P){const $=[w[0],w[2],w[4],w[6]];G=$.map(X=>X[0]),L=$.map(X=>X[1])}else G=w.map($=>$[0]),L=w.map($=>$[1]);if(m.snapBoundInfos=Lo(F,u.clipTargetBounds&&{left:0,top:0,right:S,bottom:x},G,L,1,1),g){const{is3d:$,allMatrix:X}=m,nt=$?4:3;let dt=z;s&&(dt=[v[0]+z[0]-h[0],v[1]+z[1]-h[1]]),g.deltaOffset=ft(X,[dt[0],dt[1],0,0],nt)}return j(t,"onClip",et(t,e,{clipEventType:"changed",clipType:E,poses:T,clipStyle:q,clipStyles:J,distX:d,distY:p,...Bt({[E==="rect"?"clip":"clipPath"]:q},e)})),!0},dragControlEnd(t,e){this.unset(t);const{isDrag:n,datas:r,isDouble:s}=e,{isLine:o,isClipStart:i,isControl:a}=r;return i?(j(t,"onClipEnd",Lt(t,e,{})),s&&(a?(console.log("removeClipPath"),Tu(t,e)):o&&(console.log("addClipPath"),_u(t,e))),s||n):!1},unset(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Ou={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition(t,e){return e.isRequest?e.requestAble==="originDraggable":Rt(e.inputEvent.target,U("origin"))},dragControlStart(t,e){const{datas:n}=e;Se(t,e);const r=et(t,e,{dragStart:wt.dragStart(t,new Ge().dragStart([0,0],e))}),s=j(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,s===!1?(n.isDragOrigin=!1,!1):r},dragControl(t,e){const{datas:n,isPinch:r,isRequest:s}=e;if(!n.isDragOrigin)return!1;const[o,i]=Qt(e),a=t.state,{width:c,height:l,offsetMatrix:u,targetMatrix:f,is3d:d}=a,{originRelative:p=!0}=t.props,g=d?4:3;let h=[o,i];if(s){const P=e.distOrigin;(P[0]||P[1])&&(h=P)}const v=ct(n.startOrigin,h),m=ct(n.startTargetOrigin,h),S=K(h,n.prevOrigin),x=cn(u,f,v,g),C=t.getRect(),E=Nt(De(x,c,l,g)),D=[C.left-E.left,C.top-E.top];n.prevOrigin=h;const R=[Zt(m[0],c,p),Zt(m[1],l,p)].join(" "),y=wt.drag(t,an(e,t.state,D,!!r)),M=et(t,e,{width:c,height:l,origin:v,dist:h,delta:S,transformOrigin:R,drag:y,...Bt({transformOrigin:R,transform:y.transform},e),afterTransform:y.transform});return j(t,"onDragOrigin",M),M},dragControlEnd(t,e){const{datas:n}=e;return n.isDragOrigin?(j(t,"onDragOriginEnd",Lt(t,e,{})),!0):!1},dragGroupControlCondition(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart(t,e){return!!this.dragControlStart(t,e)},dragGroupControl(t,e){const n=this.dragControl(t,e);return n?(t.transformOrigin=n.transformOrigin,!0):!1},request(t){const e={},n=t.getRect();let r=0,s=0;const o=n.transformOrigin,i=[0,0];return{isControl:!0,requestStart(){return{datas:e}},request(a){return"deltaOrigin"in a?(i[0]+=a.deltaOrigin[0],i[1]+=a.deltaOrigin[1]):"origin"in a?(i[0]=a.origin[0]-o[0],i[1]=a.origin[1]-o[1]):("x"in a?r=a.x-n.left:"deltaX"in a&&(r+=a.deltaX),"y"in a?s=a.y-n.top:"deltaY"in a&&(s+=a.deltaY)),{datas:e,distX:r,distY:s,distOrigin:i}},requestEnd(){return{datas:e,isDrag:!0}}}}};function wu(t,e,n,r){const s=t.filter(({virtual:c,horizontal:l})=>l&&!c).length,o=t.filter(({virtual:c,vertical:l})=>l&&!c).length;let i=-1;if(e===0&&(s===0?i=0:s===1&&(i=1)),e===2&&(s<=2?i=2:s<=3&&(i=3)),e===3&&(o===0?i=4:o<4&&(i=7)),e===1&&(o<=1?i=5:o<=2&&(i=6)),i===-1||!t[i].virtual)return;const a=t[i];Iu(t,i),i<4?a.pos[0]=n:a.pos[1]=r}function Iu(t,e){e<4?t.slice(0,e+1).forEach(n=>{n.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(n=>{n.virtual=!1}))}function Bu(t,e){e<4?t.slice(e,4).forEach(n=>{n.virtual=!0}):t.slice(e).forEach(n=>{n.virtual=!0})}function Yi(t,e,n,r=[0,0],s){let o=[];return!t||t==="0px"?o=[]:o=ie(t),hu(o,e,n,0,0,r,s)}function Vi(t,e,n,r,s){const o=t.state,{width:i,height:a}=o,{raws:c,styles:l,radiusPoses:u}=fs(s,t.props.roundRelative,i,a),{horizontals:f,verticals:d}=xu(u,c),p=l.join(" ");o.borderRadiusState=p;const g=et(t,e,{horizontals:f,verticals:d,borderRadius:p,width:i,height:a,delta:r,dist:n,...Bt({borderRadius:p},e)});return j(t,"onRound",g),g}function ji(t){var r;const{style:e}=t.getState();let n=e.borderRadius||"";if(!n&&t.props.groupable){const s=t.moveables[0],o=t.getTargets()[0];o&&((s==null?void 0:s.props.target)===o?(n=((r=t.moveables[0])==null?void 0:r.state.style.borderRadius)??"",e.borderRadius=n):(n=Qr(o).borderRadius,e.borderRadius=n))}return n}const Hi={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className(t){const e=t.props.roundClickable;return e===!0||e==="line"?U("round-line-clickable"):""},requestStyle(){return["borderRadius"]},requestChildStyle(){return["borderRadius"]},render(t,e){const{target:n,width:r,height:s,allMatrix:o,is3d:i,left:a,top:c,borderRadiusState:l}=t.getState(),{minRoundControls:u=[0,0],maxRoundControls:f=[4,4],zoom:d,roundPadding:p=0,isDisplayShadowRoundControls:g,groupable:h}=t.props;if(!n)return null;const v=l||ji(t),m=i?4:3,S=Yi(v,r,s,u,!0);if(!S)return null;let x=0,C=0;const E=h?[0,0]:[a,c];return S.map((D,R)=>{const y=D.horizontal,M=D.vertical,P=D.direction||"",_=[...D.pos];C+=Math.abs(y),x+=Math.abs(M),y&&P.indexOf("n")>-1&&(_[1]-=p),M&&P.indexOf("w")>-1&&(_[0]-=p),y&&P.indexOf("s")>-1&&(_[1]+=p),M&&P.indexOf("e")>-1&&(_[0]+=p);const O=K(mt(o,_,m),E),T=g&&g!=="horizontal",w=D.vertical?x<=f[1]&&(T||!D.virtual):C<=f[0]&&(g||!D.virtual);return ot.jsx("div",{className:U("control","border-radius",D.vertical?"vertical":"",D.virtual?"virtual":""),"data-radius-index":R,style:{display:w?"block":"none",transform:`translate(${O[0]}px, ${O[1]}px) scale(${d})`}},`borderRadiusControl${R}`)})},dragControlCondition(t,e){if(!e.inputEvent||e.isRequest)return!1;const n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition(t,e){return this.dragControlCondition(t,e)},dragControlStart(t,e){const{inputEvent:n,datas:r}=e,s=n.target,o=s.getAttribute("class")||"",i=o.indexOf("border-radius")>-1,a=o.indexOf("moveable-line")>-1&&o.indexOf("moveable-direction")>-1,c=i?parseInt(s.getAttribute("data-radius-index"),10):-1;let l=-1;if(a){const x=s.getAttribute("data-line-key")||"";x&&(l=parseInt(x.replace(/render-line-/g,""),10),isNaN(l)&&(l=-1))}if(!i&&!a)return!1;const u=et(t,e,{});if(j(t,"onRoundStart",u)===!1)return!1;r.lineIndex=l,r.controlIndex=c,r.isControl=i,r.isLine=a,Se(t,e);const{roundRelative:d,minRoundControls:p=[0,0]}=t.props,g=t.state,{width:h,height:v}=g;r.isRound=!0,r.prevDist=[0,0];const m=ji(t),S=Yi(m||"",h,v,p,!0)||[];return r.controlPoses=S,g.borderRadiusState=fs(S,d,h,v).styles.join(" "),u},dragControl(t,e){const{datas:n}=e,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;const s=n.controlIndex,[o,i]=Qt(e),a=[o,i],c=K(a,n.prevDist),{maxRoundControls:l=[4,4]}=t.props,{width:u,height:f}=t.state,d=r[s],p=d.vertical,g=d.horizontal,h=r.map(m=>{const{horizontal:S,vertical:x}=m,C=[S*g*a[0],x*p*a[1]];if(S){if(l[0]===1)return C;if(l[0]<4&&S!==g)return C}else{if(l[1]===0)return C[1]=x*g*a[0]/u*f,C;if(p){if(l[1]===1)return C;if(l[1]<4&&x!==p)return C}}return[0,0]});h[s]=a;const v=r.map((m,S)=>({...m,pos:ct(m.pos,h[S])}));return s<4?v.slice(0,s+1).forEach(m=>{m.virtual=!1}):v.slice(4,s+1).forEach(m=>{m.virtual=!1}),n.prevDist=[o,i],Vi(t,e,a,c,v)},dragControlEnd(t,e){const n=t.state;n.borderRadiusState="";const{datas:r,isDouble:s}=e;if(!r.isRound)return!1;const{isControl:o,controlIndex:i,isLine:a,lineIndex:c}=r,l=r.controlPoses,u=l.filter(({virtual:p})=>p).length,{roundClickable:f=!0}=t.props;if(s&&f){if(o&&(f===!0||f==="control"))Bu(l,i);else if(a&&(f===!0||f==="line")){const[p,g]=co(t,e);wu(l,c,p,g)}u!==l.filter(({virtual:p})=>p).length&&Vi(t,e,[0,0],[0,0],l)}const d=Lt(t,e,{});return j(t,"onRoundEnd",d),n.borderRadiusState="",d},dragGroupControlStart(t,e){const n=this.dragControlStart(t,e);if(!n)return!1;const r=t.moveables,s=t.props.targets,o=Kt(t,"roundable",e),i={targets:t.props.targets,events:o.map((a,c)=>({...a,target:s[c],moveable:r[c],currentTarget:r[c]})),...n};return j(t,"onRoundGroupStart",i),n},dragGroupControl(t,e){const n=this.dragControl(t,e);if(!n)return!1;const r=t.moveables,s=t.props.targets,o=Kt(t,"roundable",e),i={targets:t.props.targets,events:o.map((a,c)=>({...a,target:s[c],moveable:r[c],currentTarget:r[c],...Bt({borderRadius:n.borderRadius},a)})),...n};return j(t,"onRoundGroup",i),i},dragGroupControlEnd(t,e){const n=t.moveables,r=t.props.targets,s=Kt(t,"roundable",e);qn(t,"onRound",a=>{const c={targets:t.props.targets,events:s.map((l,u)=>({...l,target:r[u],moveable:n[u],currentTarget:n[u],...Bt({borderRadius:a.borderRadius},l)})),...a};j(t,"onRoundGroup",c)});const o=this.dragControlEnd(t,e);if(!o)return!1;const i={targets:t.props.targets,events:s.map((a,c)=>{var l;return{...a,target:r[c],moveable:n[c],currentTarget:n[c],lastEvent:(l=a.datas)==null?void 0:l.lastEvent}}),...o};return j(t,"onRoundGroupEnd",i),i},unset(t){t.state.borderRadiusState=""}};/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var vs=function(t,e){return vs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},vs(t,e)};function zu(t,e){vs(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Dt=function(){return Dt=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Dt.apply(this,arguments)};function Au(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=Math.atan2(r,n);return s>=0?s:s+Math.PI*2}function ms(t){return Au([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function Gu(t){return t.touches&&t.touches.length>=2}function nr(t){return t?t.touches?Fu(t.touches):[qi(t)]:[]}function ku(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function Xi(t,e,n){var r=n.length,s=xn(t,r),o=s.clientX,i=s.clientY,a=s.originalClientX,c=s.originalClientY,l=xn(e,r),u=l.clientX,f=l.clientY,d=xn(n,r),p=d.clientX,g=d.clientY,h=o-u,v=i-f,m=o-p,S=i-g;return{clientX:a,clientY:c,deltaX:h,deltaY:v,distX:m,distY:S}}function xs(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Fu(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(qi(t[r]));return n}function qi(t){return{clientX:t.clientX,clientY:t.clientY}}function xn(t,e){e===void 0&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),s=0;s<r;++s){var o=t[s];n.originalClientX+="originalClientX"in o?o.originalClientX:o.clientX,n.originalClientY+="originalClientY"in o?o.originalClientY:o.clientY,n.clientX+=o.clientX,n.clientY+=o.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var Ss=function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),ms(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),ms(e)-ms(this.startClients)},t.prototype.getPosition=function(e,n){e===void 0&&(e=this.prevClients);var r=Xi(e||this.prevClients,this.prevClients,this.startClients),s=r.deltaX,o=r.deltaY;return this.movement+=Math.sqrt(s*s+o*o),this.prevClients=e,r},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var n=this.prevClients,r=this.startClients,s=Math.min(this.length,n.length),o=[],i=0;i<s;++i)o[i]=Xi([e[i]],[n[i]],[r[i]]);return o},t.prototype.getMovement=function(e){var n=this.movement;if(!e)return n;var r=xn(e,this.length),s=xn(this.prevClients,this.length),o=r.clientX-s.clientX,i=r.clientY-s.clientY;return Math.sqrt(o*o+i*i)+n},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),xs(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),xs(e)/xs(this.startClients)},t.prototype.move=function(e,n){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=n}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=n})},t}(),Ui=["textarea","input"],$u=function(t){zu(e,t);function e(n,r){r===void 0&&(r={});var s=t.call(this)||this;s.options={},s.flag=!1,s.pinchFlag=!1,s.data={},s.isDrag=!1,s.isPinch=!1,s.clientStores=[],s.targets=[],s.prevTime=0,s.doubleFlag=!1,s._useMouse=!1,s._useTouch=!1,s._useDrag=!1,s._dragFlag=!1,s._isTrusted=!1,s._isMouseEvent=!1,s._isSecondaryButton=!1,s._preventMouseEvent=!1,s._prevInputEvent=null,s._isDragAPI=!1,s._isIdle=!0,s._preventMouseEventId=0,s._window=window,s.onDragStart=function(d,p){if(p===void 0&&(p=!0),!(!s.flag&&d.cancelable===!1)){var g=d.type.indexOf("drag")>=-1;if(!(s.flag&&g)){s._isDragAPI=!0;var h=s.options,v=h.container,m=h.pinchOutside,S=h.preventWheelClick,x=h.preventRightClick,C=h.preventDefault,E=h.checkInput,D=h.dragFocusedInput,R=h.preventClickEventOnDragStart,y=h.preventClickEventOnDrag,M=h.preventClickEventByCondition,P=s._useTouch,_=!s.flag;if(s._isSecondaryButton=d.which===3||d.button===2,S&&(d.which===2||d.button===1)||x&&(d.which===3||d.button===2))return s.stop(),!1;if(_){var O=s._window.document.activeElement,T=d.target;if(T){var w=T.tagName.toLowerCase(),k=Ui.indexOf(w)>-1,I=T.isContentEditable;if(k||I){if(E||!D&&O===T)return!1;if(O&&(O===T||I&&O.isContentEditable&&O.contains(T)))if(D)T.blur();else return!1}else if((C||d.type==="touchstart")&&O){var F=O.tagName.toLowerCase();(O.isContentEditable||Ui.indexOf(F)>-1)&&O.blur()}(R||y||M)&&Tt(s._window,"click",s._onClick,!0)}s.clientStores=[new Ss(nr(d))],s._isIdle=!1,s.flag=!0,s.isDrag=!1,s._isTrusted=p,s._dragFlag=!0,s._prevInputEvent=d,s.data={},s.doubleFlag=en()-s.prevTime<200,s._isMouseEvent=ku(d),!s._isMouseEvent&&s._preventMouseEvent&&s._allowMouseEvent();var G=s._preventMouseEvent||s.emit("dragStart",Dt(Dt({data:s.data,datas:s.data,inputEvent:d,isMouseEvent:s._isMouseEvent,isSecondaryButton:s._isSecondaryButton,isTrusted:p,isDouble:s.doubleFlag},s.getCurrentStore().getPosition()),{preventDefault:function(){d.preventDefault()},preventDrag:function(){s._dragFlag=!1}}));G===!1&&s.stop(),s._isMouseEvent&&s.flag&&C&&d.preventDefault()}if(!s.flag)return!1;var L=0;if(_?(s._attchDragEvent(),P&&m&&(L=setTimeout(function(){Tt(v,"touchstart",s.onDragStart,{passive:!1})}))):P&&m&&_t(v,"touchstart",s.onDragStart),s.flag&&Gu(d)){if(clearTimeout(L),_&&d.touches.length!==d.changedTouches.length)return;s.pinchFlag||s.onPinchStart(d)}}}},s.onDrag=function(d,p){if(s.flag){var g=s.options.preventDefault;!s._isMouseEvent&&g&&d.preventDefault(),s._prevInputEvent=d;var h=nr(d),v=s.moveClients(h,d,!1);if(s._dragFlag){if(s.pinchFlag||v.deltaX||v.deltaY){var m=s._preventMouseEvent||s.emit("drag",Dt(Dt({},v),{isScroll:!!p,inputEvent:d}));if(m===!1){s.stop();return}}s.pinchFlag&&s.onPinch(d,h)}s.getCurrentStore().getPosition(h,!0)}},s.onDragEnd=function(d){if(s.flag){var p=s.options,g=p.pinchOutside,h=p.container,v=p.preventClickEventOnDrag,m=p.preventClickEventOnDragStart,S=p.preventClickEventByCondition,x=s.isDrag;(v||m||S)&&requestAnimationFrame(function(){s._allowClickEvent()}),!S&&!m&&v&&!x&&s._allowClickEvent(),s._useTouch&&g&&_t(h,"touchstart",s.onDragStart),s.pinchFlag&&s.onPinchEnd(d);var C=d!=null&&d.touches?nr(d):[],E=C.length;E===0||!s.options.keepDragging?s.flag=!1:s._addStore(new Ss(C));var D=s._getPosition(),R=en(),y=!x&&s.doubleFlag;s._prevInputEvent=null,s.prevTime=x||y?0:R,s.flag||(s._dettachDragEvent(),s._preventMouseEvent||s.emit("dragEnd",Dt({data:s.data,datas:s.data,isDouble:y,isDrag:x,isClick:!x,isMouseEvent:s._isMouseEvent,isSecondaryButton:s._isSecondaryButton,inputEvent:d,isTrusted:s._isTrusted},D)),s.clientStores=[],s._isMouseEvent||(s._preventMouseEvent=!0,clearTimeout(s._preventMouseEventId),s._preventMouseEventId=setTimeout(function(){s._preventMouseEvent=!1},200)),s._isIdle=!0)}},s.onBlur=function(){s.onDragEnd()},s._allowClickEvent=function(){_t(s._window,"click",s._onClick,!0)},s._onClick=function(d){s._allowClickEvent(),s._allowMouseEvent();var p=s.options.preventClickEventByCondition;p!=null&&p(d)||(d.stopPropagation(),d.preventDefault())},s._onContextMenu=function(d){var p=s.options;p.preventRightClick?s.onDragEnd(d):d.preventDefault()},s._passCallback=function(){};var o=[].concat(n),i=o[0];s._window=ro(i)?i:ce(i),s.options=Dt({checkInput:!1,container:i&&!("document"in i)?ce(i):i,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var a=s.options,c=a.container,l=a.events,u=a.checkWindowBlur;if(s._useDrag=l.indexOf("drag")>-1,s._useTouch=l.indexOf("touch")>-1,s._useMouse=l.indexOf("mouse")>-1,s.targets=o,s._useDrag&&o.forEach(function(d){Tt(d,"dragstart",s.onDragStart)}),s._useMouse&&(o.forEach(function(d){Tt(d,"mousedown",s.onDragStart),Tt(d,"mousemove",s._passCallback)}),Tt(c,"contextmenu",s._onContextMenu)),u&&Tt(ce(),"blur",s.onBlur),s._useTouch){var f={passive:!1};o.forEach(function(d){Tt(d,"touchstart",s.onDragStart,f),Tt(d,"touchmove",s._passCallback,f)})}return s}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(r,s){return r+s.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(n,r,s,o){o===void 0&&(o=!0),this.flag&&(this.clientStores[0].move(n,r),o&&this.onDrag(s,!0))},e.prototype.move=function(n,r){var s=n[0],o=n[1],i=this.getCurrentStore(),a=i.prevClients;return this.moveClients(a.map(function(c){var l=c.clientX,u=c.clientY;return{clientX:l+s,clientY:u+o,originalClientX:l,originalClientY:u}}),r,!0)},e.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},e.prototype.setEventData=function(n){var r=this.data;for(var s in n)r[s]=n[s];return this},e.prototype.setEventDatas=function(n){return this.setEventData(n)},e.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),Dt(Dt({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var n=this,r=this.targets,s=this.options.container;this.off(),_t(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(o){_t(o,"dragstart",n.onDragStart)}),this._useMouse&&(r.forEach(function(o){_t(o,"mousedown",n.onDragStart)}),_t(s,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(o){_t(o,"touchstart",n.onDragStart)}),_t(s,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(n){var r=this,s=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>s)){var o=new Ss(nr(n));this.pinchFlag=!0,this._addStore(o);var i=this.emit("pinchStart",Dt(Dt({data:this.data,datas:this.data,angle:o.getAngle(),touches:this.getCurrentStore().getPositions()},o.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));i===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(n,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var s=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Dt(Dt({data:this.data,datas:this.data,movement:this.getMovement(r),angle:s.getAngle(r),rotation:s.getRotation(r),touches:s.getPositions(r),scale:s.getScale(r),distance:s.getDistance(r)},s.getPosition(r)),{inputEvent:n,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(n){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var s=this.getCurrentStore();this.emit("pinchEnd",Dt(Dt({data:this.data,datas:this.data,isPinch:r,touches:s.getPositions()},s.getPosition()),{inputEvent:n}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(n,r,s){var o=this._getPosition(n,s),i=this.isDrag;(o.deltaX||o.deltaY)&&(this.isDrag=!0);var a=!1;return!i&&this.isDrag&&(a=!0),Dt(Dt({data:this.data,datas:this.data},o),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:a})},e.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},e.prototype._getPosition=function(n,r){var s=this.getCurrentStore(),o=s.getPosition(n,r),i=this.clientStores.slice(1).reduce(function(l,u){var f=u.getPosition();return l.distX+=f.distX,l.distY+=f.distY,l},o),a=i.distX,c=i.distY;return Dt(Dt({},o),{distX:a,distY:c})},e.prototype._attchDragEvent=function(){var n=this._window,r=this.options.container,s={passive:!1};this._isDragAPI&&(Tt(r,"dragover",this.onDrag,s),Tt(n,"dragend",this.onDragEnd)),this._useMouse&&(Tt(r,"mousemove",this.onDrag),Tt(n,"mouseup",this.onDragEnd)),this._useTouch&&(Tt(r,"touchmove",this.onDrag,s),Tt(n,"touchend",this.onDragEnd,s),Tt(n,"touchcancel",this.onDragEnd,s))},e.prototype._dettachDragEvent=function(){var n=this._window,r=this.options.container;this._isDragAPI&&(_t(r,"dragover",this.onDrag),_t(n,"dragend",this.onDragEnd)),this._useMouse&&(_t(r,"mousemove",this.onDrag),_t(n,"mouseup",this.onDragEnd)),this._useTouch&&(_t(r,"touchstart",this.onDragStart),_t(r,"touchmove",this.onDrag),_t(n,"touchend",this.onDragEnd),_t(n,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e}(ls);function Lu(t,e){const r=ht(e?4:3),s=`matrix${e?"3d":""}(${r.join(",")})`;return t===s||t==="matrix(1,0,0,1,0,0)"}const Ki={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform(t,e){const{is3d:n,targetMatrix:r,inlineTransform:s}=t.state,o=n?`matrix3d(${r.join(",")})`:`matrix(${io(r,!0)})`,i=!s||s==="none"?o:s;e.datas.startTransforms=Lu(i,n)?[]:ie(i)},resetStyle(t){const e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams(t,e){return et(t,e,{setTransform:n=>{e.datas.startTransforms=Pt(n)?n:ie(n)},isPinch:!!e.isPinch})},fillDragParams(t,e){return et(t,e,{isPinch:!!e.isPinch})},dragStart(t,e){this.setTransform(t,e),this.resetStyle(e),j(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),j(t,"onBeforeRender",et(t,e,{isPinch:!!e.isPinch}))},dragEnd(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),j(t,"onBeforeRenderEnd",et(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart(t,e){this.dragStart(t,e);const n=Kt(t,"beforeRenderable",e),r=t.moveables,s=n.map((o,i)=>{const a=r[i];return this.setTransform(a,o),this.resetStyle(o),this.fillDragStartParams(a,o)});j(t,"onBeforeRenderGroupStart",et(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform(){},events:s}))},dragGroup(t,e){this.drag(t,e);const n=Kt(t,"beforeRenderable",e),r=t.moveables,s=n.map((o,i)=>{const a=r[i];return this.resetStyle(o),this.fillDragParams(a,o)});j(t,"onBeforeRenderGroup",et(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:s}))},dragGroupEnd(t,e){this.dragEnd(t,e),j(t,"onBeforeRenderGroupEnd",et(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart(t,e){return this.dragStart(t,e)},dragControl(t,e){return this.drag(t,e)},dragControlEnd(t,e){return this.dragEnd(t,e)},dragGroupControlStart(t,e){return this.dragGroupStart(t,e)},dragGroupControl(t,e){return this.dragGroup(t,e)},dragGroupControlEnd(t,e){return this.dragGroupEnd(t,e)}},Zi={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart(t,e){j(t,"onRenderStart",et(t,e,{isPinch:!!e.isPinch}))},drag(t,e){j(t,"onRender",this.fillDragParams(t,e))},dragAfter(t,e){return this.drag(t,e)},dragEnd(t,e){j(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart(t,e){j(t,"onRenderGroupStart",et(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup(t,e){const n=Kt(t,"beforeRenderable",e),r=t.moveables,s=n.map((o,i)=>{const a=r[i];return this.fillDragParams(a,o)});j(t,"onRenderGroup",et(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,transform:Bn(e),transformObject:{},...Bt(zn(e)),events:s}))},dragGroupEnd(t,e){const n=Kt(t,"beforeRenderable",e),r=t.moveables,s=n.map((o,i)=>{const a=r[i];return this.fillDragEndParams(a,o)});j(t,"onRenderGroupEnd",et(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:s,transformObject:{},transform:Bn(e),...Bt(zn(e))}))},dragControlStart(t,e){return this.dragStart(t,e)},dragControl(t,e){return this.drag(t,e)},dragControlAfter(t,e){return this.dragAfter(t,e)},dragControlEnd(t,e){return this.dragEnd(t,e)},dragGroupControlStart(t,e){return this.dragGroupStart(t,e)},dragGroupControl(t,e){return this.dragGroup(t,e)},dragGroupControlEnd(t,e){return this.dragGroupEnd(t,e)},fillDragParams(t,e){const n={};return Ae(In(e)||[]).forEach(r=>{n[r.name]=r.functionValue}),et(t,e,{isPinch:!!e.isPinch,transformObject:n,transform:Bn(e),...Bt(zn(e))})},fillDragEndParams(t,e){const n={};return Ae(In(e)||[]).forEach(r=>{n[r.name]=r.functionValue}),et(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:Bn(e),...Bt(zn(e))})}};function Sn(t,e,n,r,s,o,i){o.clientDistX=o.distX,o.clientDistY=o.distY;const a=s==="Start",c=s==="End",l=s==="After",u=t.state.target,f=o.isRequest,d=r.indexOf("Control")>-1;if(!u||a&&d&&!f&&t.areaElement===o.inputEvent.target)return!1;const p=[...e];if(f){const P=o.requestAble;p.some(_=>_.name===P)||p.push(...t.props.ables.filter(_=>_.name===P))}if(!p.length||p.every(P=>P.dragRelation))return!1;const g=o.inputEvent;let h;c&&g&&(h=document.elementFromPoint(o.clientX,o.clientY)||g.target);let v=!1;const m=()=>{var P;v=!0,(P=o.stop)==null||P.call(o)},S=a&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());S&&t.updateRect(s,!0,!1);const x=o.datas,C=d?"controlGesto":"targetGesto",E=t[C],D=(P,_,O)=>{if(!(_ in P)||E!==t[C])return!1;const T=P.name,w=x[T]||(x[T]={});if(a&&(w.isEventStart=!O||!P[O]||P[O](t,o)),!w.isEventStart)return!1;const k=P[_](t,{...o,stop:m,datas:w,originalDatas:x,inputTarget:h});return t._emitter.off(),a&&k===!1&&(w.isEventStart=!1),k};S&&p.forEach(P=>{P.unset&&P.unset(t)}),D(Ki,`drag${r}${s}`);let R=0,y=0;n.forEach(P=>{if(v)return!1;const _=`${P}${r}${s}`,O=`${P}${r}Condition`;s===""&&!f&&Zl(t.state,o);let T=p.filter(I=>I[_]);T=T.filter((I,F)=>I.name&&T.indexOf(I)===F);const k=T.filter(I=>D(I,_,O)).length;v&&++R,k&&++y,!v&&a&&T.length&&!k&&(R+=T.filter(I=>{const F=I.name;return x[F].isEventStart?I.dragRelation!=="strong":!1}).length?1:0)}),(!l||y)&&D(Zi,`drag${r}${s}`);const M=E!==t[C]||R===n.length;return(c||v||M)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(P=>{P.state.gestos={}}),p.forEach(P=>{P.unset&&P.unset(t)})),a&&!M&&!f&&y&&t.props.preventDefault&&(o==null||o.preventDefault()),t.isUnmounted||M?!1:((!a&&y&&!i||c)&&(t.props.flushSync||ii)(()=>{t.updateRect(c?s:"",!0,!1),t.forceUpdate()}),!a&&!c&&!l&&y&&!i&&Sn(t,e,n,r,s+"After",o),!0)}function Es(t,e){return(n,r=n.inputEvent.target)=>{var a;const s=r,o=t.areaElement,i=t._dragTarget;return!i||!e&&((a=t.controlGesto)!=null&&a.isFlag())?!1:s===i||i.contains(s)||s===o||!t.isMoveableElement(s)&&!t.controlBox.contains(s)||Rt(s,"moveable-area")||Rt(s,"moveable-padding")||Rt(s,"moveable-edgeDraggable")}}function Ji(t,e,n){const r=t.controlBox,s=[],o=t.props,i=o.dragArea,a=t.state.target,c=o.dragTarget;s.push(r),(!i||c)&&s.push(e),!i&&c&&a&&e!==a&&o.dragTargetSelf&&s.push(a);const l=Es(t);return ta(t,s,"targetAbles",n,{dragStart:l,pinchStart:l})}function Qi(t,e){const n=t.controlBox,r=[];r.push(n);const s=Es(t,!0),o=(i,a=i.inputEvent.target)=>a===n?!0:!s(i,a);return ta(t,r,"controlAbles",e,{dragStart:o,pinchStart:o})}function ta(t,e,n,r,s={}){const o=n==="targetAbles",{pinchOutside:i,pinchThreshold:a,preventClickEventOnDrag:c,preventClickDefault:l,checkInput:u,dragFocusedInput:f,preventDefault:d=!0,preventRightClick:p=!0,preventWheelClick:g=!0,dragContainer:h}=t.props,v=te(h,!0),m={preventDefault:d,preventRightClick:p,preventWheelClick:g,container:v||ce(t.getControlBoxElement()),pinchThreshold:a,pinchOutside:i,preventClickEventOnDrag:o?c:!1,preventClickEventOnDragStart:o?l:!1,preventClickEventByCondition:o?null:C=>t.controlBox.contains(C.target),checkInput:o?u:!1,dragFocusedInput:f},S=new $u(e,m),x=r==="Control";return["drag","pinch"].forEach(C=>{["Start","","End"].forEach(E=>{S.on(`${C}${E}`,D=>{var O;const R=D.eventType,y=C==="drag"&&D.isPinch;if(s[R]&&!s[R](D)){D.stop();return}if(y)return;const M=C==="drag"?[C]:["drag",C],P=[...t[n]];Sn(t,P,M,r,E,D)?(t.props.stopPropagation||E==="Start"&&x)&&((O=D==null?void 0:D.inputEvent)==null||O.stopPropagation()):D.stop()})})}),S}class Nu{constructor(e,n,r){H(this,"ables",[]);H(this,"_onEvent",e=>{const n=this.eventName,r=this.moveable;r.state.disableNativeEvent||this.ables.forEach(s=>{s[n](r,{inputEvent:e})})});this.target=e,this.moveable=n,this.eventName=r,e.addEventListener(r.toLowerCase(),this._onEvent)}setAbles(e){this.ables=e}destroy(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null}}function Wu(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return e>>>0}var Yu=Wu;function Vu(t){return Yu(t).toString(36)}function ju(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function Hu(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,s){var o=s.trim();return(o?he(o):[""]).map(function(i){var a=i.trim();return a.indexOf("@")===0?a:a.indexOf(":global")>-1?a.replace(/\:global/g,""):a.indexOf(":host")>-1?"".concat(a.replace(/\:host/g,".".concat(t))):a?".".concat(t," ").concat(a):".".concat(t)}).join(", ")+" {"})}function Xu(t,e,n,r,s){var o=Er(r),i=o.createElement("style");return i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",t),i.setAttribute("data-styled-count","1"),n.nonce&&i.setAttribute("nonce",n.nonce),i.innerHTML=Hu(t,e,n),(s||o.head||o.body).appendChild(i),i}function qu(t){var e="rCS"+Vu(t);return{className:e,inject:function(n,r){r===void 0&&(r={});var s=ju(n),o=(s||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!o)o=Xu(e,t,r,n,s);else{var i=parseFloat(o.getAttribute("data-styled-count"))||0;o.setAttribute("data-styled-count","".concat(i+1))}return{destroy:function(){var a,c=parseFloat(o.getAttribute("data-styled-count"))||0;c<=1?(o.remove?o.remove():(a=o.parentNode)===null||a===void 0||a.removeChild(o),o=null):o.setAttribute("data-styled-count","".concat(c-1))}}}}}var Cs=function(){return Cs=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Cs.apply(this,arguments)};function Uu(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function ea(t,e){var n=qu(e),r=n.className;return vt.forwardRef(function(s,o){var i=s.className,a=i===void 0?"":i;s.cspNonce;var c=Uu(s,["className","cspNonce"]),l=vt.useRef();return vt.useImperativeHandle(o,function(){return l.current},[]),vt.useEffect(function(){var u=n.inject(l.current,{nonce:s.cspNonce});return function(){u.destroy()}},[]),vt.createElement(t,Cs({ref:l,"data-styled-id":r,className:"".concat(a," ").concat(r)},c))})}function Ku(t,e,n=e,r){var I;const{matrixes:s,is3d:o,targetMatrix:i,transformOrigin:a,targetOrigin:c,offsetContainer:l,hasFixed:u,zoom:f}=ho(t,e),{matrixes:d,is3d:p,offsetContainer:g,zoom:h}=Gc(l,n),v=r,m=4,S=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t;let x=i,C=ht(m),E=ht(m),D=ht(m),R=ht(m);const y=s.length,M=d.map(F=>({...F,matrix:F.matrix?[...F.matrix]:void 0})).reverse();s.reverse(),!o&&v&&(x=Ut(x,3,4),qr(s)),!p&&v&&qr(M),M.forEach(F=>{E=ft(E,F.matrix,m)});const P=n||ae(t),_=((I=M[0])==null?void 0:I.target)||hn(P,P,!0).offsetParent,O=M.slice(1).reduce((F,G)=>ft(F,G.matrix,m),ht(m));s.forEach((F,G)=>{if(y-2===G&&(D=C.slice()),y-1===G&&(R=C.slice()),!F.matrix){const L=s[G+1],z=Xl(F,L,_,m,ft(O,C,m));F.matrix=me(z,m)}C=ft(C,F.matrix,m)});const T=!S&&o;x||(x=ht(T?4:3));const w=jn(S&&x.length===16?Ut(x,4,3):x,T),k=E;return E=so(E,m,m),{hasZoom:f!==1||h!==1,hasFixed:u,matrixes:s,rootMatrix:E,originalRootMatrix:k,beforeMatrix:D,offsetMatrix:R,allMatrix:C,targetMatrix:x,targetTransform:w,inlineTransform:t.style.transform,transformOrigin:a,targetOrigin:c,is3d:v,offsetContainer:l,offsetRootContainer:g}}function na(t,e,n=e,r){let s=0,o=0,i=0,a={};const c=fi(t);if(t&&(s=c.offsetWidth,o=c.offsetHeight),t){const u=Ku(t,e,n,r),f=xe(u.allMatrix,u.transformOrigin,s,o);a={...u,...f};const d=xe(u.allMatrix,[50,50],100,100);i=di([d.pos1,d.pos2],d.direction)}const l=4;return{hasZoom:!1,width:s,height:o,rotation:i,...c,originalRootMatrix:ht(l),rootMatrix:ht(l),beforeMatrix:ht(l),offsetMatrix:ht(l),allMatrix:ht(l),targetMatrix:ht(l),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[],...a}}function Zu(t,e,n=e){return na(t,e,n,!0)}function Ds(t,e,n,r,s,o=[]){let i=1,a=[0,0],c=Xn(),l=Xn(),u=Xn(),f=Xn(),d=[0,0];const p={},g=na(e,n,s,!0);if(e){const h=Gt(e);o.forEach(x=>{p[x]=h(x)});const v=g.is3d?4:3,m=xe(g.offsetMatrix,ct(g.transformOrigin,oo(g.targetMatrix,v)),g.width,g.height);i=m.direction,a=ct(m.origin,[m.left-g.left,m.top-g.top]),f=mn(g.offsetRootContainer);const S=hn(r,r,!0).offsetParent||g.offsetRootContainer;if(g.hasZoom){const x=xe(ft(g.originalRootMatrix,g.allMatrix),g.transformOrigin,g.width,g.height),C=xe(g.originalRootMatrix,Vn(Gt(S)("transformOrigin")).map(E=>parseFloat(E)),S.offsetWidth,S.offsetHeight);if(c=Kr(x,f),u=Kr(C,f,S,!0),t){const E=x.left,D=x.top;l=Kr({left:E,top:D,bottom:D,right:D},f)}}else{c=mn(e),u=Ac(S),t&&(l=mn(t));const{left:x,top:C,clientLeft:E,clientTop:D}=u,R=[c.left-x,c.top-C];d=K(Ve(g.rootMatrix,R,4),[E+g.left,D+g.top])}}return{targetClientRect:c,containerClientRect:u,moveableClientRect:l,rootContainerClientRect:f,beforeDirection:i,beforeOrigin:a,originalBeforeOrigin:a,target:e,style:p,offsetDelta:d,...g}}function ra(t){let{pos1:e,pos2:n,pos3:r,pos4:s}=t;if(!e||!n||!r||!s)return null;const o=Me([e,n,r,s]),i=[o.minX,o.minY],a=K(t.origin,i);return e=K(e,i),n=K(n,i),r=K(r,i),s=K(s,i),{...t,left:t.left,top:t.top,posDelta:i,pos1:e,pos2:n,pos3:r,pos4:s,origin:a,beforeOrigin:a,isPersisted:!0}}class Pe extends Os.PureComponent{constructor(){super(...arguments);H(this,"state",{container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0],...Ds(null)});H(this,"renderState",{});H(this,"enabledAbles",[]);H(this,"targetAbles",[]);H(this,"controlAbles",[]);H(this,"controlBox");H(this,"areaElement");H(this,"targetGesto");H(this,"controlGesto");H(this,"rotation",0);H(this,"scale",[1,1]);H(this,"isMoveableMounted",!1);H(this,"isUnmounted",!1);H(this,"events",{mouseEnter:null,mouseLeave:null});H(this,"_emitter",new ls);H(this,"_prevOriginalDragTarget",null);H(this,"_originalDragTarget",null);H(this,"_prevDragTarget",null);H(this,"_dragTarget",null);H(this,"_prevPropTarget",null);H(this,"_propTarget",null);H(this,"_prevDragArea",!1);H(this,"_isPropTargetChanged",!1);H(this,"_hasFirstTarget",!1);H(this,"_reiszeObserver",null);H(this,"_observerId",0);H(this,"_mutationObserver",null);H(this,"_rootContainer",null);H(this,"_viewContainer",null);H(this,"_viewClassNames",[]);H(this,"_store",{});H(this,"checkUpdateRect",()=>{if(this.isDragging())return;const n=this.props.parentMoveable;if(n){n.checkUpdateRect();return}nc(this._observerId),this._observerId=Us(()=>{this.isDragging()||this.updateRect()})});H(this,"_onPreventClick",n=>{n.stopPropagation(),n.preventDefault()})}render(){const n=this.props,r=this.getState(),{parentPosition:s,className:o,target:i,zoom:a,cspNonce:c,translateZ:l,cssStyled:u,groupable:f,linePadding:d,controlPadding:p}=n;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();const[g,h]=s||[0,0],{left:v,top:m,target:S,direction:x,hasFixed:C,offsetDelta:E}=r,D=n.targets,R=this.isDragging(),y={};this.getEnabledAbles().forEach(w=>{y[`data-able-${w.name.toLowerCase()}`]=!0});const M=this._getAbleClassName(),P=D&&D.length&&(S||f)||i||!this._hasFirstTarget&&this.state.isPersisted,_=this.controlBox||this.props.firstRenderState||this.props.persistData,O=[v-g,m-h];!f&&n.useAccuratePosition&&(O[0]+=E[0],O[1]+=E[1]);const T={position:C?"fixed":"absolute",display:P?"block":"none",visibility:_?"visible":"hidden",transform:`translate3d(${O[0]}px, ${O[1]}px, ${l})`,"--zoom":a,"--zoompx":`${a}px`};return d&&(T["--moveable-line-padding"]=d),p&&(T["--moveable-control-padding"]=p),ot.jsxs(u,{cspNonce:c,ref:ge(this,"controlBox"),className:`${U("control-box",x===-1?"reverse":"",R?"dragging":"")} ${M} ${o}`,...y,onClick:this._onPreventClick,style:T,children:[this.renderAbles(),this._renderLines()]})}componentDidMount(){this.isMoveableMounted=!0,this.isUnmounted=!1;const n=this.props,{parentMoveable:r,container:s}=n;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!s&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())}componentDidUpdate(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(n)}componentWillUnmount(){var s,o;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(s=this._reiszeObserver)==null||s.disconnect(),(o=this._mutationObserver)==null||o.disconnect(),this._viewContainer&&this._changeAbleViewClassNames([]),We(this,!1),We(this,!0);const r=this.events;for(const i in r){const a=r[i];a&&a.destroy()}}getTargets(){const n=this.props.target;return n?[n]:[]}getAble(n){const r=this.props.ables||[];return $t(r,s=>s.name===n)}getContainer(){const{parentMoveable:n,wrapperMoveable:r,container:s}=this.props;return s||r&&r.getContainer()||n&&n.getContainer()||this.controlBox.parentElement}getControlBoxElement(){return this.controlBox}getDragElement(){return this._dragTarget}isMoveableElement(n){var r;return n&&(((r=n.getAttribute)==null?void 0:r.call(n,"class"))||"").indexOf(lr)>-1}dragStart(n,r=n.target){const s=this.targetGesto,o=this.controlGesto;return s&&Es(this)({inputEvent:n},r)?s.isFlag()||s.triggerDragStart(n):o&&this.isMoveableElement(r)&&(o.isFlag()||o.triggerDragStart(n)),this}hitTest(n){const{target:r,pos1:s,pos2:o,pos3:i,pos4:a,targetClientRect:c}=this.state;if(!r)return 0;let l;if(Dr(n)){const m=n.getBoundingClientRect();l={left:m.left,top:m.top,width:m.width,height:m.height}}else l={width:0,height:0,...n};const{left:u,top:f,width:d,height:p}=l,g=Fi([s,o,a,i],c),h=yu(g,[[u,f],[u+d,f],[u+d,f+p],[u,f+p]]),v=ki(g);return!h||!v?0:Math.min(100,h/v*100)}isInside(n,r){const{target:s,pos1:o,pos2:i,pos3:a,pos4:c,targetClientRect:l}=this.state;return s?ds([n,r],Fi([o,i,c,a],l)):!1}updateRect(n,r,s=!0){const o=this.props,i=!o.parentPosition&&!o.wrapperMoveable;i&&$e(!0);const a=o.parentMoveable,l=this.state.target||o.target,u=this.getContainer(),f=a?a._rootContainer:this._rootContainer,d=Ds(this.controlBox,l,u,u,f||u,this._getRequestStyles());if(!l&&this._hasFirstTarget&&o.persistData){const p=ra(o.persistData);for(const g in p)d[g]=p[g]}i&&$e(),this.updateState(d,a?!1:s)}isDragging(n){var o,i;const r=this.targetGesto,s=this.controlGesto;return r!=null&&r.isFlag()?n?!!((o=r.getEventData()[n])!=null&&o.isEventStart):!0:s!=null&&s.isFlag()?n?!!((i=s.getEventData()[n])!=null&&i.isEventStart):!0:!1}updateTarget(n){this.updateRect(n,!0)}getRect(){const n=this.state,r=Yt(this.state),[s,o,i,a]=r,c=Nt(r),{width:l,height:u}=n,{width:f,height:d,left:p,top:g}=c,h=[n.left,n.top],v=ct(h,n.origin),m=ct(h,n.beforeOrigin),S=n.transformOrigin;return{width:f,height:d,left:p,top:g,pos1:s,pos2:o,pos3:i,pos4:a,offsetWidth:l,offsetHeight:u,beforeOrigin:m,origin:v,transformOrigin:S,rotation:this.getRotation()}}getManager(){return this}stopDrag(n){if(!n||n==="target"){const r=this.targetGesto;(r==null?void 0:r.isIdle())===!1&&Jr(this,!1),r==null||r.stop()}if(!n||n==="control"){const r=this.controlGesto;(r==null?void 0:r.isIdle())===!1&&Jr(this,!0),r==null||r.stop()}}getRotation(){const{pos1:n,pos2:r,direction:s}=this.state;return tu(n,r,s)}request(n,r={},s){const o=this,i=o.props,a=i.parentMoveable||i.wrapperMoveable||o,c=a.props.ables,l=i.groupable,u=$t(c,m=>m.name===n);if(this.isDragging()||!u||!u.request)return{request(){return this},requestEnd(){return this}};const f=u.request(o),d=s||r.isInstant,p=f.isControl?"controlAbles":"targetAbles",g=`${l?"Group":""}${f.isControl?"Control":""}`,h=[...a[p]],v={request(m){return Sn(o,h,["drag"],g,"",{...f.request(m),requestAble:n,isRequest:!0},d),v},requestEnd(){return Sn(o,h,["drag"],g,"End",{...f.requestEnd(),requestAble:n,isRequest:!0},d),v}};return Sn(o,h,["drag"],g,"Start",{...f.requestStart(r),requestAble:n,isRequest:!0},d),d?v.request(r).requestEnd():v}getMoveables(){return[this]}destroy(){this.componentWillUnmount()}updateRenderPoses(){const n=this.getState(),r=this.props,s=r.padding,{originalBeforeOrigin:o,transformOrigin:i,allMatrix:a,is3d:c,pos1:l,pos2:u,pos3:f,pos4:d,left:p,top:g,isPersisted:h}=n,v=r.zoom||1;if(!s&&v<=1){n.renderPoses=[l,u,f,d],n.renderLines=[[l,u],[u,d],[d,f],[f,l]];return}const{left:m,top:S,bottom:x,right:C}=yi(s||{}),E=c?4:3;let D=[];h?D=i:this.controlBox&&r.groupable?D=o:D=ct(o,[p,g]);const R=Mn(E,me(D.map(O=>-O),E),a,me(i,E)),y=Vt(R,l,[-m,-S],E),M=Vt(R,u,[C,-S],E),P=Vt(R,f,[-m,x],E),_=Vt(R,d,[C,x],E);if(n.renderPoses=[y,M,P,_],n.renderLines=[[y,M],[M,_],[_,P],[P,y]],v){const O=v/2;n.renderLines=[[Vt(R,l,[-m-O,-S],E),Vt(R,u,[C+O,-S],E)],[Vt(R,u,[C,-S-O],E),Vt(R,d,[C,x+O],E)],[Vt(R,d,[C+O,x],E),Vt(R,f,[-m-O,x],E)],[Vt(R,f,[-m,x+O],E),Vt(R,l,[-m,-S-O],E)]]}}checkUpdate(){this._isPropTargetChanged=!1;const{target:n,container:r,parentMoveable:s}=this.props,{target:o,container:i}=this.state;if(!o&&!n)return;this.updateAbles();const a=!ts(o,n);if(!(a||!ts(i,r)))return;const l=r||this.controlBox;l&&this.unsetAbles(),this.updateState({target:n,container:r}),!s&&l&&this.updateRect("End",!1,!1),this._isPropTargetChanged=a}waitToChangeTarget(){return new Promise(()=>{})}triggerEvent(n,r){const s=this.props;if(this._emitter.trigger(n,r),s.parentMoveable&&r.isRequest&&!r.isRequestChild)return s.parentMoveable.triggerEvent(n,r,!0);const o=s[n];return o&&o(r)}useCSS(n,r){const s=this.props.customStyledMap,o=n+r;return s[o]||(s[o]=ea(n,r)),s[o]}getState(){var i;const n=this.props;(n.target||(i=n.targets)!=null&&i.length)&&(this._hasFirstTarget=!0);const r=this.controlBox,s=n.persistData,o=n.firstRenderState;if(o&&!r)return o;if(!this._hasFirstTarget&&s){const a=ra(s);if(a)return this.updateState(a,!1),this.state}return this.state.isPersisted=!1,this.state}updateSelectors(){}unsetAbles(){this.targetAbles.forEach(n=>{n.unset&&n.unset(this)})}updateAbles(n=this.props.ables,r=""){const o=this.props.triggerAblesSimultaneously,i=this.getEnabledAbles(n),a=`drag${r}Start`,c=`pinch${r}Start`,l=`drag${r}ControlStart`,u=Un(i,[a,c],o),f=Un(i,[l],o);this.enabledAbles=i,this.targetAbles=u,this.controlAbles=f}updateState(n,r){if(r){if(this.isUnmounted)return;this.setState(n)}else{const s=this.state;for(const o in n)s[o]=n[o]}}getEnabledAbles(n=this.props.ables){const r=this.props;return n.filter(s=>s&&(s.always&&r[s.name]!==!1||r[s.name]))}renderAbles(){const r=this.props.triggerAblesSimultaneously,s={createElement:vt.createElement};return this.renderState={},Kl(Si(Un(this.getEnabledAbles(),["render"],r).map(({render:o})=>o(this,s)||[])).filter(o=>o),({key:o})=>o).map(o=>o[0])}updateCheckInput(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)}_getRequestStyles(){return this.getEnabledAbles().reduce((r,s)=>{var i;const o=((i=s.requestStyle)==null?void 0:i.call(s))??[];return[...r,...o]},[...this.props.requestStyles||[]])}_updateObserver(n){this._updateResizeObserver(n),this._updateMutationObserver(n)}_updateEvents(){const n=this.targetAbles.length,r=this.controlAbles.length,s=this._dragTarget;(!n&&this.targetGesto||this._isTargetChanged(!0))&&(We(this,!1),this.updateState({gestos:{}})),r||We(this,!0),s&&n&&!this.targetGesto&&(this.targetGesto=Ji(this,s,"")),!this.controlGesto&&r&&(this.controlGesto=Qi(this,"Control"))}_updateTargets(){const n=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=n.dragArea,this._propTarget=n.target,this._originalDragTarget=n.dragTarget||n.target,this._dragTarget=te(this._originalDragTarget,!0)}_renderLines(){const n=this.props,{zoom:r,hideDefaultLines:s,hideChildMoveableDefaultLines:o,parentMoveable:i}=n;if(s||i&&o)return[];const a=this.getState(),c={createElement:vt.createElement};return a.renderLines.map((l,u)=>fn(c,"",l[0],l[1],r,`render-line-${u}`))}_isTargetChanged(n){const r=this.props,s=r.dragTarget||r.target,o=this._prevOriginalDragTarget,i=this._prevDragArea,a=r.dragArea;return!a&&o!==s||(n||a)&&i!==a||this._prevPropTarget!=this._propTarget}_updateNativeEvents(){const r=this.props.dragArea?this.areaElement:this.state.target,s=this.events,o=Be(s);if(this._isTargetChanged())for(const a in s){const c=s[a];c&&c.destroy(),s[a]=null}if(!r)return;const i=this.enabledAbles;o.forEach(a=>{const c=Un(i,[a]),l=c.length>0;let u=s[a];if(!l){u&&(u.destroy(),s[a]=null);return}u||(u=new Nu(r,this,a),s[a]=u),u.setAbles(c)})}_checkUpdateRootContainer(){const n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=te(n,!0))}_checkUpdateViewContainer(){const n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=te(n,!0)),this._viewContainer&&this._changeAbleViewClassNames([...this._getAbleViewClassNames(),this.isDragging()?su:""])}_changeAbleViewClassNames(n){const r=this._viewContainer,s=xi(n.filter(Boolean),c=>c).map(([c])=>c),o=this._viewClassNames,{removed:i,added:a}=Vr(o,s);i.forEach(c=>{no(r,o[c])}),a.forEach(c=>{eo(r,s[c])}),this._viewClassNames=s}_getAbleViewClassNames(){return(this.getEnabledAbles().map(n=>{var r;return((r=n.viewClassName)==null?void 0:r.call(n,this))||""}).join(" ")+` ${this._getAbleClassName("-view")}`).split(/\s+/g)}_getAbleClassName(n=""){const r=this.getEnabledAbles(),s=this.targetGesto,o=this.controlGesto,i=s!=null&&s.isFlag()?s.getEventData():{},a=o!=null&&o.isFlag()?o.getEventData():{};return r.map(c=>{var f,d,p;const l=c.name;let u=((f=c.className)==null?void 0:f.call(c,this))||"";return((d=i[l])!=null&&d.isEventStart||(p=a[l])!=null&&p.isEventStart)&&(u+=` ${U(`${l}${n}-dragging`)}`),u.trim()}).filter(Boolean).join(" ")}_updateResizeObserver(n){var a;const r=this.props,s=r.target,o=ce(this.getControlBoxElement());if(!o.ResizeObserver||!s||!r.useResizeObserver){(a=this._reiszeObserver)==null||a.disconnect();return}if(n.target===s&&this._reiszeObserver)return;const i=new o.ResizeObserver(this.checkUpdateRect);i.observe(s,{box:"border-box"}),this._reiszeObserver=i}_updateMutationObserver(n){var a;const r=this.props,s=r.target,o=ce(this.getControlBoxElement());if(!o.MutationObserver||!s||!r.useMutationObserver){(a=this._mutationObserver)==null||a.disconnect();return}if(n.target===s&&this._mutationObserver)return;const i=new o.MutationObserver(c=>{for(const l of c)l.type==="attributes"&&l.attributeName==="style"&&this.checkUpdateRect()});i.observe(s,{attributes:!0}),this._mutationObserver=i}}H(Pe,"defaultProps",{dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:ii,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1});const bs={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render(t,e){var d;const n=t.props;let r=n.targets||[];const{left:s,top:o,isPersisted:i}=t.getState(),a=n.zoom||1,c=t.renderGroupRects;let l=((d=n.persistData)==null?void 0:d.children)||[];i?r=l.map(()=>null):l=[];const u=je(t,"parentPosition",[s,o],p=>p.join(",")),f=je(t,"requestStyles",t.getRequestChildStyles(),p=>p.join(","));return t.moveables=t.moveables.slice(0,r.length),[...r.map((p,g)=>ot.jsx(Pe,{ref:js(t,"moveables",g),target:p,origin:!1,requestStyles:f,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:l[g],zoom:a},"moveable"+g)),...Si(c.map(({pos1:p,pos2:g,pos3:h,pos4:v},m)=>{const S=[p,g,h,v];return[[0,1],[1,3],[3,2],[2,0]].map(([x,C],E)=>fn(e,"",K(S[x],u),K(S[C],u),a,`group-rect-${m}-${E}`))}))]}},Ju=we("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart(){},dragControlStart(){},dragGroupStart(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd(t,e){const n=t.props.target,r=e.inputEvent,s=e.inputTarget,i=!t.isMoveableElement(s)&&t.controlBox.contains(s);if(!r||!s||e.isDrag||t.isMoveableElement(s)||i)return;const a=n.contains(s);j(t,"onClick",et(t,e,{isDouble:e.isDouble,inputTarget:s,isTarget:n===s,moveableTarget:t.props.target,containsTarget:a}))},dragGroupEnd(t,e){const n=e.inputEvent,r=e.inputTarget;if(!n||!r||e.isDrag||t.isMoveableElement(r)||e.datas.inputTarget===r)return;const s=t.props.targets;let o=s.indexOf(r);const i=o>-1;let a=!1;o===-1&&(o=re(s,c=>c.contains(r)),a=o>-1),j(t,"onClickGroup",et(t,e,{isDouble:e.isDouble,targets:s,inputTarget:r,targetIndex:o,isTarget:i,containsTarget:a,moveableTarget:s[o]}))},dragControlEnd(t,e){this.dragEnd(t,e)},dragGroupControlEnd(t,e){this.dragEnd(t,e)}});function Xe(t){let e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),{...t,datas:e}}const sa=we("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render(t,e){const n=t.props,r=n.edgeDraggable;return r?Eo(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition(t,e){var s;const n=t.props,r=(s=e.inputEvent)==null?void 0:s.target;return!n.edgeDraggable||!r?!1:!n.draggable&&Rt(r,U("direction"))&&Rt(r,U("edge"))&&Rt(r,U("edgeDraggable"))},dragStart(t,e){return wt.dragStart(t,Xe(e))},drag(t,e){return wt.drag(t,Xe(e))},dragEnd(t,e){return wt.dragEnd(t,Xe(e))},dragGroupCondition(t,e){var s;const n=t.props,r=(s=e.inputEvent)==null?void 0:s.target;return!n.edgeDraggable||!r?!1:!n.draggable&&Rt(r,U("direction"))&&Rt(r,U("line"))},dragGroupStart(t,e){return wt.dragGroupStart(t,Xe(e))},dragGroup(t,e){return wt.dragGroup(t,Xe(e))},dragGroupEnd(t,e){return wt.dragGroupEnd(t,Xe(e))},unset(t){return wt.unset(t)}}),oa={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},rr=[Ki,zi,oi,Ri,wt,sa,Nn,Pi,Ti,Ho,fu,du,ou,Ou,Wi,Hi,bs,oa,Ju,Ii,Zi],Qu=rr.reduce((t,e)=>((e.events||[]).forEach(n=>{to(t,n)}),t),[]),tf=rr.reduce((t,e)=>((e.props||[]).forEach(n=>{to(t,n)}),t),[]);function ia([t,e,n],r){return(t*r[0]+e*r[1]+n)/Math.sqrt(t*t+e*e)}function sr([t,e],n){return-t*n[0]-e*n[1]}function aa(t,e){return Math.max(...t.map(([n,r,s,o])=>Math.max(n[e],r[e],s[e],o[e])))}function ca(t,e){return Math.min(...t.map(([n,r,s,o])=>Math.min(n[e],r[e],s[e],o[e])))}function ef(t,e){let n=[0,0],r=[0,0],s=[0,0],o=[0,0],i=0,a=0;if(!t.length)return{pos1:n,pos2:r,pos3:s,pos4:o,minX:0,minY:0,maxX:0,maxY:0,width:i,height:a,rotation:e};const c=tt(e,It);if(c%90){const p=c/180*Math.PI,g=Math.tan(p),h=-1/g,v=[fr,Ys],m=[[0,0],[0,0]],S=[fr,Ys],x=[[0,0],[0,0]];t.forEach(O=>{O.forEach(T=>{const w=ia([-g,1,0],T),k=ia([-h,1,0],T);v[0]>w&&(m[0]=T,v[0]=w),v[1]<w&&(m[1]=T,v[1]=w),S[0]>k&&(x[0]=T,S[0]=k),S[1]<k&&(x[1]=T,S[1]=k)})});const[C,E]=m,[D,R]=x,y=[-g,1,sr([-g,1],C)],M=[-g,1,sr([-g,1],E)],P=[-h,1,sr([-h,1],D)],_=[-h,1,sr([-h,1],R)];[n,r,s,o]=[[y,P],[y,_],[M,P],[M,_]].map(([O,T])=>ps(O,T)[0]),i=S[1]-S[0],a=v[1]-v[0]}else{const p=ca(t,0),g=ca(t,1),h=aa(t,0),v=aa(t,1);n=[p,g],r=[h,g],s=[p,v],o=[h,v],i=h-p,a=v-g,c%180&&([n,r,s,o]=[s,n,o,r],i=v-g,a=h-p)}c%360>180&&([n,r,s,o]=[o,s,r,n]);const{minX:l,minY:u,maxX:f,maxY:d}=Me([n,r,s,o]);return{pos1:n,pos2:r,pos3:s,pos4:o,width:i,height:a,minX:l,minY:u,maxX:f,maxY:d,rotation:e}}function la(t,e){const n=e.map(r=>{if(Pt(r)){const s=la(t,r),o=s.length;return o>1?s:o===1?s[0]:null}else{const s=$t(t,({manager:o})=>o.props.target===r);return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return n.length===1&&Pt(n[0])?n[0]:n}class ua extends Pe{constructor(){super(...arguments);H(this,"differ",new Ko);H(this,"moveables",[]);H(this,"transformOrigin","50% 50%");H(this,"renderGroupRects",[]);H(this,"_targetGroups",[]);H(this,"_hasFirstTargets",!1)}componentDidMount(){super.componentDidMount()}checkUpdate(){this._isPropTargetChanged=!1,this.updateAbles()}getTargets(){return this.props.targets}updateRect(n,r,s=!0){var W;const o=this.state;if(!this.controlBox||o.isPersisted)return;$e(!0),this.moveables.forEach(J=>{J.updateRect(n,!1,!1)});const i=this.props,a=this.moveables,c=o.target||i.target,l=a.map(J=>({finded:!1,manager:J})),u=this.props.targetGroups||[],f=la(l,u),d=i.useDefaultGroupRotate;f.push(...l.filter(({finded:J})=>!J).map(({manager:J})=>J));const p=[],g=!r||n!==""&&i.updateGroup;let h=i.defaultGroupRotate||0;if(!this._hasFirstTargets){const J=(W=i.persistData)==null?void 0:W.rotation;J!=null&&(h=J)}function v(J,q,$){const X=J.map(pt=>{if(Pt(pt)){const bt=v(pt,q),ee=[bt.pos1,bt.pos2,bt.pos3,bt.pos4];return p.push(bt),{poses:ee,rotation:bt.rotation}}else return{poses:Yt(pt.state),rotation:pt.getRotation()}}),nt=X.map(({rotation:pt})=>pt);let dt=0;const St=nt[0],st=nt.every(pt=>Math.abs(St-pt)<.1);g?dt=!d&&st?St:h:dt=!d&&!$&&st?St:q;const jt=X.map(({poses:pt})=>pt);return ef(jt,dt)}const m=v(f,this.rotation,!0);g&&(this.rotation=m.rotation,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=u,this.renderGroupRects=p;const S=this.transformOrigin,x=this.rotation,C=this.scale,{width:E,height:D,minX:R,minY:y}=m,M=eu([[0,0],[E,0],[0,D],[E,D]],os(S,E,D),this.rotation/180*Math.PI),{minX:P,minY:_}=Me(M.result),O=` rotate(${x}deg) scale(${zt(C[0])}, ${zt(C[1])})`,T=`translate(${-P}px, ${-_}px)${O}`;this.controlBox.style.transform=`translate3d(${R}px, ${y}px, ${this.props.translateZ||0})`,c.style.cssText+=`left:0px;top:0px;transform-origin:${S};width:${E}px;height:${D}px;transform: ${T}`,o.width=E,o.height=D;const w=this.getContainer(),k=Ds(this.controlBox,c,this.controlBox,this.getContainer(),this._rootContainer||w,[]),I=[k.left,k.top],[F,G,L,z]=Yt(k),N=Me([F,G,L,z]),Z=[N.minX,N.minY],Y=zt(C[0]*C[1]);k.pos1=K(F,Z),k.pos2=K(G,Z),k.pos3=K(L,Z),k.pos4=K(z,Z),k.left=R-k.left+Z[0],k.top=y-k.top+Z[1],k.origin=K(ct(I,k.origin),Z),k.beforeOrigin=K(ct(I,k.beforeOrigin),Z),k.originalBeforeOrigin=ct(I,k.originalBeforeOrigin),k.transformOrigin=K(ct(I,k.transformOrigin),Z),c.style.transform=`translate(${-P-Z[0]}px, ${-_-Z[1]}px)`+O,$e(),this.updateState({...k,posDelta:Z,direction:Y,beforeDirection:Y},s)}getRect(){return{...super.getRect(),children:this.moveables.map(n=>n.getRect())}}triggerEvent(n,r,s){if(s||n.indexOf("Group")>-1)return super.triggerEvent(n,r);this._emitter.trigger(n,r)}getRequestChildStyles(){return this.getEnabledAbles().reduce((r,s)=>{var i;const o=((i=s.requestChildStyle)==null?void 0:i.call(s))??[];return[...r,...o]},[])}getMoveables(){return[...this.moveables]}updateAbles(){super.updateAbles([...this.props.ables,bs],"Group")}_updateTargets(){super._updateTargets(),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=te(this._originalDragTarget,!0)}_updateEvents(){const n=this.state,r=this.props,s=this._prevDragTarget,o=r.dragTarget||this.areaElement,i=r.targets,{added:a,changed:c,removed:l}=this.differ.update(i),u=a.length||l.length;(u||this._prevOriginalDragTarget!==this._originalDragTarget)&&(We(this,!1),We(this,!0),this.updateState({gestos:{}})),s!==o&&(n.target=null),n.target||(n.target=this.areaElement,this.controlBox.style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=Ji(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=Qi(this,"GroupControl")));const f=!ts(n.container,r.container);f&&(n.container=r.container),(f||u||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||c.length||i.length&&!bi(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!u}_updateObserver(){}}H(ua,"defaultProps",{...Pe.defaultProps,transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"});class nf extends Pe{constructor(){super(...arguments);H(this,"moveables",[])}render(){const n=this.props,{cspNonce:r,cssStyled:s,persistData:o}=n;let i=n.targets||[];const a=i.length,c=this.isUnmounted||!a;let l=(o==null?void 0:o.children)??[];return c&&!a&&l.length?i=l.map(()=>null):c||(l=[]),ot.jsx(s,{cspNonce:r,ref:ge(this,"controlBox"),className:U("control-box"),children:i.map((u,f)=>{var p;const d=((p=n.individualGroupableProps)==null?void 0:p.call(n,u,f))??{};return ot.jsx(Pe,{ref:js(this,"moveables",f),...n,...d,target:u,wrapperMoveable:this,isWrapperMounted:this.isMoveableMounted,persistData:l[f]},"moveable"+f)})})}componentDidMount(){}componentDidUpdate(){}getTargets(){return this.props.targets}updateRect(n,r,s=!0){$e(!0),this.moveables.forEach(o=>{o.updateRect(n,r,s)}),$e()}getRect(){return{...super.getRect(),children:this.moveables.map(n=>n.getRect())}}request(n,r={},s){const o=this.moveables.map(c=>c.request(n,{...r,isInstant:!1},!1)),i=s||r.isInstant,a={request(c){return o.forEach(l=>l.request(c)),this},requestEnd(){return o.forEach(c=>c.requestEnd()),this}};return i?a.request(r).requestEnd():a}dragStart(n,r=n.target){const s=r,o=$t(this.moveables,i=>{const a=i.getTargets()[0],c=i.getControlBoxElement(),l=i.getDragElement();return!a||!l?!1:l===s||l.contains(s)||l!==a&&a===s||a.contains(s)||c===s||c.contains(s)});return o&&o.dragStart(n,r),this}hitTest(){return 0}isInside(){return!1}isDragging(){return!1}getDragElement(){return null}getMoveables(){return[...this.moveables]}updateRenderPoses(){}checkUpdate(){}triggerEvent(){}updateAbles(){}_updateEvents(){}_updateObserver(){}}function fa(t,e){const n=[];return t.forEach(r=>{if(r){if(ne(r)){e[r]&&n.push(...e[r]);return}Pt(r)?n.push(...fa(r,e)):n.push(r)}}),n}function da(t,e){const n=[];return t.forEach(r=>{if(r){if(ne(r)){e[r]&&n.push(...e[r]);return}Pt(r)?n.push(da(r,e)):n.push(r)}}),n}function pa(t,e){return t.length!==e.length||t.some((n,r)=>{const s=e[r];return!n&&!s?!1:n!=s?Pt(n)&&Pt(s)?pa(n,s):!0:!1})}class qe extends Os.PureComponent{constructor(){super(...arguments);H(this,"moveable");H(this,"refTargets",[]);H(this,"selectorMap",{});H(this,"_differ",new Ko);H(this,"_elementTargets",[]);H(this,"_tmpRefTargets",[]);H(this,"_tmpSelectorMap",{});H(this,"_onChangeTargets",null)}static makeStyled(){const n={};this.getTotalAbles().forEach(({css:o})=>{o&&o.forEach(i=>{n[i]=!0})});const s=Be(n).join(`
`);this.defaultStyled=ea("div",ja(lr,La+s))}static getTotalAbles(){return[zi,bs,oa,Ii,...this.defaultAbles]}render(){const n=this.constructor;n.defaultStyled||n.makeStyled();const{ables:r,props:s,...o}=this.props,[i,a]=this._updateRefs(!0),c=fa(i,a);let l=c.length>1;const f=[...n.getTotalAbles(),...r||[]],d={...o,...s||{},ables:f,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap};this._elementTargets=c;let p=null;const g=this.moveable,h=o.persistData;if(h!=null&&h.children&&(l=!0),o.individualGroupable)return ot.jsx(nf,{ref:ge(this,"moveable"),...d,target:null,targets:c},"individual-group");if(l){const v=da(i,a);if(g&&!g.props.groupable&&!g.props.individualGroupable){const m=g.props.target;m&&c.indexOf(m)>-1&&(p={...g.state})}return ot.jsx(ua,{ref:ge(this,"moveable"),...d,...o.groupableProps??{},target:null,targets:c,targetGroups:v,firstRenderState:p},"group")}else{const v=c[0];if(g&&(g.props.groupable||g.props.individualGroupable)){const m=g.moveables||[],S=$t(m,x=>x.props.target===v);S&&(p={...S.state})}return ot.jsx(Pe,{ref:ge(this,"moveable"),...d,target:v,firstRenderState:p},"single")}}componentDidMount(){this._checkChangeTargets()}componentDidUpdate(){this._checkChangeTargets()}componentWillUnmount(){this.selectorMap={},this.refTargets=[]}getTargets(){var n;return((n=this.moveable)==null?void 0:n.getTargets())??[]}updateSelectors(){this.selectorMap={},this._updateRefs(),this.forceUpdate()}waitToChangeTarget(){let n;return this._onChangeTargets=()=>{this._onChangeTargets=null,n()},new Promise(r=>{n=r})}waitToChangeTargets(){return this.waitToChangeTarget()}getManager(){return this.moveable}getMoveables(){return this.moveable.getMoveables()}getDragElement(){return this.moveable.getDragElement()}_updateRefs(n){const r=this.refTargets,s=rs(this.props.target||this.props.targets),o=typeof document<"u";let i=pa(r,s);const a=this.selectorMap,c={};return this.refTargets.forEach(function l(u){ne(u)?a[u]?c[u]=a[u]:o&&(i=!0,c[u]=[].slice.call(document.querySelectorAll(u))):Pt(u)&&u.forEach(l)}),this._tmpRefTargets=s,this._tmpSelectorMap=c,[s,c,!n&&i]}_checkChangeTargets(){var c,l,u;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;const{added:n,removed:r}=this._differ.update(this._elementTargets);(n.length||r.length)&&((l=(c=this.props).onChangeTargets)==null||l.call(c,{moveable:this.moveable,targets:this._elementTargets}),(u=this._onChangeTargets)==null||u.call(this));const[o,i,a]=this._updateRefs();this.refTargets=o,this.selectorMap=i,a&&this.forceUpdate()}}H(qe,"defaultAbles",[]),H(qe,"customStyledMap",{}),H(qe,"defaultStyled",null);class ga extends qe{}H(ga,"defaultAbles",rr);function rf(t){var e;return e=class extends qe{},H(e,"defaultAbles",t),e}at.Clippable=Wi,at.DIRECTIONS=Dn,at.Draggable=wt,at.EdgeDraggable=sa,at.InitialMoveable=qe,at.MOVEABLE_ABLES=rr,at.MOVEABLE_EVENTS=Qu,at.MOVEABLE_METHODS=Ya,at.MOVEABLE_PROPS=tf,at.Pinchable=Ri,at.Resizable=Nn,at.Rotatable=Ho,at.Roundable=Hi,at.Scalable=Pi,at.Snappable=oi,at.Warpable=Ti,at.calculateElementPosition=xe,at.default=ga,at.getElementInfo=Zu,at.makeAble=we,at.makeMoveable=rf,Object.defineProperties(at,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
